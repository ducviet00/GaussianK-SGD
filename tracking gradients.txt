
[rank: 1][epoch: 0][iter: 0] BEFORE:

[rank: 3][epoch: 0][iter: 0] BEFORE:

[rank: 0][epoch: 0][iter: 0] BEFORE:
tensor([-0.0693, -0.0654,  0.0592,  ..., -0.0505, -0.0559, -0.0935],
       device='cuda:1')tensor([-0.0771,  0.0295, -0.0117,  ..., -0.0576,  0.0798, -0.1617],
       device='cuda:3')tensor([-0.0215,  0.0050,  0.0459,  ..., -0.0006, -0.0234,  0.0030],
       device='cuda:0')
[rank: 2][epoch: 0][iter: 0] BEFORE:
tensor([-0.0352, -0.0327,  0.0065,  ..., -0.0664, -0.0553, -0.0771],
       device='cuda:2')
[rank: 7][epoch: 0][iter: 0] BEFORE:

[rank: 13][epoch: 0][iter: 0] BEFORE:

[rank: 5][epoch: 0][iter: 0] BEFORE:

[rank: 19][epoch: 0][iter: 0] BEFORE:
tensor([-0.0191, -0.0340,  0.0268,  ...,  0.0087, -0.0104, -0.0265],
       device='cuda:3')
[rank: 15][epoch: 0][iter: 0] BEFORE:

[rank: 21][epoch: 0][iter: 0] BEFORE:
tensor([-0.0219, -0.0350,  0.0642,  ..., -0.0396, -0.0877, -0.0753],
       device='cuda:1')tensor([-0.0490,  0.0336,  0.0145,  ...,  0.0405,  0.0608,  0.0381],
       device='cuda:3')tensor([-0.0073, -0.0179,  0.0448,  ..., -0.0460, -0.0831, -0.0292],
       device='cuda:1')
[rank: 8][epoch: 0][iter: 0] BEFORE:

[rank: 6][epoch: 0][iter: 0] BEFORE:

[rank: 16][epoch: 0][iter: 0] BEFORE:
tensor([-0.0811,  0.0550, -0.0218,  ..., -0.0009,  0.0079,  0.0596],
       device='cuda:1')tensor([-0.0381, -0.0404,  0.0276,  ..., -0.0514,  0.0150, -0.0064],
       device='cuda:3')
[rank: 4][epoch: 0][iter: 0] BEFORE:

[rank: 11][epoch: 0][iter: 0] BEFORE:

[rank: 17][epoch: 0][iter: 0] BEFORE:

[rank: 22][epoch: 0][iter: 0] BEFORE:

[rank: 14][epoch: 0][iter: 0] BEFORE:
tensor([-0.0729, -0.0451,  0.0533,  ..., -0.0586, -0.1168, -0.1460],
       device='cuda:2')tensor([-0.0508, -0.0039, -0.0142,  ...,  0.0215,  0.0347,  0.0704],
       device='cuda:0')tensor([-0.0783,  0.0281,  0.0639,  ..., -0.0103,  0.0648, -0.0033],
       device='cuda:0')
[rank: 20][epoch: 0][iter: 0] BEFORE:

[rank: 12][epoch: 0][iter: 0] BEFORE:
tensor([ 0.0081,  0.0333, -0.0242,  ..., -0.0287, -0.0034,  0.0425],
       device='cuda:0')
[rank: 10][epoch: 0][iter: 0] BEFORE:

[rank: 18][epoch: 0][iter: 0] BEFORE:

[rank: 23][epoch: 0][iter: 0] BEFORE:
tensor([-0.0670, -0.0156,  0.0601,  ..., -0.0544,  0.0077, -0.0261],
       device='cuda:2')tensor([-0.0360,  0.0146,  0.0154,  ...,  0.0437, -0.0084, -0.0140],
       device='cuda:3')tensor([-0.0391, -0.0738,  0.0284,  ..., -0.0798, -0.1537, -0.0840],
       device='cuda:1')tensor([-0.0030,  0.0306, -0.0182,  ...,  0.0815, -0.0403,  0.0273],
       device='cuda:2')tensor([-0.0028, -0.0492,  0.0047,  ..., -0.1314, -0.0923, -0.1080],
       device='cuda:0')
[rank: 9][epoch: 0][iter: 0] BEFORE:
tensor([-0.0158,  0.0162,  0.0055,  ...,  0.0053,  0.0288, -0.0144],
       device='cuda:0')tensor([-0.0277, -0.0334,  0.0282,  ...,  0.0149, -0.0396, -0.0467],
       device='cuda:2')tensor([ 0.0432, -0.0638,  0.0646,  ..., -0.1244, -0.1052, -0.1286],
       device='cuda:3')tensor([ 0.0110, -0.0005,  0.0428,  ..., -0.0716,  0.0143, -0.0889],
       device='cuda:1')
[rank: 0][epoch: 0][iter: 0] AFTER HANDLE:

[rank: 19][epoch: 0][iter: 0] AFTER HANDLE:

[rank: 10][epoch: 0][iter: 0] AFTER HANDLE:

[rank: 21][epoch: 0][iter: 0] AFTER HANDLE:

[rank: 2][epoch: 0][iter: 0] AFTER HANDLE:

[rank: 5][epoch: 0][iter: 0] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 0] AFTER HANDLE:
tensor([0.0391, 0.0054, 0.0275,  ..., 0.0156, 0.0184, 0.0421], device='cuda:2')
[rank: 18][epoch: 0][iter: 0] AFTER HANDLE:

[rank: 8][epoch: 0][iter: 0] AFTER HANDLE:

[rank: 23][epoch: 0][iter: 0] AFTER HANDLE:

[rank: 3][epoch: 0][iter: 0] AFTER HANDLE:

[rank: 7][epoch: 0][iter: 0] AFTER HANDLE:

[rank: 14][epoch: 0][iter: 0] AFTER HANDLE:

[rank: 16][epoch: 0][iter: 0] AFTER HANDLE:

[rank: 9][epoch: 0][iter: 0] AFTER HANDLE:

[rank: 22][epoch: 0][iter: 0] AFTER HANDLE:

[rank: 1][epoch: 0][iter: 0] AFTER HANDLE:

[rank: 4][epoch: 0][iter: 0] AFTER HANDLE:

[rank: 12][epoch: 0][iter: 0] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 0] AFTER HANDLE:

[rank: 11][epoch: 0][iter: 0] AFTER HANDLE:

[rank: 20][epoch: 0][iter: 0] AFTER HANDLE:
tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:0')
[rank: 6][epoch: 0][iter: 0] AFTER HANDLE:

[rank: 13][epoch: 0][iter: 0] AFTER HANDLE:
tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:3')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:2')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:1')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:2')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:1')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:3')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:2')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:0')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:3')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:3')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:3')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:2')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:0')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:1')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:2')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:1')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:0')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:0')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:1')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:3')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:0')
[rank: 0][epoch: 0][iter: 0] NEW GRAD:
tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:2')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:1')
[rank: 19][epoch: 0][iter: 0] NEW GRAD:

[rank: 10][epoch: 0][iter: 0] NEW GRAD:

[rank: 21][epoch: 0][iter: 0] NEW GRAD:

[rank: 2][epoch: 0][iter: 0] NEW GRAD:

[rank: 5][epoch: 0][iter: 0] NEW GRAD:

[rank: 15][epoch: 0][iter: 0] NEW GRAD:

[rank: 18][epoch: 0][iter: 0] NEW GRAD:

[rank: 8][epoch: 0][iter: 0] NEW GRAD:

[rank: 23][epoch: 0][iter: 0] NEW GRAD:

[rank: 3][epoch: 0][iter: 0] NEW GRAD:

[rank: 7][epoch: 0][iter: 0] NEW GRAD:

[rank: 14][epoch: 0][iter: 0] NEW GRAD:

[rank: 16][epoch: 0][iter: 0] NEW GRAD:

[rank: 9][epoch: 0][iter: 0] NEW GRAD:

[rank: 22][epoch: 0][iter: 0] NEW GRAD:

[rank: 1][epoch: 0][iter: 0] NEW GRAD:

[rank: 4][epoch: 0][iter: 0] NEW GRAD:

[rank: 12][epoch: 0][iter: 0] NEW GRAD:

[rank: 17][epoch: 0][iter: 0] NEW GRAD:

[rank: 11][epoch: 0][iter: 0] NEW GRAD:

[rank: 20][epoch: 0][iter: 0] NEW GRAD:
tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:0')
[rank: 6][epoch: 0][iter: 0] NEW GRAD:

[rank: 13][epoch: 0][iter: 0] NEW GRAD:
tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:3')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:2')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:1')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:2')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:1')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:3')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:2')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:0')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:3')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:3')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:3')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:2')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:0')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:1')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:2')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:1')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:0')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:0')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:1')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:3')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:0')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:2')tensor([-0.0297, -0.0108,  0.0247,  ..., -0.0267, -0.0226, -0.0353],
       device='cuda:1')
[rank: 0][epoch: 0][iter: 1] BEFORE:
tensor([-0.2501,  0.0345, -0.0797,  ..., -0.0473,  0.0197,  0.0198],
       device='cuda:0')
[rank: 10][epoch: 0][iter: 1] BEFORE:
tensor([-0.0451, -0.0599,  0.0211,  ...,  0.0409,  0.0356,  0.0553],
       device='cuda:2')
[rank: 2][epoch: 0][iter: 1] BEFORE:

[rank: 5][epoch: 0][iter: 1] BEFORE:

[rank: 19][epoch: 0][iter: 1] BEFORE:
tensor([-0.1316, -0.0454, -0.1500,  ...,  0.0222,  0.0777,  0.0314],
       device='cuda:2')
[rank: 15][epoch: 0][iter: 1] BEFORE:
tensor([-0.0938, -0.0152, -0.0146,  ..., -0.0420,  0.0462,  0.0407],
       device='cuda:3')
[rank: 18][epoch: 0][iter: 1] BEFORE:
tensor([-0.0085, -0.0309,  0.0057,  ...,  0.1023, -0.0101, -0.0093],
       device='cuda:3')
[rank: 21][epoch: 0][iter: 1] BEFORE:

[rank: 3][epoch: 0][iter: 1] BEFORE:
tensor([-0.0101, -0.0119, -0.0026,  ...,  0.0218,  0.0651,  0.0488],
       device='cuda:2')
[rank: 7][epoch: 0][iter: 1] BEFORE:
tensor([ 0.0016, -0.0973, -0.0846,  ..., -0.0094, -0.0207,  0.0797],
       device='cuda:1')tensor([ 0.0012, -0.0628,  0.0631,  ..., -0.0279,  0.0409,  0.0294],
       device='cuda:3')
[rank: 16][epoch: 0][iter: 1] BEFORE:
tensor([ 0.0322,  0.0005, -0.0565,  ...,  0.0233, -0.0310,  0.0761],
       device='cuda:3')
[rank: 8][epoch: 0][iter: 1] BEFORE:

[rank: 1][epoch: 0][iter: 1] BEFORE:

[rank: 14][epoch: 0][iter: 1] BEFORE:
tensor([ 0.0094,  0.0564,  0.0354,  ..., -0.0333, -0.0920, -0.1146],
       device='cuda:0')
[rank: 22][epoch: 0][iter: 1] BEFORE:

[rank: 4][epoch: 0][iter: 1] BEFORE:
tensor([-0.0197, -0.0195, -0.0709,  ...,  0.1173,  0.0862,  0.0545],
       device='cuda:0')tensor([-0.0418, -0.0399, -0.1154,  ...,  0.0141,  0.0538,  0.0379],
       device='cuda:1')
[rank: 17][epoch: 0][iter: 1] BEFORE:
tensor([ 0.0049,  0.0454,  0.0086,  ..., -0.0117, -0.0461,  0.0018],
       device='cuda:2')
[rank: 23][epoch: 0][iter: 1] BEFORE:
tensor([ 0.0349, -0.0490,  0.0523,  ...,  0.0508, -0.0934,  0.0700],
       device='cuda:0')
[rank: 11][epoch: 0][iter: 1] BEFORE:

[rank: 12][epoch: 0][iter: 1] BEFORE:
tensor([ 0.0602,  0.0583,  0.0878,  ...,  0.0573, -0.0688, -0.0141],
       device='cuda:1')tensor([-0.0208, -0.1897, -0.0547,  ..., -0.0435, -0.0444, -0.0202],
       device='cuda:2')
[rank: 9][epoch: 0][iter: 1] BEFORE:

[rank: 13][epoch: 0][iter: 1] BEFORE:
tensor([ 0.0248,  0.0176, -0.0361,  ...,  0.0969,  0.0817,  0.0979],
       device='cuda:3')tensor([ 0.0767,  0.0695,  0.0778,  ...,  0.0746,  0.0180, -0.0099],
       device='cuda:3')
[rank: 6][epoch: 0][iter: 1] BEFORE:
tensor([-0.0073,  0.0053, -0.0361,  ...,  0.0785,  0.0806,  0.0312],
       device='cuda:0')
[rank: 20][epoch: 0][iter: 1] BEFORE:

[rank: 0][epoch: 0][iter: 1] AFTER HANDLE:

[rank: 16][epoch: 0][iter: 1] AFTER HANDLE:
tensor([-0.0123, -0.0037, -0.0616,  ...,  0.0103,  0.0190,  0.1004],
       device='cuda:1')
[rank: 4][epoch: 0][iter: 1] AFTER HANDLE:
tensor([-0.0268, -0.0228, -0.0262,  ..., -0.1371, -0.0260,  0.0120],
       device='cuda:1')
[rank: 21][epoch: 0][iter: 1] AFTER HANDLE:

[rank: 2][epoch: 0][iter: 1] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 1] AFTER HANDLE:

[rank: 8][epoch: 0][iter: 1] AFTER HANDLE:
tensor([0.0431, 0.0725, 0.0442,  ..., 0.0343, 0.1034, 0.0720], device='cuda:1')
[rank: 5][epoch: 0][iter: 1] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 1] AFTER HANDLE:

[rank: 23][epoch: 0][iter: 1] AFTER HANDLE:

[rank: 1][epoch: 0][iter: 1] AFTER HANDLE:

[rank: 19][epoch: 0][iter: 1] AFTER HANDLE:

[rank: 10][epoch: 0][iter: 1] AFTER HANDLE:

[rank: 7][epoch: 0][iter: 1] AFTER HANDLE:

[rank: 14][epoch: 0][iter: 1] AFTER HANDLE:

[rank: 22][epoch: 0][iter: 1] AFTER HANDLE:

[rank: 3][epoch: 0][iter: 1] AFTER HANDLE:

[rank: 18][epoch: 0][iter: 1] AFTER HANDLE:

[rank: 11][epoch: 0][iter: 1] AFTER HANDLE:
tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:2')
[rank: 12][epoch: 0][iter: 1] AFTER HANDLE:
tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:0')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:0')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:0')
[rank: 9][epoch: 0][iter: 1] AFTER HANDLE:
tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:0')
[rank: 13][epoch: 0][iter: 1] AFTER HANDLE:
tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:1')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:2')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:1')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:0')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:1')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:3')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:3')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:1')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:3')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:2')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:3')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:2')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:2')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:3')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:2')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:3')
[rank: 6][epoch: 0][iter: 1] AFTER HANDLE:
tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:0')
[rank: 20][epoch: 0][iter: 1] AFTER HANDLE:

[rank: 0][epoch: 0][iter: 1] NEW GRAD:

[rank: 16][epoch: 0][iter: 1] NEW GRAD:
tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:1')
[rank: 4][epoch: 0][iter: 1] NEW GRAD:
tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:1')
[rank: 21][epoch: 0][iter: 1] NEW GRAD:

[rank: 2][epoch: 0][iter: 1] NEW GRAD:

[rank: 17][epoch: 0][iter: 1] NEW GRAD:

[rank: 8][epoch: 0][iter: 1] NEW GRAD:

[rank: 5][epoch: 0][iter: 1] NEW GRAD:

[rank: 15][epoch: 0][iter: 1] NEW GRAD:

[rank: 23][epoch: 0][iter: 1] NEW GRAD:

[rank: 1][epoch: 0][iter: 1] NEW GRAD:

[rank: 19][epoch: 0][iter: 1] NEW GRAD:

[rank: 10][epoch: 0][iter: 1] NEW GRAD:

[rank: 7][epoch: 0][iter: 1] NEW GRAD:

[rank: 14][epoch: 0][iter: 1] NEW GRAD:

[rank: 22][epoch: 0][iter: 1] NEW GRAD:

[rank: 3][epoch: 0][iter: 1] NEW GRAD:

[rank: 18][epoch: 0][iter: 1] NEW GRAD:

[rank: 11][epoch: 0][iter: 1] NEW GRAD:
tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:2')
[rank: 12][epoch: 0][iter: 1] NEW GRAD:
tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:0')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:0')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:0')
[rank: 9][epoch: 0][iter: 1] NEW GRAD:
tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:0')
[rank: 13][epoch: 0][iter: 1] NEW GRAD:
tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:1')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:2')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:1')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:0')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:1')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:3')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:3')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:1')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:3')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:2')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:3')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:2')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:2')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:3')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:2')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:3')
[rank: 6][epoch: 0][iter: 1] NEW GRAD:
tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:0')
[rank: 20][epoch: 0][iter: 1] NEW GRAD:
tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:1')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:1')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:2')tensor([-0.0125, -0.0056, -0.0128,  ...,  0.0189,  0.0118,  0.0259],
       device='cuda:0')
[rank: 16][epoch: 0][iter: 2] BEFORE:

[rank: 0][epoch: 0][iter: 2] BEFORE:
tensor([ 0.0519,  0.0977,  0.0939,  ..., -0.1203, -0.1409, -0.1301],
       device='cuda:0')tensor([ 0.0525,  0.0443, -0.0189,  ...,  0.0259,  0.0518,  0.0327],
       device='cuda:0')
[rank: 17][epoch: 0][iter: 2] BEFORE:
tensor([ 0.0093,  0.0422,  0.0332,  ...,  0.0334, -0.0430,  0.0538],
       device='cuda:1')
[rank: 5][epoch: 0][iter: 2] BEFORE:

[rank: 8][epoch: 0][iter: 2] BEFORE:

[rank: 15][epoch: 0][iter: 2] BEFORE:

[rank: 2][epoch: 0][iter: 2] BEFORE:
tensor([-0.1008, -0.0756, -0.0286,  ...,  0.0103,  0.0372, -0.0722],
       device='cuda:1')
[rank: 21][epoch: 0][iter: 2] BEFORE:

[rank: 1][epoch: 0][iter: 2] BEFORE:
tensor([-0.1110, -0.1449, -0.0724,  ..., -0.0345,  0.0349, -0.0110],
       device='cuda:3')
[rank: 4][epoch: 0][iter: 2] BEFORE:

[rank: 10][epoch: 0][iter: 2] BEFORE:
tensor([ 0.0470,  0.0487,  0.1010,  ..., -0.0174, -0.0462, -0.0508],
       device='cuda:1')tensor([-0.0260,  0.0510,  0.0792,  ..., -0.0134, -0.0481, -0.0541],
       device='cuda:2')
[rank: 7][epoch: 0][iter: 2] BEFORE:

[rank: 19][epoch: 0][iter: 2] BEFORE:
tensor([-0.0795, -0.0329, -0.0179,  ..., -0.0399, -0.1642, -0.0077],
       device='cuda:2')tensor([-0.0726, -0.0032, -0.1273,  ...,  0.0332,  0.0669,  0.0157],
       device='cuda:1')
[rank: 14][epoch: 0][iter: 2] BEFORE:

[rank: 22][epoch: 0][iter: 2] BEFORE:
tensor([ 0.0549,  0.0781,  0.0294,  ..., -0.0286,  0.0018, -0.0822],
       device='cuda:0')
[rank: 18][epoch: 0][iter: 2] BEFORE:

[rank: 11][epoch: 0][iter: 2] BEFORE:

[rank: 3][epoch: 0][iter: 2] BEFORE:

[rank: 13][epoch: 0][iter: 2] BEFORE:

[rank: 23][epoch: 0][iter: 2] BEFORE:
tensor([ 0.1241,  0.1153,  0.0642,  ..., -0.0039,  0.0231,  0.0217],
       device='cuda:3')tensor([-0.0319,  0.0089,  0.0305,  ...,  0.0310,  0.0392,  0.0585],
       device='cuda:3')tensor([-0.0371,  0.0149, -0.0355,  ...,  0.0413,  0.0001,  0.0379],
       device='cuda:3')
[rank: 12][epoch: 0][iter: 2] BEFORE:
tensor([ 0.0719,  0.0783,  0.0716,  ..., -0.0435, -0.0387, -0.0111],
       device='cuda:3')tensor([-0.1344, -0.0411, -0.0611,  ...,  0.0091, -0.0831,  0.0135],
       device='cuda:2')
[rank: 6][epoch: 0][iter: 2] BEFORE:
tensor([-0.0089,  0.0252, -0.0443,  ...,  0.0831,  0.0786,  0.0822],
       device='cuda:2')tensor([-0.0267, -0.0070, -0.0436,  ...,  0.0677, -0.0004,  0.0274],
       device='cuda:2')tensor([ 0.0218,  0.0475,  0.0451,  ...,  0.0045, -0.0905, -0.0498],
       device='cuda:3')
[rank: 9][epoch: 0][iter: 2] BEFORE:
tensor([ 0.0531,  0.0899,  0.1039,  ..., -0.0222,  0.0051, -0.0524],
       device='cuda:2')tensor([ 0.0894,  0.0693,  0.0651,  ..., -0.0360,  0.0026, -0.1168],
       device='cuda:1')tensor([ 0.0177,  0.0086,  0.0062,  ..., -0.0375,  0.0812, -0.0744],
       device='cuda:1')tensor([ 0.0013,  0.0175, -0.0143,  ...,  0.0575, -0.0797, -0.1049],
       device='cuda:0')
[rank: 20][epoch: 0][iter: 2] BEFORE:

[rank: 2][epoch: 0][iter: 2] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 2] AFTER HANDLE:

[rank: 9][epoch: 0][iter: 2] AFTER HANDLE:

[rank: 5][epoch: 0][iter: 2] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 2] AFTER HANDLE:

[rank: 21][epoch: 0][iter: 2] AFTER HANDLE:

[rank: 3][epoch: 0][iter: 2] AFTER HANDLE:

[rank: 16][epoch: 0][iter: 2] AFTER HANDLE:

[rank: 10][epoch: 0][iter: 2] AFTER HANDLE:

[rank: 4][epoch: 0][iter: 2] AFTER HANDLE:

[rank: 13][epoch: 0][iter: 2] AFTER HANDLE:

[rank: 23][epoch: 0][iter: 2] AFTER HANDLE:

[rank: 0][epoch: 0][iter: 2] AFTER HANDLE:

[rank: 18][epoch: 0][iter: 2] AFTER HANDLE:
tensor([0.0700, 0.0894, 0.0194,  ..., 0.0388, 0.0431, 0.0090], device='cuda:0')
[rank: 8][epoch: 0][iter: 2] AFTER HANDLE:

[rank: 7][epoch: 0][iter: 2] AFTER HANDLE:

[rank: 12][epoch: 0][iter: 2] AFTER HANDLE:

[rank: 22][epoch: 0][iter: 2] AFTER HANDLE:

[rank: 1][epoch: 0][iter: 2] AFTER HANDLE:

[rank: 19][epoch: 0][iter: 2] AFTER HANDLE:

[rank: 11][epoch: 0][iter: 2] AFTER HANDLE:

[rank: 6][epoch: 0][iter: 2] AFTER HANDLE:

[rank: 14][epoch: 0][iter: 2] AFTER HANDLE:
tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:0')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:2')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:1')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:1')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:1')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:3')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:1')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:3')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:0')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:2')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:0')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:1')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:3')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:0')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:2')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:0')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:3')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:0')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:2')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:1')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:3')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:3')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:2')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:2')
[rank: 20][epoch: 0][iter: 2] AFTER HANDLE:

[rank: 2][epoch: 0][iter: 2] NEW GRAD:

[rank: 17][epoch: 0][iter: 2] NEW GRAD:

[rank: 9][epoch: 0][iter: 2] NEW GRAD:

[rank: 5][epoch: 0][iter: 2] NEW GRAD:

[rank: 15][epoch: 0][iter: 2] NEW GRAD:

[rank: 21][epoch: 0][iter: 2] NEW GRAD:

[rank: 3][epoch: 0][iter: 2] NEW GRAD:

[rank: 16][epoch: 0][iter: 2] NEW GRAD:

[rank: 10][epoch: 0][iter: 2] NEW GRAD:

[rank: 4][epoch: 0][iter: 2] NEW GRAD:

[rank: 13][epoch: 0][iter: 2] NEW GRAD:

[rank: 23][epoch: 0][iter: 2] NEW GRAD:

[rank: 0][epoch: 0][iter: 2] NEW GRAD:

[rank: 18][epoch: 0][iter: 2] NEW GRAD:

[rank: 8][epoch: 0][iter: 2] NEW GRAD:

[rank: 7][epoch: 0][iter: 2] NEW GRAD:

[rank: 12][epoch: 0][iter: 2] NEW GRAD:

[rank: 22][epoch: 0][iter: 2] NEW GRAD:

[rank: 1][epoch: 0][iter: 2] NEW GRAD:

[rank: 19][epoch: 0][iter: 2] NEW GRAD:

[rank: 11][epoch: 0][iter: 2] NEW GRAD:

[rank: 6][epoch: 0][iter: 2] NEW GRAD:

[rank: 14][epoch: 0][iter: 2] NEW GRAD:
tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:0')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:2')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:1')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:1')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:1')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:3')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:1')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:3')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:0')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:2')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:0')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:1')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:3')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:0')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:2')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:0')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:3')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:0')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:2')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:1')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:3')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:3')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:2')tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:2')
[rank: 20][epoch: 0][iter: 2] NEW GRAD:
tensor([ 0.0028,  0.0247,  0.0162,  ...,  0.0033, -0.0150, -0.0199],
       device='cuda:0')
[rank: 2][epoch: 0][iter: 3] BEFORE:

[rank: 17][epoch: 0][iter: 3] BEFORE:
tensor([ 0.0429,  0.0213,  0.0530,  ..., -0.1593, -0.0994, -0.0865],
       device='cuda:2')
[rank: 5][epoch: 0][iter: 3] BEFORE:
tensor([ 0.0055,  0.0472,  0.0367,  ..., -0.1412, -0.0462, -0.0854],
       device='cuda:1')
[rank: 9][epoch: 0][iter: 3] BEFORE:

[rank: 15][epoch: 0][iter: 3] BEFORE:
tensor([-0.0498, -0.0830, -0.0665,  ...,  0.0294, -0.0425, -0.0185],
       device='cuda:1')
[rank: 3][epoch: 0][iter: 3] BEFORE:
tensor([-0.1164, -0.0140, -0.0394,  ...,  0.0376, -0.0090,  0.0309],
       device='cuda:1')
[rank: 16][epoch: 0][iter: 3] BEFORE:
tensor([-0.0088, -0.0342, -0.0526,  ...,  0.0055,  0.0787,  0.0814],
       device='cuda:3')
[rank: 4][epoch: 0][iter: 3] BEFORE:

[rank: 21][epoch: 0][iter: 3] BEFORE:
tensor([ 0.0459,  0.0455, -0.0526,  ..., -0.0022, -0.0098,  0.0099],
       device='cuda:3')
[rank: 13][epoch: 0][iter: 3] BEFORE:
tensor([-0.0386,  0.0392,  0.0415,  ...,  0.0990, -0.0514,  0.0551],
       device='cuda:0')tensor([ 0.0353,  0.0043,  0.0562,  ..., -0.0327, -0.0247,  0.0526],
       device='cuda:0')
[rank: 0][epoch: 0][iter: 3] BEFORE:

[rank: 8][epoch: 0][iter: 3] BEFORE:

[rank: 18][epoch: 0][iter: 3] BEFORE:
tensor([-0.0031,  0.0297, -0.0278,  ...,  0.0472,  0.1336,  0.0729],
       device='cuda:1')
[rank: 7][epoch: 0][iter: 3] BEFORE:

[rank: 22][epoch: 0][iter: 3] BEFORE:

[rank: 1][epoch: 0][iter: 3] BEFORE:

[rank: 11][epoch: 0][iter: 3] BEFORE:

[rank: 12][epoch: 0][iter: 3] BEFORE:
tensor([-0.0330, -0.1212, -0.0988,  ...,  0.0120,  0.0453, -0.0360],
       device='cuda:2')tensor([-0.0082,  0.0305,  0.0820,  ..., -0.0771, -0.0321, -0.0988],
       device='cuda:3')
[rank: 23][epoch: 0][iter: 3] BEFORE:
tensor([-0.0035,  0.0414, -0.0313,  ...,  0.0064, -0.0767, -0.0417],
       device='cuda:0')
[rank: 10][epoch: 0][iter: 3] BEFORE:

[rank: 14][epoch: 0][iter: 3] BEFORE:

[rank: 19][epoch: 0][iter: 3] BEFORE:

[rank: 20][epoch: 0][iter: 3] BEFORE:
tensor([-0.0558, -0.0738, -0.0331,  ..., -0.0229, -0.0453, -0.0246],
       device='cuda:1')
[rank: 6][epoch: 0][iter: 3] BEFORE:
tensor([ 0.0163,  0.0412, -0.0435,  ..., -0.0223,  0.0066, -0.0374],
       device='cuda:3')tensor([-0.0702, -0.0611,  0.0085,  ...,  0.1017,  0.0717,  0.0376],
       device='cuda:0')
[rank: 16][epoch: 0][iter: 3] AFTER HANDLE:
tensor([ 0.0535, -0.0201, -0.0454,  ...,  0.0352, -0.0023,  0.0496],
       device='cuda:3')
[rank: 3][epoch: 0][iter: 3] AFTER HANDLE:

[rank: 5][epoch: 0][iter: 3] AFTER HANDLE:
tensor([ 0.0923,  0.0808,  0.1046,  ...,  0.0184, -0.0497,  0.0561],
       device='cuda:2')
[rank: 13][epoch: 0][iter: 3] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 3] AFTER HANDLE:
tensor([0.0061, 0.0597, 0.0324,  ..., 0.0119, 0.0381, 0.0724], device='cuda:1')
[rank: 21][epoch: 0][iter: 3] AFTER HANDLE:

[rank: 2][epoch: 0][iter: 3] AFTER HANDLE:

[rank: 4][epoch: 0][iter: 3] AFTER HANDLE:

[rank: 9][epoch: 0][iter: 3] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 3] AFTER HANDLE:

[rank: 18][epoch: 0][iter: 3] AFTER HANDLE:
tensor([0.0383, 0.0237, 0.0099,  ..., 0.0079, 0.0022, 0.0121], device='cuda:2')
[rank: 22][epoch: 0][iter: 3] AFTER HANDLE:

[rank: 0][epoch: 0][iter: 3] AFTER HANDLE:

[rank: 7][epoch: 0][iter: 3] AFTER HANDLE:
tensor([0.0001, 0.0175, 0.0081,  ..., 0.0597, 0.0133, 0.0092], device='cuda:0')
[rank: 8][epoch: 0][iter: 3] AFTER HANDLE:
tensor([-0.0068, -0.0146, -0.0139,  ...,  0.0001, -0.0042,  0.0047],
       device='cuda:2')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:3')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:0')
[rank: 1][epoch: 0][iter: 3] AFTER HANDLE:
tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:2')
[rank: 11][epoch: 0][iter: 3] AFTER HANDLE:

[rank: 12][epoch: 0][iter: 3] AFTER HANDLE:
tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:0')
[rank: 23][epoch: 0][iter: 3] AFTER HANDLE:
tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:3')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:1')
[rank: 10][epoch: 0][iter: 3] AFTER HANDLE:
tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:1')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:1')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:1')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:2')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:0')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:1')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:3')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:2')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:2')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:0')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:3')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:0')
[rank: 14][epoch: 0][iter: 3] AFTER HANDLE:

[rank: 19][epoch: 0][iter: 3] AFTER HANDLE:

[rank: 20][epoch: 0][iter: 3] AFTER HANDLE:
tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:1')
[rank: 6][epoch: 0][iter: 3] AFTER HANDLE:
tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:3')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:0')
[rank: 16][epoch: 0][iter: 3] NEW GRAD:
tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:3')
[rank: 3][epoch: 0][iter: 3] NEW GRAD:

[rank: 5][epoch: 0][iter: 3] NEW GRAD:
tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:2')
[rank: 13][epoch: 0][iter: 3] NEW GRAD:

[rank: 17][epoch: 0][iter: 3] NEW GRAD:

[rank: 21][epoch: 0][iter: 3] NEW GRAD:

[rank: 2][epoch: 0][iter: 3] NEW GRAD:

[rank: 4][epoch: 0][iter: 3] NEW GRAD:

[rank: 9][epoch: 0][iter: 3] NEW GRAD:

[rank: 15][epoch: 0][iter: 3] NEW GRAD:

[rank: 18][epoch: 0][iter: 3] NEW GRAD:

[rank: 22][epoch: 0][iter: 3] NEW GRAD:

[rank: 0][epoch: 0][iter: 3] NEW GRAD:

[rank: 7][epoch: 0][iter: 3] NEW GRAD:

[rank: 8][epoch: 0][iter: 3] NEW GRAD:
tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:2')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:3')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:0')
[rank: 1][epoch: 0][iter: 3] NEW GRAD:
tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:2')
[rank: 11][epoch: 0][iter: 3] NEW GRAD:

[rank: 12][epoch: 0][iter: 3] NEW GRAD:
tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:0')
[rank: 23][epoch: 0][iter: 3] NEW GRAD:
tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:3')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:1')
[rank: 10][epoch: 0][iter: 3] NEW GRAD:
tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:1')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:1')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:1')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:2')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:0')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:1')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:3')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:2')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:2')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:0')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:3')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:0')
[rank: 14][epoch: 0][iter: 3] NEW GRAD:

[rank: 19][epoch: 0][iter: 3] NEW GRAD:

[rank: 20][epoch: 0][iter: 3] NEW GRAD:
tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:1')
[rank: 6][epoch: 0][iter: 3] NEW GRAD:
tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:3')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:0')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:3')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:3')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:2')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:2')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:2')tensor([-6.7820e-03, -1.4562e-02, -1.3893e-02,  ...,  9.9801e-05,
        -4.1812e-03,  4.7037e-03], device='cuda:0')
[rank: 16][epoch: 0][iter: 4] BEFORE:

[rank: 3][epoch: 0][iter: 4] BEFORE:
tensor([ 0.0729, -0.0030,  0.0603,  ...,  0.1165,  0.0524,  0.1016],
       device='cuda:0')
[rank: 5][epoch: 0][iter: 4] BEFORE:

[rank: 13][epoch: 0][iter: 4] BEFORE:
tensor([-0.0903,  0.0827,  0.0200,  ...,  0.0726,  0.0916,  0.0368],
       device='cuda:1')
[rank: 17][epoch: 0][iter: 4] BEFORE:
tensor([ 0.0293,  0.0411,  0.0642,  ...,  0.0200, -0.0383,  0.0505],
       device='cuda:1')tensor([ 0.0766,  0.1122,  0.0992,  ..., -0.1414, -0.0610, -0.0656],
       device='cuda:1')
[rank: 2][epoch: 0][iter: 4] BEFORE:

[rank: 15][epoch: 0][iter: 4] BEFORE:

[rank: 21][epoch: 0][iter: 4] BEFORE:
tensor([ 0.0069, -0.0411,  0.0440,  ..., -0.0826, -0.0310, -0.0970],
       device='cuda:2')tensor([ 0.0216,  0.0582, -0.0269,  ..., -0.0070,  0.0098, -0.0023],
       device='cuda:3')
[rank: 18][epoch: 0][iter: 4] BEFORE:
tensor([ 0.0450,  0.0656,  0.0484,  ..., -0.0262, -0.0465, -0.0350],
       device='cuda:1')
[rank: 7][epoch: 0][iter: 4] BEFORE:

[rank: 0][epoch: 0][iter: 4] BEFORE:
tensor([ 0.0321,  0.0499,  0.0654,  ...,  0.0073, -0.0510, -0.0346],
       device='cuda:2')
[rank: 22][epoch: 0][iter: 4] BEFORE:

[rank: 4][epoch: 0][iter: 4] BEFORE:

[rank: 1][epoch: 0][iter: 4] BEFORE:

[rank: 11][epoch: 0][iter: 4] BEFORE:
tensor([ 0.0888,  0.1236,  0.0675,  ..., -0.0497, -0.0330, -0.1212],
       device='cuda:3')tensor([-0.0594, -0.0670, -0.0633,  ..., -0.0338, -0.0425, -0.0209],
       device='cuda:2')tensor([-0.0091, -0.0897, -0.0738,  ...,  0.0157,  0.0496,  0.0778],
       device='cuda:0')
[rank: 9][epoch: 0][iter: 4] BEFORE:

[rank: 6][epoch: 0][iter: 4] BEFORE:

[rank: 8][epoch: 0][iter: 4] BEFORE:

[rank: 12][epoch: 0][iter: 4] BEFORE:
tensor([-0.0438, -0.0696,  0.0449,  ...,  0.0472,  0.0116,  0.0941],
       device='cuda:3')tensor([ 0.0217,  0.0176, -0.0042,  ...,  0.0692,  0.0042,  0.1033],
       device='cuda:2')
[rank: 19][epoch: 0][iter: 4] BEFORE:
tensor([ 0.0451,  0.1824,  0.0633,  ...,  0.0570, -0.0262,  0.0391],
       device='cuda:0')tensor([-0.0670, -0.0361, -0.0922,  ..., -0.0141,  0.1114, -0.0347],
       device='cuda:1')
[rank: 20][epoch: 0][iter: 4] BEFORE:
tensor([ 0.0732, -0.0866,  0.0238,  ...,  0.0390,  0.0693,  0.0675],
       device='cuda:3')
[rank: 14][epoch: 0][iter: 4] BEFORE:
tensor([-0.0244, -0.0129, -0.0114,  ...,  0.0776,  0.0186, -0.0171],
       device='cuda:0')
[rank: 23][epoch: 0][iter: 4] BEFORE:

[rank: 0][epoch: 0][iter: 4] AFTER HANDLE:

[rank: 16][epoch: 0][iter: 4] AFTER HANDLE:

[rank: 5][epoch: 0][iter: 4] AFTER HANDLE:

[rank: 13][epoch: 0][iter: 4] AFTER HANDLE:

[rank: 10][epoch: 0][iter: 4] BEFORE:
tensor([ 0.0267,  0.0385,  0.1515,  ..., -0.0628, -0.0440, -0.0984],
       device='cuda:0')tensor([0.0653, 0.0780, 0.0677,  ..., 0.0827, 0.0227, 0.0535], device='cuda:1')
[rank: 1][epoch: 0][iter: 4] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 4] AFTER HANDLE:

[rank: 7][epoch: 0][iter: 4] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 4] AFTER HANDLE:

[rank: 9][epoch: 0][iter: 4] AFTER HANDLE:

[rank: 21][epoch: 0][iter: 4] AFTER HANDLE:

[rank: 2][epoch: 0][iter: 4] AFTER HANDLE:

[rank: 19][epoch: 0][iter: 4] AFTER HANDLE:

[rank: 6][epoch: 0][iter: 4] AFTER HANDLE:

[rank: 12][epoch: 0][iter: 4] AFTER HANDLE:

[rank: 11][epoch: 0][iter: 4] AFTER HANDLE:

[rank: 22][epoch: 0][iter: 4] AFTER HANDLE:
tensor([0.0567, 0.0839, 0.0295,  ..., 0.0620, 0.0387, 0.0601], device='cuda:3')
[rank: 3][epoch: 0][iter: 4] AFTER HANDLE:

[rank: 18][epoch: 0][iter: 4] AFTER HANDLE:
tensor([0.0939, 0.1077, 0.0482,  ..., 0.0477, 0.0674, 0.1158], device='cuda:0')
[rank: 4][epoch: 0][iter: 4] AFTER HANDLE:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:2')
[rank: 14][epoch: 0][iter: 4] AFTER HANDLE:

[rank: 8][epoch: 0][iter: 4] AFTER HANDLE:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:3')
[rank: 23][epoch: 0][iter: 4] AFTER HANDLE:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:0')
[rank: 0][epoch: 0][iter: 4] NEW GRAD:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:0')
[rank: 16][epoch: 0][iter: 4] NEW GRAD:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:1')
[rank: 5][epoch: 0][iter: 4] NEW GRAD:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:1')
[rank: 13][epoch: 0][iter: 4] NEW GRAD:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:2')
[rank: 10][epoch: 0][iter: 4] AFTER HANDLE:

[rank: 20][epoch: 0][iter: 4] AFTER HANDLE:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:1')
[rank: 1][epoch: 0][iter: 4] NEW GRAD:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:1')
[rank: 17][epoch: 0][iter: 4] NEW GRAD:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:3')
[rank: 7][epoch: 0][iter: 4] NEW GRAD:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:3')
[rank: 15][epoch: 0][iter: 4] NEW GRAD:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:1')
[rank: 9][epoch: 0][iter: 4] NEW GRAD:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:1')
[rank: 21][epoch: 0][iter: 4] NEW GRAD:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:2')
[rank: 2][epoch: 0][iter: 4] NEW GRAD:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:3')
[rank: 19][epoch: 0][iter: 4] NEW GRAD:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:2')
[rank: 6][epoch: 0][iter: 4] NEW GRAD:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:0')
[rank: 12][epoch: 0][iter: 4] NEW GRAD:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:3')
[rank: 11][epoch: 0][iter: 4] NEW GRAD:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:2')
[rank: 22][epoch: 0][iter: 4] NEW GRAD:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:3')
[rank: 3][epoch: 0][iter: 4] NEW GRAD:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:2')
[rank: 18][epoch: 0][iter: 4] NEW GRAD:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:0')
[rank: 4][epoch: 0][iter: 4] NEW GRAD:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:2')
[rank: 14][epoch: 0][iter: 4] NEW GRAD:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:0')
[rank: 8][epoch: 0][iter: 4] NEW GRAD:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:3')
[rank: 23][epoch: 0][iter: 4] NEW GRAD:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:2')
[rank: 10][epoch: 0][iter: 4] NEW GRAD:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:0')
[rank: 20][epoch: 0][iter: 4] NEW GRAD:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:0')
[rank: 0][epoch: 0][iter: 5] BEFORE:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:0')
[rank: 16][epoch: 0][iter: 5] BEFORE:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:1')
[rank: 5][epoch: 0][iter: 5] BEFORE:
tensor([ 0.0744,  0.0883,  0.1259,  ..., -0.0462, -0.0633, -0.0158],
       device='cuda:0')tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:1')
[rank: 13][epoch: 0][iter: 5] BEFORE:
tensor([ 0.0537,  0.0097,  0.1039,  ..., -0.0504, -0.0800, -0.0688],
       device='cuda:0')tensor([ 0.0984, -0.0179,  0.0851,  ..., -0.0820, -0.0398, -0.0916],
       device='cuda:1')tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:1')
[rank: 1][epoch: 0][iter: 5] BEFORE:
tensor([-0.0036, -0.0463, -0.0209,  ...,  0.0078, -0.0089, -0.0299],
       device='cuda:1')tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:1')
[rank: 17][epoch: 0][iter: 5] BEFORE:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:3')
[rank: 7][epoch: 0][iter: 5] BEFORE:
tensor([-0.0311,  0.0298,  0.0039,  ..., -0.0801, -0.0475, -0.1039],
       device='cuda:1')tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:3')
[rank: 15][epoch: 0][iter: 5] BEFORE:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:1')
[rank: 9][epoch: 0][iter: 5] BEFORE:
tensor([-0.0566, -0.0603, -0.0171,  ..., -0.0443, -0.0309, -0.1050],
       device='cuda:1')tensor([ 0.0268, -0.0323, -0.0655,  ..., -0.0798, -0.0643, -0.0114],
       device='cuda:3')tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:2')
[rank: 2][epoch: 0][iter: 5] BEFORE:
tensor([ 0.0016,  0.0180, -0.0435,  ..., -0.1176, -0.0078, -0.0459],
       device='cuda:3')tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:3')
[rank: 11][epoch: 0][iter: 5] BEFORE:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:1')
[rank: 21][epoch: 0][iter: 5] BEFORE:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:2')
[rank: 6][epoch: 0][iter: 5] BEFORE:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:3')
[rank: 3][epoch: 0][iter: 5] BEFORE:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:3')
[rank: 19][epoch: 0][iter: 5] BEFORE:
tensor([-0.1311, -0.1798, -0.1601,  ...,  0.0367,  0.0053,  0.0378],
       device='cuda:1')tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:2')
[rank: 22][epoch: 0][iter: 5] BEFORE:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:0')
[rank: 4][epoch: 0][iter: 5] BEFORE:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:0')
[rank: 12][epoch: 0][iter: 5] BEFORE:
tensor([-0.0190, -0.0164, -0.0351,  ..., -0.1938, -0.0144, -0.0972],
       device='cuda:2')tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:2')
[rank: 18][epoch: 0][iter: 5] BEFORE:
tensor([ 0.0156,  0.1037,  0.0018,  ..., -0.0047, -0.0188, -0.0684],
       device='cuda:3')tensor([-0.1067, -0.1081, -0.1309,  ..., -0.0579, -0.0364, -0.0875],
       device='cuda:1')tensor([ 0.1023,  0.1444,  0.0790,  ..., -0.0310, -0.0723, -0.1513],
       device='cuda:2')tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:2')
[rank: 14][epoch: 0][iter: 5] BEFORE:
tensor([-0.0886, -0.1571, -0.0823,  ..., -0.0189, -0.0682,  0.0041],
       device='cuda:3')tensor([-0.0086,  0.0500,  0.0330,  ..., -0.1090, -0.1099, -0.0506],
       device='cuda:3')tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:0')
[rank: 8][epoch: 0][iter: 5] BEFORE:
tensor([ 0.0006, -0.0005,  0.0617,  ...,  0.0171,  0.0150,  0.0310],
       device='cuda:2')tensor([-0.0416, -0.0395, -0.0916,  ..., -0.0250, -0.0375, -0.0096],
       device='cuda:0')tensor([-0.0386,  0.0035, -0.0421,  ..., -0.0639, -0.0693, -0.0685],
       device='cuda:0')tensor([ 0.0406,  0.0606,  0.0121,  ..., -0.1582, -0.1251, -0.1958],
       device='cuda:2')tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:2')
[rank: 10][epoch: 0][iter: 5] BEFORE:

[rank: 0][epoch: 0][iter: 5] AFTER HANDLE:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:0')
[rank: 20][epoch: 0][iter: 5] BEFORE:

[rank: 5][epoch: 0][iter: 5] AFTER HANDLE:
tensor([-0.0216,  0.0172, -0.0274,  ...,  0.0229, -0.0042, -0.0447],
       device='cuda:2')
[rank: 16][epoch: 0][iter: 5] AFTER HANDLE:

[rank: 9][epoch: 0][iter: 5] AFTER HANDLE:

[rank: 1][epoch: 0][iter: 5] AFTER HANDLE:
tensor([0.0134, 0.0209, 0.0263,  ..., 0.0166, 0.0131, 0.0217], device='cuda:3')
[rank: 23][epoch: 0][iter: 5] BEFORE:

[rank: 7][epoch: 0][iter: 5] AFTER HANDLE:

[rank: 13][epoch: 0][iter: 5] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 5] AFTER HANDLE:

[rank: 11][epoch: 0][iter: 5] AFTER HANDLE:

[rank: 3][epoch: 0][iter: 5] AFTER HANDLE:

[rank: 21][epoch: 0][iter: 5] AFTER HANDLE:

[rank: 6][epoch: 0][iter: 5] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 5] AFTER HANDLE:

[rank: 19][epoch: 0][iter: 5] AFTER HANDLE:
tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:0')
[rank: 2][epoch: 0][iter: 5] AFTER HANDLE:

[rank: 22][epoch: 0][iter: 5] AFTER HANDLE:

[rank: 4][epoch: 0][iter: 5] AFTER HANDLE:

[rank: 12][epoch: 0][iter: 5] AFTER HANDLE:

[rank: 18][epoch: 0][iter: 5] AFTER HANDLE:
tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:2')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:0')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:0')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:1')
[rank: 14][epoch: 0][iter: 5] AFTER HANDLE:
tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:0')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:1')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:1')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:3')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:3')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:1')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:1')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:3')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:3')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:1')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:2')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:3')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:3')
[rank: 8][epoch: 0][iter: 5] AFTER HANDLE:
tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:2')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:2')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:0')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:0')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:2')
[rank: 10][epoch: 0][iter: 5] AFTER HANDLE:

[rank: 0][epoch: 0][iter: 5] NEW GRAD:

[rank: 20][epoch: 0][iter: 5] AFTER HANDLE:

[rank: 5][epoch: 0][iter: 5] NEW GRAD:
tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:2')
[rank: 16][epoch: 0][iter: 5] NEW GRAD:

[rank: 9][epoch: 0][iter: 5] NEW GRAD:

[rank: 1][epoch: 0][iter: 5] NEW GRAD:

[rank: 23][epoch: 0][iter: 5] AFTER HANDLE:

[rank: 7][epoch: 0][iter: 5] NEW GRAD:

[rank: 13][epoch: 0][iter: 5] NEW GRAD:

[rank: 17][epoch: 0][iter: 5] NEW GRAD:

[rank: 11][epoch: 0][iter: 5] NEW GRAD:

[rank: 3][epoch: 0][iter: 5] NEW GRAD:

[rank: 21][epoch: 0][iter: 5] NEW GRAD:

[rank: 6][epoch: 0][iter: 5] NEW GRAD:

[rank: 15][epoch: 0][iter: 5] NEW GRAD:

[rank: 19][epoch: 0][iter: 5] NEW GRAD:
tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:0')
[rank: 2][epoch: 0][iter: 5] NEW GRAD:

[rank: 22][epoch: 0][iter: 5] NEW GRAD:

[rank: 4][epoch: 0][iter: 5] NEW GRAD:

[rank: 12][epoch: 0][iter: 5] NEW GRAD:

[rank: 18][epoch: 0][iter: 5] NEW GRAD:
tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:2')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:0')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:0')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:1')
[rank: 14][epoch: 0][iter: 5] NEW GRAD:
tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:0')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:1')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:1')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:3')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:3')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:1')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:1')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:3')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:3')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:1')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:2')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:3')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:3')
[rank: 8][epoch: 0][iter: 5] NEW GRAD:
tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:2')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:2')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:0')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:0')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:2')
[rank: 10][epoch: 0][iter: 5] NEW GRAD:

[rank: 20][epoch: 0][iter: 5] NEW GRAD:
tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:2')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:0')
[rank: 23][epoch: 0][iter: 5] NEW GRAD:
tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:2')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:0')tensor([-0.0029, -0.0094, -0.0128,  ..., -0.0433, -0.0358, -0.0478],
       device='cuda:3')
[rank: 0][epoch: 0][iter: 6] BEFORE:

[rank: 5][epoch: 0][iter: 6] BEFORE:
tensor([-0.0593, -0.0486,  0.0006,  ...,  0.0520,  0.0306,  0.0406],
       device='cuda:0')tensor([ 0.0248,  0.0239,  0.0462,  ..., -0.0567, -0.0292, -0.1103],
       device='cuda:1')
[rank: 16][epoch: 0][iter: 6] BEFORE:

[rank: 1][epoch: 0][iter: 6] BEFORE:
tensor([-0.0956, -0.0320,  0.0024,  ...,  0.2100,  0.1399,  0.2031],
       device='cuda:0')
[rank: 7][epoch: 0][iter: 6] BEFORE:
tensor([-0.0250, -0.0392,  0.0167,  ..., -0.1291, -0.0062,  0.0673],
       device='cuda:1')
[rank: 13][epoch: 0][iter: 6] BEFORE:
tensor([ 0.0182, -0.0044,  0.0204,  ...,  0.0273, -0.0416, -0.0396],
       device='cuda:3')
[rank: 17][epoch: 0][iter: 6] BEFORE:

[rank: 11][epoch: 0][iter: 6] BEFORE:
tensor([-0.0127, -0.0351, -0.0172,  ..., -0.0791,  0.0261, -0.1656],
       device='cuda:1')
[rank: 3][epoch: 0][iter: 6] BEFORE:
tensor([-0.0557, -0.0327, -0.0148,  ..., -0.1159, -0.0852, -0.0802],
       device='cuda:1')tensor([-0.0186,  0.0528, -0.0923,  ...,  0.0181, -0.0435, -0.0332],
       device='cuda:3')
[rank: 15][epoch: 0][iter: 6] BEFORE:
tensor([-0.0285,  0.0410, -0.0985,  ..., -0.0207,  0.0251, -0.0807],
       device='cuda:3')
[rank: 6][epoch: 0][iter: 6] BEFORE:

[rank: 21][epoch: 0][iter: 6] BEFORE:
tensor([-0.0315, -0.0542, -0.1226,  ..., -0.0333, -0.0504, -0.0401],
       device='cuda:3')
[rank: 9][epoch: 0][iter: 6] BEFORE:

[rank: 2][epoch: 0][iter: 6] BEFORE:
tensor([ 0.0004, -0.0277, -0.0092,  ...,  0.0698,  0.1009,  0.0795],
       device='cuda:2')
[rank: 22][epoch: 0][iter: 6] BEFORE:

[rank: 19][epoch: 0][iter: 6] BEFORE:
tensor([ 0.0211,  0.0138, -0.0456,  ..., -0.0602, -0.0718, -0.1171],
       device='cuda:1')
[rank: 12][epoch: 0][iter: 6] BEFORE:

[rank: 4][epoch: 0][iter: 6] BEFORE:
tensor([ 0.0397,  0.0005,  0.0347,  ..., -0.0132, -0.0756, -0.1155],
       device='cuda:2')tensor([ 0.0231, -0.1082, -0.0344,  ..., -0.0409, -0.1850, -0.1207],
       device='cuda:1')
[rank: 18][epoch: 0][iter: 6] BEFORE:

[rank: 10][epoch: 0][iter: 6] BEFORE:

[rank: 14][epoch: 0][iter: 6] BEFORE:
tensor([-0.0314, -0.0054,  0.0176,  ...,  0.0129,  0.0094, -0.0282],
       device='cuda:0')tensor([ 0.0576,  0.0446,  0.0440,  ..., -0.1369, -0.0287,  0.0552],
       device='cuda:2')tensor([ 0.0895,  0.1001,  0.0860,  ..., -0.0937, -0.1130, -0.1125],
       device='cuda:3')
[rank: 8][epoch: 0][iter: 6] BEFORE:
tensor([ 0.0309, -0.0711, -0.0777,  ..., -0.1286, -0.0178, -0.1385],
       device='cuda:0')
[rank: 20][epoch: 0][iter: 6] BEFORE:
tensor([-0.0571, -0.0166, -0.0506,  ..., -0.1054, -0.0171, -0.0530],
       device='cuda:2')tensor([ 0.0323,  0.0238,  0.0467,  ..., -0.0939, -0.1047, -0.0348],
       device='cuda:2')tensor([-0.0426, -0.0157, -0.0844,  ..., -0.1038, -0.0794, -0.0454],
       device='cuda:2')
[rank: 23][epoch: 0][iter: 6] BEFORE:

[rank: 3][epoch: 0][iter: 6] AFTER HANDLE:

[rank: 16][epoch: 0][iter: 6] AFTER HANDLE:

[rank: 5][epoch: 0][iter: 6] AFTER HANDLE:
tensor([-0.0300, -0.0178, -0.0110,  ..., -0.0206, -0.1268, -0.1640],
       device='cuda:0')
[rank: 13][epoch: 0][iter: 6] AFTER HANDLE:
tensor([-0.0928, -0.0319, -0.0306,  ..., -0.1417, -0.0830, -0.0929],
       device='cuda:0')
[rank: 1][epoch: 0][iter: 6] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 6] AFTER HANDLE:

[rank: 4][epoch: 0][iter: 6] AFTER HANDLE:

[rank: 9][epoch: 0][iter: 6] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 6] AFTER HANDLE:

[rank: 21][epoch: 0][iter: 6] AFTER HANDLE:

[rank: 0][epoch: 0][iter: 6] AFTER HANDLE:

[rank: 18][epoch: 0][iter: 6] AFTER HANDLE:

[rank: 7][epoch: 0][iter: 6] AFTER HANDLE:

[rank: 11][epoch: 0][iter: 6] AFTER HANDLE:

[rank: 12][epoch: 0][iter: 6] AFTER HANDLE:

[rank: 22][epoch: 0][iter: 6] AFTER HANDLE:

[rank: 2][epoch: 0][iter: 6] AFTER HANDLE:

[rank: 19][epoch: 0][iter: 6] AFTER HANDLE:

[rank: 6][epoch: 0][iter: 6] AFTER HANDLE:

[rank: 10][epoch: 0][iter: 6] AFTER HANDLE:

[rank: 14][epoch: 0][iter: 6] AFTER HANDLE:
tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:3')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:3')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:0')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:1')
[rank: 8][epoch: 0][iter: 6] AFTER HANDLE:
tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:1')
[rank: 20][epoch: 0][iter: 6] AFTER HANDLE:
tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:1')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:1')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:0')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:1')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:3')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:1')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:0')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:2')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:3')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:3')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:0')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:2')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:2')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:3')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:2')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:2')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:2')
[rank: 23][epoch: 0][iter: 6] AFTER HANDLE:

[rank: 3][epoch: 0][iter: 6] NEW GRAD:

[rank: 16][epoch: 0][iter: 6] NEW GRAD:

[rank: 5][epoch: 0][iter: 6] NEW GRAD:
tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:0')
[rank: 13][epoch: 0][iter: 6] NEW GRAD:
tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:0')
[rank: 1][epoch: 0][iter: 6] NEW GRAD:

[rank: 17][epoch: 0][iter: 6] NEW GRAD:

[rank: 4][epoch: 0][iter: 6] NEW GRAD:

[rank: 9][epoch: 0][iter: 6] NEW GRAD:

[rank: 15][epoch: 0][iter: 6] NEW GRAD:

[rank: 21][epoch: 0][iter: 6] NEW GRAD:

[rank: 0][epoch: 0][iter: 6] NEW GRAD:

[rank: 18][epoch: 0][iter: 6] NEW GRAD:

[rank: 7][epoch: 0][iter: 6] NEW GRAD:

[rank: 11][epoch: 0][iter: 6] NEW GRAD:

[rank: 12][epoch: 0][iter: 6] NEW GRAD:

[rank: 22][epoch: 0][iter: 6] NEW GRAD:

[rank: 2][epoch: 0][iter: 6] NEW GRAD:

[rank: 19][epoch: 0][iter: 6] NEW GRAD:

[rank: 6][epoch: 0][iter: 6] NEW GRAD:

[rank: 10][epoch: 0][iter: 6] NEW GRAD:

[rank: 14][epoch: 0][iter: 6] NEW GRAD:
tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:3')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:3')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:0')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:1')
[rank: 8][epoch: 0][iter: 6] NEW GRAD:
tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:1')
[rank: 20][epoch: 0][iter: 6] NEW GRAD:
tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:1')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:1')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:0')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:1')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:3')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:1')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:0')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:2')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:3')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:3')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:0')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:2')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:2')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:3')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:2')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:2')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:2')
[rank: 23][epoch: 0][iter: 6] NEW GRAD:
tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:0')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:0')tensor([-0.0158, -0.0140, -0.0218,  ..., -0.0363, -0.0300, -0.0447],
       device='cuda:3')
[rank: 3][epoch: 0][iter: 7] BEFORE:

[rank: 16][epoch: 0][iter: 7] BEFORE:

[rank: 5][epoch: 0][iter: 7] BEFORE:
tensor([ 0.0885, -0.0042,  0.1048,  ...,  0.0477,  0.0812, -0.0149],
       device='cuda:3')
[rank: 13][epoch: 0][iter: 7] BEFORE:
tensor([-0.0284, -0.0228, -0.0208,  ..., -0.0745, -0.0489, -0.0566],
       device='cuda:1')
[rank: 1][epoch: 0][iter: 7] BEFORE:

[rank: 17][epoch: 0][iter: 7] BEFORE:
tensor([ 0.1447,  0.1916,  0.1568,  ..., -0.0414, -0.0237,  0.0261],
       device='cuda:1')
[rank: 4][epoch: 0][iter: 7] BEFORE:
tensor([ 0.2027,  0.1868,  0.2191,  ..., -0.1023, -0.0763,  0.0287],
       device='cuda:1')
[rank: 15][epoch: 0][iter: 7] BEFORE:

[rank: 9][epoch: 0][iter: 7] BEFORE:
tensor([-0.0321,  0.0006,  0.0896,  ..., -0.0185, -0.0335, -0.0509],
       device='cuda:0')tensor([-0.0128, -0.1310, -0.1186,  ...,  0.0905, -0.0266,  0.0094],
       device='cuda:3')
[rank: 7][epoch: 0][iter: 7] BEFORE:
tensor([ 0.0676, -0.0207, -0.0854,  ..., -0.0200, -0.0310, -0.0293],
       device='cuda:1')
[rank: 0][epoch: 0][iter: 7] BEFORE:

[rank: 18][epoch: 0][iter: 7] BEFORE:
tensor([ 0.0276,  0.0307, -0.0112,  ..., -0.1266,  0.0847,  0.0947],
       device='cuda:3')
[rank: 21][epoch: 0][iter: 7] BEFORE:

[rank: 11][epoch: 0][iter: 7] BEFORE:

[rank: 12][epoch: 0][iter: 7] BEFORE:
tensor([ 0.0158,  0.0272, -0.0542,  ..., -0.0354,  0.0323,  0.0247],
       device='cuda:0')tensor([ 0.0562, -0.0083, -0.0017,  ...,  0.3143,  0.0931,  0.1982],
       device='cuda:2')
[rank: 22][epoch: 0][iter: 7] BEFORE:

[rank: 6][epoch: 0][iter: 7] BEFORE:
tensor([-0.0262,  0.0845, -0.0753,  ...,  0.0805, -0.0101,  0.0277],
       device='cuda:3')
[rank: 14][epoch: 0][iter: 7] BEFORE:

[rank: 2][epoch: 0][iter: 7] BEFORE:
tensor([ 0.0477,  0.0366,  0.0770,  ..., -0.0073, -0.0683, -0.0437],
       device='cuda:1')
[rank: 8][epoch: 0][iter: 7] BEFORE:
tensor([ 0.0611, -0.0324,  0.0835,  ...,  0.0852,  0.0918,  0.0523],
       device='cuda:2')tensor([ 0.0424, -0.0166,  0.0064,  ...,  0.1491,  0.0989,  0.1188],
       device='cuda:0')
[rank: 19][epoch: 0][iter: 7] BEFORE:
tensor([ 0.1614,  0.2120,  0.2219,  ...,  0.0148,  0.0066, -0.0337],
       device='cuda:2')tensor([-0.0255, -0.0376,  0.0257,  ..., -0.0190, -0.0386, -0.0004],
       device='cuda:2')tensor([ 0.0772,  0.0852,  0.0991,  ...,  0.0563, -0.0067,  0.0065],
       device='cuda:0')tensor([-0.0944, -0.1002, -0.0290,  ...,  0.0088, -0.0584, -0.0810],
       device='cuda:2')tensor([ 0.0533,  0.0665, -0.0664,  ...,  0.0546,  0.0439,  0.0912],
       device='cuda:3')
[rank: 20][epoch: 0][iter: 7] BEFORE:

[rank: 10][epoch: 0][iter: 7] BEFORE:

[rank: 1][epoch: 0][iter: 7] AFTER HANDLE:

[rank: 5][epoch: 0][iter: 7] AFTER HANDLE:

[rank: 12][epoch: 0][iter: 7] AFTER HANDLE:
tensor([0.0586, 0.0148, 0.0342,  ..., 0.0386, 0.0628, 0.0450], device='cuda:0')
[rank: 16][epoch: 0][iter: 7] AFTER HANDLE:

[rank: 23][epoch: 0][iter: 7] BEFORE:

[rank: 11][epoch: 0][iter: 7] AFTER HANDLE:

[rank: 3][epoch: 0][iter: 7] AFTER HANDLE:

[rank: 7][epoch: 0][iter: 7] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 7] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 7] AFTER HANDLE:

[rank: 21][epoch: 0][iter: 7] AFTER HANDLE:

[rank: 8][epoch: 0][iter: 7] AFTER HANDLE:

[rank: 2][epoch: 0][iter: 7] AFTER HANDLE:

[rank: 6][epoch: 0][iter: 7] AFTER HANDLE:
tensor([0.1067, 0.0956, 0.0611,  ..., 0.1785, 0.0741, 0.1199], device='cuda:1')
[rank: 13][epoch: 0][iter: 7] AFTER HANDLE:

[rank: 18][epoch: 0][iter: 7] AFTER HANDLE:

[rank: 22][epoch: 0][iter: 7] AFTER HANDLE:

[rank: 9][epoch: 0][iter: 7] AFTER HANDLE:

[rank: 0][epoch: 0][iter: 7] AFTER HANDLE:

[rank: 4][epoch: 0][iter: 7] AFTER HANDLE:

[rank: 14][epoch: 0][iter: 7] AFTER HANDLE:

[rank: 19][epoch: 0][iter: 7] AFTER HANDLE:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:0')
[rank: 20][epoch: 0][iter: 7] AFTER HANDLE:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:2')
[rank: 10][epoch: 0][iter: 7] AFTER HANDLE:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:1')
[rank: 1][epoch: 0][iter: 7] NEW GRAD:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:1')
[rank: 5][epoch: 0][iter: 7] NEW GRAD:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:0')
[rank: 12][epoch: 0][iter: 7] NEW GRAD:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:0')
[rank: 16][epoch: 0][iter: 7] NEW GRAD:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:3')
[rank: 23][epoch: 0][iter: 7] AFTER HANDLE:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:3')
[rank: 11][epoch: 0][iter: 7] NEW GRAD:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:3')
[rank: 3][epoch: 0][iter: 7] NEW GRAD:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:3')
[rank: 7][epoch: 0][iter: 7] NEW GRAD:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:3')
[rank: 15][epoch: 0][iter: 7] NEW GRAD:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:1')
[rank: 17][epoch: 0][iter: 7] NEW GRAD:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:1')
[rank: 21][epoch: 0][iter: 7] NEW GRAD:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:0')
[rank: 8][epoch: 0][iter: 7] NEW GRAD:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:2')
[rank: 2][epoch: 0][iter: 7] NEW GRAD:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:2')
[rank: 6][epoch: 0][iter: 7] NEW GRAD:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:1')
[rank: 13][epoch: 0][iter: 7] NEW GRAD:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:2')
[rank: 18][epoch: 0][iter: 7] NEW GRAD:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:2')
[rank: 22][epoch: 0][iter: 7] NEW GRAD:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:1')
[rank: 9][epoch: 0][iter: 7] NEW GRAD:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:0')
[rank: 0][epoch: 0][iter: 7] NEW GRAD:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:0')
[rank: 4][epoch: 0][iter: 7] NEW GRAD:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:2')
[rank: 14][epoch: 0][iter: 7] NEW GRAD:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:3')
[rank: 19][epoch: 0][iter: 7] NEW GRAD:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:0')
[rank: 20][epoch: 0][iter: 7] NEW GRAD:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:2')
[rank: 10][epoch: 0][iter: 7] NEW GRAD:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:3')
[rank: 23][epoch: 0][iter: 7] NEW GRAD:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:1')
[rank: 1][epoch: 0][iter: 8] BEFORE:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:1')
[rank: 5][epoch: 0][iter: 8] BEFORE:
tensor([-0.0121,  0.0589,  0.0203,  ..., -0.0021,  0.0005,  0.0047],
       device='cuda:1')tensor([-0.0205, -0.0743, -0.0300,  ..., -0.0016,  0.0014, -0.0020],
       device='cuda:1')tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:0')
[rank: 16][epoch: 0][iter: 8] BEFORE:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:0')
[rank: 12][epoch: 0][iter: 8] BEFORE:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:3')
[rank: 11][epoch: 0][iter: 8] BEFORE:
tensor([ 0.0060,  0.0046,  0.0128,  ...,  0.0004,  0.0037, -0.0031],
       device='cuda:0')tensor([ 0.1133,  0.1651,  0.0077,  ...,  0.0020,  0.0005, -0.0014],
       device='cuda:0')tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:3')
[rank: 3][epoch: 0][iter: 8] BEFORE:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:3')
[rank: 7][epoch: 0][iter: 8] BEFORE:
tensor([-0.1023, -0.0553,  0.0270,  ..., -0.0005,  0.0015, -0.0020],
       device='cuda:3')tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:3')
[rank: 15][epoch: 0][iter: 8] BEFORE:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:1')
[rank: 17][epoch: 0][iter: 8] BEFORE:
tensor([ 0.0643,  0.1134,  0.1416,  ...,  0.0010,  0.0023, -0.0015],
       device='cuda:3')tensor([ 0.1080,  0.0720,  0.1454,  ..., -0.0024,  0.0017, -0.0017],
       device='cuda:3')tensor([ 0.0167, -0.0068, -0.0082,  ..., -0.0037,  0.0020, -0.0006],
       device='cuda:3')tensor([ 0.1986,  0.1894,  0.1432,  ..., -0.0030,  0.0008, -0.0003],
       device='cuda:1')tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:2')
[rank: 2][epoch: 0][iter: 8] BEFORE:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:1')
[rank: 21][epoch: 0][iter: 8] BEFORE:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:1')
[rank: 13][epoch: 0][iter: 8] BEFORE:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:2')
[rank: 6][epoch: 0][iter: 8] BEFORE:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:2')
[rank: 18][epoch: 0][iter: 8] BEFORE:
tensor([-0.0551, -0.0516, -0.0696,  ..., -0.0056,  0.0042,  0.0023],
       device='cuda:2')tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:2')
[rank: 22][epoch: 0][iter: 8] BEFORE:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:0')
[rank: 8][epoch: 0][iter: 8] BEFORE:
tensor([ 0.0010, -0.0964, -0.1258,  ..., -0.0058,  0.0041,  0.0037],
       device='cuda:1')tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:0')
[rank: 4][epoch: 0][iter: 8] BEFORE:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:0')
[rank: 0][epoch: 0][iter: 8] BEFORE:
tensor([ 0.0765,  0.0673,  0.1534,  ..., -0.0013, -0.0011,  0.0007],
       device='cuda:2')tensor([-0.1261, -0.0600, -0.2537,  ..., -0.0055,  0.0025,  0.0030],
       device='cuda:1')tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:2')
[rank: 10][epoch: 0][iter: 8] BEFORE:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:2')
[rank: 14][epoch: 0][iter: 8] BEFORE:
tensor([ 0.0765,  0.0360,  0.0617,  ...,  0.0010,  0.0007, -0.0021],
       device='cuda:2')tensor([ 0.1219,  0.0876,  0.1594,  ...,  0.0031, -0.0020, -0.0029],
       device='cuda:0')tensor([-0.1242, -0.0476, -0.1100,  ...,  0.0039, -0.0011, -0.0005],
       device='cuda:2')tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:1')
[rank: 9][epoch: 0][iter: 8] BEFORE:
tensor([ 0.0778,  0.1397,  0.1454,  ...,  0.0010, -0.0016,  0.0002],
       device='cuda:0')tensor([-0.0048,  0.0402, -0.0141,  ...,  0.0028,  0.0020, -0.0005],
       device='cuda:2')tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:0')
[rank: 20][epoch: 0][iter: 8] BEFORE:
tensor([-0.0162,  0.0521,  0.0180,  ...,  0.0004,  0.0003,  0.0016],
       device='cuda:2')tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:3')
[rank: 19][epoch: 0][iter: 8] BEFORE:
tensor([0.0430, 0.0282, 0.0303,  ..., 0.0349, 0.0145, 0.0250], device='cuda:3')
[rank: 23][epoch: 0][iter: 8] BEFORE:
tensor([-0.0123, -0.0094, -0.0809,  ...,  0.0005,  0.0004,  0.0041],
       device='cuda:1')
[rank: 0][epoch: 0][iter: 8] AFTER HANDLE:

[rank: 4][epoch: 0][iter: 8] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 8] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 8] AFTER HANDLE:
tensor([-1.5228e-02, -5.3250e-02,  1.9932e-03,  ..., -2.2324e-03,
         1.5698e-03, -4.2159e-05], device='cuda:0')
[rank: 10][epoch: 0][iter: 8] AFTER HANDLE:

[rank: 1][epoch: 0][iter: 8] AFTER HANDLE:

[rank: 5][epoch: 0][iter: 8] AFTER HANDLE:

[rank: 13][epoch: 0][iter: 8] AFTER HANDLE:

[rank: 16][epoch: 0][iter: 8] AFTER HANDLE:

[rank: 21][epoch: 0][iter: 8] AFTER HANDLE:
tensor([0.0230, 0.0211, 0.0501,  ..., 0.0008, 0.0018, 0.0028], device='cuda:0')
[rank: 8][epoch: 0][iter: 8] AFTER HANDLE:

[rank: 3][epoch: 0][iter: 8] AFTER HANDLE:

[rank: 7][epoch: 0][iter: 8] AFTER HANDLE:

[rank: 12][epoch: 0][iter: 8] AFTER HANDLE:

[rank: 18][epoch: 0][iter: 8] AFTER HANDLE:

[rank: 22][epoch: 0][iter: 8] AFTER HANDLE:

[rank: 11][epoch: 0][iter: 8] AFTER HANDLE:

[rank: 2][epoch: 0][iter: 8] AFTER HANDLE:

[rank: 6][epoch: 0][iter: 8] AFTER HANDLE:

[rank: 14][epoch: 0][iter: 8] AFTER HANDLE:
tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:3')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:3')
[rank: 9][epoch: 0][iter: 8] AFTER HANDLE:
tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:0')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:0')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:3')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:1')
[rank: 20][epoch: 0][iter: 8] AFTER HANDLE:
tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:2')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:1')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:1')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:1')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:0')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:1')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:0')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:3')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:3')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:0')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:2')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:2')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:3')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:2')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:2')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:2')
[rank: 19][epoch: 0][iter: 8] AFTER HANDLE:

[rank: 23][epoch: 0][iter: 8] AFTER HANDLE:
tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:1')
[rank: 0][epoch: 0][iter: 8] NEW GRAD:

[rank: 4][epoch: 0][iter: 8] NEW GRAD:

[rank: 15][epoch: 0][iter: 8] NEW GRAD:

[rank: 17][epoch: 0][iter: 8] NEW GRAD:
tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:0')
[rank: 10][epoch: 0][iter: 8] NEW GRAD:

[rank: 1][epoch: 0][iter: 8] NEW GRAD:

[rank: 5][epoch: 0][iter: 8] NEW GRAD:

[rank: 13][epoch: 0][iter: 8] NEW GRAD:

[rank: 16][epoch: 0][iter: 8] NEW GRAD:

[rank: 21][epoch: 0][iter: 8] NEW GRAD:

[rank: 8][epoch: 0][iter: 8] NEW GRAD:

[rank: 3][epoch: 0][iter: 8] NEW GRAD:

[rank: 7][epoch: 0][iter: 8] NEW GRAD:

[rank: 12][epoch: 0][iter: 8] NEW GRAD:

[rank: 18][epoch: 0][iter: 8] NEW GRAD:

[rank: 22][epoch: 0][iter: 8] NEW GRAD:

[rank: 11][epoch: 0][iter: 8] NEW GRAD:

[rank: 2][epoch: 0][iter: 8] NEW GRAD:

[rank: 6][epoch: 0][iter: 8] NEW GRAD:

[rank: 14][epoch: 0][iter: 8] NEW GRAD:
tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:3')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:3')
[rank: 9][epoch: 0][iter: 8] NEW GRAD:
tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:0')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:0')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:3')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:1')
[rank: 20][epoch: 0][iter: 8] NEW GRAD:
tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:2')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:1')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:1')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:1')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:0')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:1')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:0')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:3')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:3')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:0')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:2')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:2')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:3')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:2')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:2')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:2')
[rank: 19][epoch: 0][iter: 8] NEW GRAD:

[rank: 23][epoch: 0][iter: 8] NEW GRAD:
tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:1')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:3')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:0')tensor([ 0.0156,  0.0341,  0.0232,  ..., -0.0007,  0.0011,  0.0002],
       device='cuda:3')
[rank: 4][epoch: 0][iter: 9] BEFORE:

[rank: 15][epoch: 0][iter: 9] BEFORE:

[rank: 0][epoch: 0][iter: 9] BEFORE:

[rank: 17][epoch: 0][iter: 9] BEFORE:
tensor([-1.5832e-04,  1.9934e-03,  4.6504e-04,  ..., -2.3997e-03,
         4.1218e-05, -3.8411e-04], device='cuda:0')tensor([ 0.0008, -0.0016,  0.0006,  ...,  0.0009,  0.0014, -0.0014],
       device='cuda:3')
[rank: 1][epoch: 0][iter: 9] BEFORE:
tensor([-0.0078,  0.0030, -0.0014,  ...,  0.0025, -0.0012, -0.0007],
       device='cuda:1')
[rank: 5][epoch: 0][iter: 9] BEFORE:

[rank: 13][epoch: 0][iter: 9] BEFORE:
tensor([ 0.0023,  0.0001,  0.0031,  ..., -0.0005, -0.0003,  0.0017],
       device='cuda:0')
[rank: 16][epoch: 0][iter: 9] BEFORE:
tensor([ 0.0002, -0.0004,  0.0002,  ..., -0.0012, -0.0002, -0.0008],
       device='cuda:1')tensor([-0.0016, -0.0035,  0.0028,  ...,  0.0004,  0.0024, -0.0010],
       device='cuda:1')
[rank: 8][epoch: 0][iter: 9] BEFORE:
tensor([ 2.9014e-03,  2.4397e-03, -6.2394e-05,  ..., -1.8944e-03,
         1.0781e-03,  2.5593e-03], device='cuda:1')
[rank: 7][epoch: 0][iter: 9] BEFORE:
tensor([ 0.0023, -0.0026,  0.0004,  ...,  0.0006,  0.0025,  0.0027],
       device='cuda:0')
[rank: 21][epoch: 0][iter: 9] BEFORE:

[rank: 11][epoch: 0][iter: 9] BEFORE:

[rank: 12][epoch: 0][iter: 9] BEFORE:

[rank: 3][epoch: 0][iter: 9] BEFORE:
tensor([-0.0035, -0.0003,  0.0012,  ...,  0.0009, -0.0022, -0.0008],
       device='cuda:3')
[rank: 18][epoch: 0][iter: 9] BEFORE:

[rank: 22][epoch: 0][iter: 9] BEFORE:
tensor([ 0.0005, -0.0017,  0.0020,  ..., -0.0003,  0.0020,  0.0003],
       device='cuda:0')
[rank: 14][epoch: 0][iter: 9] BEFORE:

[rank: 2][epoch: 0][iter: 9] BEFORE:

[rank: 6][epoch: 0][iter: 9] BEFORE:
tensor([ 1.1811e-03, -2.5913e-03,  2.5628e-04,  ..., -5.6670e-04,
         6.6734e-04, -5.9675e-05], device='cuda:1')tensor([ 0.0021,  0.0026,  0.0020,  ...,  0.0023,  0.0002, -0.0003],
       device='cuda:2')
[rank: 10][epoch: 0][iter: 9] BEFORE:
tensor([-0.0012, -0.0012,  0.0023,  ...,  0.0022,  0.0018, -0.0017],
       device='cuda:0')tensor([-3.8133e-03, -5.5173e-04, -2.7572e-03,  ..., -8.1033e-05,
         9.1726e-04, -9.4749e-04], device='cuda:3')tensor([ 2.2168e-03,  2.1582e-03, -9.4261e-04,  ...,  1.1082e-03,
         5.3126e-04, -9.5434e-05], device='cuda:2')
[rank: 20][epoch: 0][iter: 9] BEFORE:
tensor([-0.0011, -0.0005,  0.0005,  ..., -0.0012, -0.0006, -0.0007],
       device='cuda:3')tensor([ 0.0035,  0.0031,  0.0058,  ...,  0.0021, -0.0006,  0.0023],
       device='cuda:2')tensor([ 0.0001, -0.0008,  0.0007,  ..., -0.0004,  0.0019,  0.0016],
       device='cuda:2')
[rank: 19][epoch: 0][iter: 9] BEFORE:
tensor([ 0.0017,  0.0028,  0.0005,  ..., -0.0024,  0.0006, -0.0006],
       device='cuda:2')
[rank: 5][epoch: 0][iter: 9] AFTER HANDLE:

[rank: 9][epoch: 0][iter: 9] BEFORE:

[rank: 13][epoch: 0][iter: 9] AFTER HANDLE:

[rank: 0][epoch: 0][iter: 9] AFTER HANDLE:

[rank: 16][epoch: 0][iter: 9] AFTER HANDLE:

[rank: 23][epoch: 0][iter: 9] BEFORE:

[rank: 7][epoch: 0][iter: 9] AFTER HANDLE:
tensor([ 1.0996e-03,  1.4387e-04,  4.0284e-05,  ..., -2.4462e-03,
         4.6401e-04, -1.8483e-03], device='cuda:2')
[rank: 12][epoch: 0][iter: 9] AFTER HANDLE:

[rank: 1][epoch: 0][iter: 9] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 9] AFTER HANDLE:

[rank: 21][epoch: 0][iter: 9] AFTER HANDLE:

[rank: 6][epoch: 0][iter: 9] AFTER HANDLE:

[rank: 8][epoch: 0][iter: 9] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 9] AFTER HANDLE:

[rank: 3][epoch: 0][iter: 9] AFTER HANDLE:

[rank: 18][epoch: 0][iter: 9] AFTER HANDLE:
tensor([-0.0001, -0.0000,  0.0006,  ...,  0.0002,  0.0007,  0.0000],
       device='cuda:0')
[rank: 4][epoch: 0][iter: 9] AFTER HANDLE:

[rank: 11][epoch: 0][iter: 9] AFTER HANDLE:

[rank: 14][epoch: 0][iter: 9] AFTER HANDLE:

[rank: 2][epoch: 0][iter: 9] AFTER HANDLE:
tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:3')
[rank: 22][epoch: 0][iter: 9] AFTER HANDLE:
tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:1')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:1')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:1')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:0')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:0')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:3')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:3')
[rank: 10][epoch: 0][iter: 9] AFTER HANDLE:
tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:0')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:1')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:1')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:1')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:2')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:0')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:3')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:3')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:2')
[rank: 20][epoch: 0][iter: 9] AFTER HANDLE:
tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:0')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:3')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:2')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:2')
[rank: 19][epoch: 0][iter: 9] AFTER HANDLE:
tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:2')
[rank: 5][epoch: 0][iter: 9] NEW GRAD:

[rank: 9][epoch: 0][iter: 9] AFTER HANDLE:

[rank: 13][epoch: 0][iter: 9] NEW GRAD:

[rank: 0][epoch: 0][iter: 9] NEW GRAD:

[rank: 16][epoch: 0][iter: 9] NEW GRAD:

[rank: 23][epoch: 0][iter: 9] AFTER HANDLE:

[rank: 7][epoch: 0][iter: 9] NEW GRAD:
tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:2')
[rank: 12][epoch: 0][iter: 9] NEW GRAD:

[rank: 1][epoch: 0][iter: 9] NEW GRAD:

[rank: 17][epoch: 0][iter: 9] NEW GRAD:

[rank: 21][epoch: 0][iter: 9] NEW GRAD:

[rank: 6][epoch: 0][iter: 9] NEW GRAD:

[rank: 8][epoch: 0][iter: 9] NEW GRAD:

[rank: 15][epoch: 0][iter: 9] NEW GRAD:

[rank: 3][epoch: 0][iter: 9] NEW GRAD:

[rank: 18][epoch: 0][iter: 9] NEW GRAD:
tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:0')
[rank: 4][epoch: 0][iter: 9] NEW GRAD:

[rank: 11][epoch: 0][iter: 9] NEW GRAD:

[rank: 14][epoch: 0][iter: 9] NEW GRAD:

[rank: 2][epoch: 0][iter: 9] NEW GRAD:
tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:3')
[rank: 22][epoch: 0][iter: 9] NEW GRAD:
tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:1')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:1')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:1')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:0')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:0')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:3')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:3')
[rank: 10][epoch: 0][iter: 9] NEW GRAD:
tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:0')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:1')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:1')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:1')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:2')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:0')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:3')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:3')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:2')
[rank: 20][epoch: 0][iter: 9] NEW GRAD:
tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:0')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:3')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:2')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:2')
[rank: 19][epoch: 0][iter: 9] NEW GRAD:
tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:2')
[rank: 9][epoch: 0][iter: 9] NEW GRAD:

[rank: 23][epoch: 0][iter: 9] NEW GRAD:
tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:3')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:2')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:0')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:1')tensor([-1.4692e-04, -2.1230e-05,  5.7234e-04,  ...,  1.7153e-04,
         7.3878e-04,  3.8666e-05], device='cuda:3')
[rank: 5][epoch: 0][iter: 10] BEFORE:
tensor([-0.0019, -0.0003, -0.0003,  ..., -0.0017, -0.0001, -0.0022],
       device='cuda:1')
[rank: 13][epoch: 0][iter: 10] BEFORE:
tensor([-0.0010,  0.0003, -0.0015,  ...,  0.0007,  0.0016, -0.0003],
       device='cuda:1')
[rank: 16][epoch: 0][iter: 10] BEFORE:

[rank: 7][epoch: 0][iter: 10] BEFORE:

[rank: 0][epoch: 0][iter: 10] BEFORE:
tensor([ 0.0002, -0.0008, -0.0004,  ..., -0.0029,  0.0002, -0.0036],
       device='cuda:0')tensor([-0.0009, -0.0010,  0.0006,  ...,  0.0032, -0.0001,  0.0002],
       device='cuda:3')
[rank: 1][epoch: 0][iter: 10] BEFORE:

[rank: 12][epoch: 0][iter: 10] BEFORE:

[rank: 17][epoch: 0][iter: 10] BEFORE:
tensor([-0.0009, -0.0007, -0.0004,  ..., -0.0019, -0.0007, -0.0002],
       device='cuda:0')tensor([-8.5593e-05,  1.3270e-03, -1.3622e-03,  ..., -4.7373e-03,
         4.2747e-03,  2.7081e-03], device='cuda:0')
[rank: 8][epoch: 0][iter: 10] BEFORE:
tensor([-0.0013, -0.0002,  0.0020,  ...,  0.0040,  0.0048,  0.0035],
       device='cuda:1')tensor([-3.4823e-05,  1.0829e-03,  2.7097e-03,  ...,  2.3601e-03,
         1.7907e-03,  4.4806e-03], device='cuda:1')
[rank: 15][epoch: 0][iter: 10] BEFORE:

[rank: 6][epoch: 0][iter: 10] BEFORE:

[rank: 21][epoch: 0][iter: 10] BEFORE:
tensor([-0.0008,  0.0022,  0.0007,  ..., -0.0024, -0.0031, -0.0022],
       device='cuda:0')
[rank: 3][epoch: 0][iter: 10] BEFORE:

[rank: 18][epoch: 0][iter: 10] BEFORE:
tensor([ 8.4253e-04, -7.2115e-04, -7.3297e-05,  ..., -1.5857e-03,
         2.4925e-03, -1.4952e-03], device='cuda:3')
[rank: 4][epoch: 0][iter: 10] BEFORE:

[rank: 11][epoch: 0][iter: 10] BEFORE:
tensor([-0.0007,  0.0008,  0.0025,  ...,  0.0006,  0.0057,  0.0010],
       device='cuda:1')tensor([ 0.0005, -0.0006,  0.0006,  ...,  0.0026,  0.0065,  0.0029],
       device='cuda:3')
[rank: 14][epoch: 0][iter: 10] BEFORE:
tensor([-0.0025, -0.0002, -0.0030,  ..., -0.0044,  0.0007, -0.0031],
       device='cuda:2')tensor([-0.0004, -0.0004,  0.0064,  ..., -0.0005, -0.0068, -0.0016],
       device='cuda:2')tensor([-0.0029,  0.0010,  0.0016,  ..., -0.0032,  0.0044,  0.0038],
       device='cuda:3')
[rank: 22][epoch: 0][iter: 10] BEFORE:

[rank: 2][epoch: 0][iter: 10] BEFORE:
tensor([ 0.0006,  0.0004, -0.0008,  ...,  0.0018,  0.0023,  0.0026],
       device='cuda:2')tensor([ 1.5506e-03, -5.2301e-05, -1.4442e-03,  ...,  1.2794e-03,
        -2.1544e-03,  3.3950e-03], device='cuda:0')
[rank: 10][epoch: 0][iter: 10] BEFORE:

[rank: 20][epoch: 0][iter: 10] BEFORE:
tensor([-0.0007,  0.0009, -0.0013,  ...,  0.0018, -0.0027,  0.0005],
       device='cuda:2')tensor([-0.0010, -0.0004,  0.0021,  ...,  0.0035,  0.0020,  0.0005],
       device='cuda:2')tensor([ 0.0008, -0.0002,  0.0020,  ...,  0.0031, -0.0005,  0.0009],
       device='cuda:2')tensor([-0.0008,  0.0002,  0.0004,  ...,  0.0005,  0.0046, -0.0040],
       device='cuda:0')
[rank: 19][epoch: 0][iter: 10] BEFORE:
tensor([-0.0002,  0.0004,  0.0004,  ..., -0.0011, -0.0035, -0.0028],
       device='cuda:3')
[rank: 23][epoch: 0][iter: 10] BEFORE:

[rank: 0][epoch: 0][iter: 10] AFTER HANDLE:

[rank: 10][epoch: 0][iter: 10] AFTER HANDLE:

[rank: 13][epoch: 0][iter: 10] AFTER HANDLE:

[rank: 4][epoch: 0][iter: 10] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 10] AFTER HANDLE:

[rank: 22][epoch: 0][iter: 10] AFTER HANDLE:

[rank: 3][epoch: 0][iter: 10] AFTER HANDLE:

[rank: 11][epoch: 0][iter: 10] AFTER HANDLE:

[rank: 12][epoch: 0][iter: 10] AFTER HANDLE:

[rank: 5][epoch: 0][iter: 10] AFTER HANDLE:

[rank: 19][epoch: 0][iter: 10] AFTER HANDLE:

[rank: 20][epoch: 0][iter: 10] AFTER HANDLE:

[rank: 2][epoch: 0][iter: 10] AFTER HANDLE:

[rank: 8][epoch: 0][iter: 10] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 10] AFTER HANDLE:

[rank: 6][epoch: 0][iter: 10] AFTER HANDLE:

[rank: 16][epoch: 0][iter: 10] AFTER HANDLE:

[rank: 21][epoch: 0][iter: 10] AFTER HANDLE:

[rank: 1][epoch: 0][iter: 10] AFTER HANDLE:

[rank: 9][epoch: 0][iter: 10] BEFORE:

[rank: 14][epoch: 0][iter: 10] AFTER HANDLE:

[rank: 7][epoch: 0][iter: 10] AFTER HANDLE:

[rank: 18][epoch: 0][iter: 10] AFTER HANDLE:
tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:3')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:0')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:2')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:1')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:0')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:1')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:2')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:3')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:3')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:0')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:1')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:3')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:0')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:2')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:0')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:3')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:2')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:0')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:1')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:1')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:1')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:2')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:3')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:2')
[rank: 23][epoch: 0][iter: 10] AFTER HANDLE:

[rank: 0][epoch: 0][iter: 10] NEW GRAD:

[rank: 10][epoch: 0][iter: 10] NEW GRAD:

[rank: 13][epoch: 0][iter: 10] NEW GRAD:

[rank: 4][epoch: 0][iter: 10] NEW GRAD:

[rank: 17][epoch: 0][iter: 10] NEW GRAD:

[rank: 22][epoch: 0][iter: 10] NEW GRAD:

[rank: 3][epoch: 0][iter: 10] NEW GRAD:

[rank: 11][epoch: 0][iter: 10] NEW GRAD:

[rank: 12][epoch: 0][iter: 10] NEW GRAD:

[rank: 5][epoch: 0][iter: 10] NEW GRAD:

[rank: 19][epoch: 0][iter: 10] NEW GRAD:

[rank: 20][epoch: 0][iter: 10] NEW GRAD:

[rank: 2][epoch: 0][iter: 10] NEW GRAD:

[rank: 8][epoch: 0][iter: 10] NEW GRAD:

[rank: 15][epoch: 0][iter: 10] NEW GRAD:

[rank: 6][epoch: 0][iter: 10] NEW GRAD:

[rank: 16][epoch: 0][iter: 10] NEW GRAD:

[rank: 21][epoch: 0][iter: 10] NEW GRAD:

[rank: 1][epoch: 0][iter: 10] NEW GRAD:

[rank: 9][epoch: 0][iter: 10] AFTER HANDLE:

[rank: 14][epoch: 0][iter: 10] NEW GRAD:

[rank: 7][epoch: 0][iter: 10] NEW GRAD:

[rank: 18][epoch: 0][iter: 10] NEW GRAD:
tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:3')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:0')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:2')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:1')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:0')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:1')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:2')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:3')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:3')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:0')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:1')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:3')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:0')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:2')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:0')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:3')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:2')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:0')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:1')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:1')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:1')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:2')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:3')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:2')
[rank: 23][epoch: 0][iter: 10] NEW GRAD:

[rank: 9][epoch: 0][iter: 10] NEW GRAD:
tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:3')tensor([-5.2793e-04,  2.3845e-04,  6.0021e-04,  ..., -6.9002e-05,
         7.8837e-04,  2.1430e-04], device='cuda:1')
[rank: 0][epoch: 0][iter: 11] BEFORE:

[rank: 13][epoch: 0][iter: 11] BEFORE:

[rank: 4][epoch: 0][iter: 11] BEFORE:
tensor([-4.2989e-04, -8.3735e-04,  1.3135e-04,  ..., -1.2961e-03,
        -1.8577e-05,  1.0630e-04], device='cuda:0')tensor([-0.0024, -0.0087,  0.0014,  ..., -0.0004, -0.0021,  0.0076],
       device='cuda:1')
[rank: 17][epoch: 0][iter: 11] BEFORE:
tensor([ 0.0012, -0.0003,  0.0036,  ..., -0.0026,  0.0023,  0.0012],
       device='cuda:0')
[rank: 3][epoch: 0][iter: 11] BEFORE:

[rank: 22][epoch: 0][iter: 11] BEFORE:

[rank: 11][epoch: 0][iter: 11] BEFORE:
tensor([-0.0004, -0.0002, -0.0005,  ..., -0.0002,  0.0013,  0.0005],
       device='cuda:1')
[rank: 5][epoch: 0][iter: 11] BEFORE:

[rank: 12][epoch: 0][iter: 11] BEFORE:
tensor([-7.0645e-04, -1.5235e-03,  9.1732e-04,  ...,  6.2005e-04,
        -4.6663e-05, -9.4420e-04], device='cuda:3')tensor([ 0.0015,  0.0032, -0.0020,  ..., -0.0012, -0.0011,  0.0026],
       device='cuda:2')tensor([-0.0007, -0.0017,  0.0003,  ..., -0.0011,  0.0003,  0.0042],
       device='cuda:3')tensor([ 0.0060, -0.0008, -0.0019,  ..., -0.0008, -0.0022, -0.0005],
       device='cuda:1')
[rank: 15][epoch: 0][iter: 11] BEFORE:

[rank: 2][epoch: 0][iter: 11] BEFORE:

[rank: 20][epoch: 0][iter: 11] BEFORE:

[rank: 8][epoch: 0][iter: 11] BEFORE:
tensor([-0.0045,  0.0006, -0.0004,  ...,  0.0014, -0.0016,  0.0018],
       device='cuda:0')
[rank: 16][epoch: 0][iter: 11] BEFORE:

[rank: 1][epoch: 0][iter: 11] BEFORE:

[rank: 6][epoch: 0][iter: 11] BEFORE:

[rank: 10][epoch: 0][iter: 11] BEFORE:
tensor([ 0.0027,  0.0045, -0.0012,  ..., -0.0019, -0.0046,  0.0115],
       device='cuda:0')tensor([ 0.0009,  0.0041,  0.0001,  ..., -0.0016, -0.0009, -0.0033],
       device='cuda:3')
[rank: 19][epoch: 0][iter: 11] BEFORE:
tensor([-0.0016,  0.0004,  0.0008,  ...,  0.0007, -0.0009,  0.0038],
       device='cuda:2')
[rank: 7][epoch: 0][iter: 11] BEFORE:
tensor([ 0.0036,  0.0024, -0.0017,  ..., -0.0025,  0.0013,  0.0046],
       device='cuda:0')
[rank: 21][epoch: 0][iter: 11] BEFORE:

[rank: 14][epoch: 0][iter: 11] BEFORE:
tensor([ 7.3738e-03,  4.4657e-03, -2.5629e-03,  ...,  1.3220e-03,
        -1.5039e-04, -8.0852e-05], device='cuda:0')tensor([ 0.0019,  0.0016, -0.0012,  ...,  0.0007, -0.0014,  0.0013],
       device='cuda:1')tensor([-0.0005,  0.0016, -0.0004,  ...,  0.0004, -0.0007, -0.0022],
       device='cuda:2')tensor([-3.6258e-04, -1.8625e-03,  1.6353e-03,  ...,  3.5528e-03,
        -9.0727e-05,  8.8397e-04], device='cuda:2')tensor([-1.8455e-03,  2.8710e-03, -1.4601e-03,  ...,  5.5558e-05,
        -7.8288e-06, -2.3813e-05], device='cuda:1')
[rank: 18][epoch: 0][iter: 11] BEFORE:
tensor([-0.0014, -0.0004,  0.0025,  ...,  0.0005,  0.0015,  0.0018],
       device='cuda:2')tensor([ 0.0006, -0.0009,  0.0014,  ...,  0.0002, -0.0024, -0.0005],
       device='cuda:3')
[rank: 9][epoch: 0][iter: 11] BEFORE:

[rank: 0][epoch: 0][iter: 11] AFTER HANDLE:

[rank: 23][epoch: 0][iter: 11] BEFORE:
tensor([-0.0037, -0.0025, -0.0019,  ...,  0.0011, -0.0005,  0.0015],
       device='cuda:3')
[rank: 13][epoch: 0][iter: 11] AFTER HANDLE:

[rank: 5][epoch: 0][iter: 11] AFTER HANDLE:

[rank: 8][epoch: 0][iter: 11] AFTER HANDLE:

[rank: 1][epoch: 0][iter: 11] AFTER HANDLE:

[rank: 22][epoch: 0][iter: 11] AFTER HANDLE:

[rank: 16][epoch: 0][iter: 11] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 11] AFTER HANDLE:

[rank: 6][epoch: 0][iter: 11] AFTER HANDLE:

[rank: 10][epoch: 0][iter: 11] AFTER HANDLE:

[rank: 2][epoch: 0][iter: 11] AFTER HANDLE:

[rank: 20][epoch: 0][iter: 11] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 11] AFTER HANDLE:

[rank: 12][epoch: 0][iter: 11] AFTER HANDLE:

[rank: 4][epoch: 0][iter: 11] AFTER HANDLE:

[rank: 11][epoch: 0][iter: 11] AFTER HANDLE:

[rank: 3][epoch: 0][iter: 11] AFTER HANDLE:

[rank: 21][epoch: 0][iter: 11] AFTER HANDLE:
tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:2')
[rank: 14][epoch: 0][iter: 11] AFTER HANDLE:

[rank: 7][epoch: 0][iter: 11] AFTER HANDLE:
tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:1')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:0')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:3')
[rank: 19][epoch: 0][iter: 11] AFTER HANDLE:
tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:1')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:1')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:0')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:1')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:2')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:0')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:3')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:2')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:2')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:2')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:0')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:1')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:0')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:0')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:3')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:3')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:1')
[rank: 18][epoch: 0][iter: 11] AFTER HANDLE:
tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:2')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:3')
[rank: 9][epoch: 0][iter: 11] AFTER HANDLE:

[rank: 0][epoch: 0][iter: 11] NEW GRAD:

[rank: 23][epoch: 0][iter: 11] AFTER HANDLE:
tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:3')
[rank: 13][epoch: 0][iter: 11] NEW GRAD:

[rank: 5][epoch: 0][iter: 11] NEW GRAD:

[rank: 8][epoch: 0][iter: 11] NEW GRAD:

[rank: 1][epoch: 0][iter: 11] NEW GRAD:

[rank: 22][epoch: 0][iter: 11] NEW GRAD:

[rank: 16][epoch: 0][iter: 11] NEW GRAD:

[rank: 15][epoch: 0][iter: 11] NEW GRAD:

[rank: 6][epoch: 0][iter: 11] NEW GRAD:

[rank: 10][epoch: 0][iter: 11] NEW GRAD:

[rank: 2][epoch: 0][iter: 11] NEW GRAD:

[rank: 20][epoch: 0][iter: 11] NEW GRAD:

[rank: 17][epoch: 0][iter: 11] NEW GRAD:

[rank: 12][epoch: 0][iter: 11] NEW GRAD:

[rank: 4][epoch: 0][iter: 11] NEW GRAD:

[rank: 11][epoch: 0][iter: 11] NEW GRAD:

[rank: 3][epoch: 0][iter: 11] NEW GRAD:

[rank: 21][epoch: 0][iter: 11] NEW GRAD:
tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:2')
[rank: 14][epoch: 0][iter: 11] NEW GRAD:

[rank: 7][epoch: 0][iter: 11] NEW GRAD:
tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:1')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:0')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:3')
[rank: 19][epoch: 0][iter: 11] NEW GRAD:
tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:1')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:1')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:0')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:1')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:2')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:0')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:3')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:2')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:2')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:2')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:0')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:1')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:0')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:0')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:3')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:3')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:1')
[rank: 18][epoch: 0][iter: 11] NEW GRAD:
tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:2')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:3')
[rank: 9][epoch: 0][iter: 11] NEW GRAD:

[rank: 23][epoch: 0][iter: 11] NEW GRAD:
tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:3')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:1')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:3')tensor([ 2.5145e-04,  1.6363e-04, -9.7624e-05,  ..., -1.9975e-04,
        -6.6257e-04,  1.5968e-03], device='cuda:2')
[rank: 0][epoch: 0][iter: 12] BEFORE:

[rank: 13][epoch: 0][iter: 12] BEFORE:

[rank: 5][epoch: 0][iter: 12] BEFORE:
tensor([ 0.0009,  0.0002,  0.0012,  ..., -0.0016,  0.0021,  0.0015],
       device='cuda:1')
[rank: 8][epoch: 0][iter: 12] BEFORE:
tensor([ 0.0027,  0.0005,  0.0014,  ...,  0.0020,  0.0022, -0.0038],
       device='cuda:1')tensor([-0.0058, -0.0004, -0.0086,  ...,  0.0023, -0.0028, -0.0007],
       device='cuda:0')
[rank: 16][epoch: 0][iter: 12] BEFORE:

[rank: 15][epoch: 0][iter: 12] BEFORE:

[rank: 22][epoch: 0][iter: 12] BEFORE:
tensor([ 0.0010, -0.0002, -0.0003,  ...,  0.0004, -0.0004, -0.0007],
       device='cuda:0')tensor([ 0.0065,  0.0014,  0.0032,  ..., -0.0015, -0.0014, -0.0014],
       device='cuda:3')
[rank: 1][epoch: 0][iter: 12] BEFORE:

[rank: 10][epoch: 0][iter: 12] BEFORE:
tensor([ 1.9603e-03,  1.0612e-02, -1.1395e-03,  ...,  4.3525e-04,
         1.5207e-03,  2.3491e-05], device='cuda:2')
[rank: 2][epoch: 0][iter: 12] BEFORE:

[rank: 17][epoch: 0][iter: 12] BEFORE:

[rank: 6][epoch: 0][iter: 12] BEFORE:

[rank: 20][epoch: 0][iter: 12] BEFORE:
tensor([-4.3964e-04, -5.8248e-04, -3.5050e-05,  ...,  7.9865e-04,
         6.0826e-04, -1.6339e-03], device='cuda:2')tensor([-0.0016,  0.0006,  0.0006,  ..., -0.0006, -0.0004,  0.0006],
       device='cuda:1')
[rank: 4][epoch: 0][iter: 12] BEFORE:
tensor([-0.0003, -0.0005, -0.0013,  ..., -0.0003, -0.0006, -0.0014],
       device='cuda:1')
[rank: 12][epoch: 0][iter: 12] BEFORE:

[rank: 11][epoch: 0][iter: 12] BEFORE:
tensor([ 0.0054,  0.0046, -0.0036,  ...,  0.0002,  0.0019,  0.0003],
       device='cuda:0')tensor([-0.0022,  0.0028,  0.0020,  ..., -0.0013, -0.0029, -0.0036],
       device='cuda:2')tensor([ 0.0018,  0.0020,  0.0010,  ..., -0.0004, -0.0022,  0.0016],
       device='cuda:2')
[rank: 14][epoch: 0][iter: 12] BEFORE:
tensor([-0.0070,  0.0008, -0.0052,  ..., -0.0010, -0.0008, -0.0003],
       device='cuda:3')
[rank: 21][epoch: 0][iter: 12] BEFORE:

[rank: 3][epoch: 0][iter: 12] BEFORE:

[rank: 7][epoch: 0][iter: 12] BEFORE:
tensor([-0.0046, -0.0023, -0.0009,  ..., -0.0004,  0.0005,  0.0007],
       device='cuda:0')
[rank: 18][epoch: 0][iter: 12] BEFORE:
tensor([ 3.3155e-06,  8.0907e-05,  1.6894e-03,  ...,  7.4335e-04,
         7.3645e-04, -2.0073e-03], device='cuda:1')tensor([ 0.0032,  0.0015, -0.0020,  ..., -0.0001, -0.0020, -0.0035],
       device='cuda:3')tensor([ 0.0002, -0.0004,  0.0018,  ...,  0.0018, -0.0073,  0.0003],
       device='cuda:0')tensor([-0.0009,  0.0009,  0.0037,  ..., -0.0011, -0.0030,  0.0036],
       device='cuda:2')tensor([-0.0010, -0.0019, -0.0002,  ...,  0.0013,  0.0005,  0.0020],
       device='cuda:2')tensor([ 0.0119,  0.0039,  0.0045,  ..., -0.0038,  0.0047,  0.0012],
       device='cuda:3')
[rank: 23][epoch: 0][iter: 12] BEFORE:

[rank: 9][epoch: 0][iter: 12] BEFORE:

[rank: 19][epoch: 0][iter: 12] BEFORE:

[rank: 2][epoch: 0][iter: 12] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 12] AFTER HANDLE:

[rank: 5][epoch: 0][iter: 12] AFTER HANDLE:

[rank: 21][epoch: 0][iter: 12] AFTER HANDLE:

[rank: 8][epoch: 0][iter: 12] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 12] AFTER HANDLE:

[rank: 1][epoch: 0][iter: 12] AFTER HANDLE:

[rank: 13][epoch: 0][iter: 12] AFTER HANDLE:

[rank: 4][epoch: 0][iter: 12] AFTER HANDLE:

[rank: 22][epoch: 0][iter: 12] AFTER HANDLE:

[rank: 10][epoch: 0][iter: 12] AFTER HANDLE:

[rank: 18][epoch: 0][iter: 12] AFTER HANDLE:
tensor([0.0098, 0.0048, 0.0096,  ..., 0.0026, 0.0061, 0.0006], device='cuda:0')
[rank: 0][epoch: 0][iter: 12] AFTER HANDLE:

[rank: 14][epoch: 0][iter: 12] AFTER HANDLE:

[rank: 6][epoch: 0][iter: 12] AFTER HANDLE:

[rank: 20][epoch: 0][iter: 12] AFTER HANDLE:

[rank: 11][epoch: 0][iter: 12] AFTER HANDLE:

[rank: 16][epoch: 0][iter: 12] AFTER HANDLE:

[rank: 3][epoch: 0][iter: 12] AFTER HANDLE:

[rank: 12][epoch: 0][iter: 12] AFTER HANDLE:

[rank: 7][epoch: 0][iter: 12] AFTER HANDLE:
tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:3')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:1')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:3')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:2')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:3')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:1')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:1')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:0')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:1')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:1')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:1')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:0')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:2')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:2')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:2')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:0')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:2')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:2')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:0')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:3')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:0')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:3')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:0')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:3')
[rank: 23][epoch: 0][iter: 12] AFTER HANDLE:

[rank: 9][epoch: 0][iter: 12] AFTER HANDLE:

[rank: 19][epoch: 0][iter: 12] AFTER HANDLE:

[rank: 2][epoch: 0][iter: 12] NEW GRAD:

[rank: 15][epoch: 0][iter: 12] NEW GRAD:

[rank: 5][epoch: 0][iter: 12] NEW GRAD:

[rank: 21][epoch: 0][iter: 12] NEW GRAD:

[rank: 8][epoch: 0][iter: 12] NEW GRAD:

[rank: 17][epoch: 0][iter: 12] NEW GRAD:

[rank: 1][epoch: 0][iter: 12] NEW GRAD:

[rank: 13][epoch: 0][iter: 12] NEW GRAD:

[rank: 4][epoch: 0][iter: 12] NEW GRAD:

[rank: 22][epoch: 0][iter: 12] NEW GRAD:

[rank: 10][epoch: 0][iter: 12] NEW GRAD:

[rank: 18][epoch: 0][iter: 12] NEW GRAD:

[rank: 0][epoch: 0][iter: 12] NEW GRAD:

[rank: 14][epoch: 0][iter: 12] NEW GRAD:

[rank: 6][epoch: 0][iter: 12] NEW GRAD:

[rank: 20][epoch: 0][iter: 12] NEW GRAD:

[rank: 11][epoch: 0][iter: 12] NEW GRAD:

[rank: 16][epoch: 0][iter: 12] NEW GRAD:

[rank: 3][epoch: 0][iter: 12] NEW GRAD:

[rank: 12][epoch: 0][iter: 12] NEW GRAD:

[rank: 7][epoch: 0][iter: 12] NEW GRAD:
tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:3')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:1')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:3')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:2')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:3')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:1')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:1')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:0')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:1')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:1')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:1')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:0')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:2')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:2')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:2')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:0')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:2')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:2')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:0')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:3')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:0')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:3')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:0')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:3')
[rank: 23][epoch: 0][iter: 12] NEW GRAD:

[rank: 9][epoch: 0][iter: 12] NEW GRAD:

[rank: 19][epoch: 0][iter: 12] NEW GRAD:
tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:3')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:1')tensor([ 1.0884e-03,  1.2026e-03,  4.8625e-04,  ..., -1.6181e-05,
        -1.0013e-03, -3.3759e-04], device='cuda:3')
[rank: 15][epoch: 0][iter: 13] BEFORE:

[rank: 2][epoch: 0][iter: 13] BEFORE:

[rank: 5][epoch: 0][iter: 13] BEFORE:
tensor([ 0.0036, -0.0004, -0.0052,  ...,  0.0004, -0.0002, -0.0003],
       device='cuda:3')tensor([-0.0030, -0.0046,  0.0026,  ..., -0.0045, -0.0016, -0.0023],
       device='cuda:2')
[rank: 8][epoch: 0][iter: 13] BEFORE:

[rank: 17][epoch: 0][iter: 13] BEFORE:

[rank: 1][epoch: 0][iter: 13] BEFORE:
tensor([-6.9415e-05, -6.1960e-04,  2.7436e-03,  ...,  2.3637e-03,
        -1.9079e-03, -4.1491e-03], device='cuda:0')
[rank: 13][epoch: 0][iter: 13] BEFORE:
tensor([ 0.0034,  0.0028,  0.0060,  ...,  0.0017, -0.0003,  0.0006],
       device='cuda:1')
[rank: 21][epoch: 0][iter: 13] BEFORE:
tensor([-0.0003,  0.0018,  0.0005,  ...,  0.0019,  0.0018,  0.0041],
       device='cuda:1')tensor([ 5.4196e-05, -1.8356e-03, -5.4334e-03,  ...,  5.1930e-04,
        -6.8019e-04, -9.3502e-04], device='cuda:1')
[rank: 4][epoch: 0][iter: 13] BEFORE:
tensor([-0.0013, -0.0014, -0.0009,  ..., -0.0026,  0.0019,  0.0059],
       device='cuda:1')
[rank: 18][epoch: 0][iter: 13] BEFORE:

[rank: 10][epoch: 0][iter: 13] BEFORE:
tensor([-1.1286e-03, -4.6450e-04, -1.2484e-03,  ...,  1.9006e-04,
         7.9414e-05,  6.0945e-03], device='cuda:0')
[rank: 22][epoch: 0][iter: 13] BEFORE:

[rank: 14][epoch: 0][iter: 13] BEFORE:
tensor([ 0.0014,  0.0014, -0.0011,  ...,  0.0011,  0.0020,  0.0061],
       device='cuda:2')tensor([-0.0006, -0.0014,  0.0009,  ..., -0.0053, -0.0008, -0.0034],
       device='cuda:2')
[rank: 6][epoch: 0][iter: 13] BEFORE:

[rank: 0][epoch: 0][iter: 13] BEFORE:
tensor([ 0.0008,  0.0013,  0.0013,  ..., -0.0003, -0.0004,  0.0033],
       device='cuda:2')tensor([-0.0009, -0.0045,  0.0022,  ..., -0.0005, -0.0010, -0.0009],
       device='cuda:2')
[rank: 16][epoch: 0][iter: 13] BEFORE:

[rank: 11][epoch: 0][iter: 13] BEFORE:

[rank: 7][epoch: 0][iter: 13] BEFORE:

[rank: 3][epoch: 0][iter: 13] BEFORE:

[rank: 20][epoch: 0][iter: 13] BEFORE:

[rank: 12][epoch: 0][iter: 13] BEFORE:
tensor([-0.0015,  0.0009, -0.0016,  ..., -0.0008,  0.0052,  0.0050],
       device='cuda:0')
[rank: 9][epoch: 0][iter: 13] BEFORE:
tensor([ 0.0025, -0.0038,  0.0010,  ...,  0.0016, -0.0007, -0.0005],
       device='cuda:2')tensor([-0.0021,  0.0013,  0.0013,  ..., -0.0008, -0.0008,  0.0025],
       device='cuda:0')tensor([-0.0014,  0.0016,  0.0003,  ...,  0.0012, -0.0051, -0.0039],
       device='cuda:0')tensor([ 1.7891e-07,  9.5359e-04, -4.7531e-03,  ..., -4.2898e-04,
        -2.5450e-03,  1.0569e-03], device='cuda:0')tensor([-0.0007, -0.0034,  0.0002,  ..., -0.0015, -0.0014, -0.0046],
       device='cuda:3')tensor([-0.0007,  0.0021, -0.0002,  ...,  0.0004,  0.0020,  0.0012],
       device='cuda:3')
[rank: 23][epoch: 0][iter: 13] BEFORE:
tensor([ 1.8444e-06,  1.7240e-03,  8.4151e-04,  ..., -2.6407e-04,
         2.7648e-03, -2.0139e-04], device='cuda:1')
[rank: 19][epoch: 0][iter: 13] BEFORE:

[rank: 3][epoch: 0][iter: 13] AFTER HANDLE:

[rank: 12][epoch: 0][iter: 13] AFTER HANDLE:

[rank: 4][epoch: 0][iter: 13] AFTER HANDLE:

[rank: 21][epoch: 0][iter: 13] AFTER HANDLE:

[rank: 8][epoch: 0][iter: 13] AFTER HANDLE:

[rank: 16][epoch: 0][iter: 13] AFTER HANDLE:

[rank: 0][epoch: 0][iter: 13] AFTER HANDLE:

[rank: 13][epoch: 0][iter: 13] AFTER HANDLE:

[rank: 6][epoch: 0][iter: 13] AFTER HANDLE:

[rank: 20][epoch: 0][iter: 13] AFTER HANDLE:

[rank: 10][epoch: 0][iter: 13] AFTER HANDLE:

[rank: 18][epoch: 0][iter: 13] AFTER HANDLE:

[rank: 1][epoch: 0][iter: 13] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 13] AFTER HANDLE:
tensor([0.0013, 0.0004, 0.0051,  ..., 0.0005, 0.0016, 0.0057], device='cuda:3')
[rank: 7][epoch: 0][iter: 13] AFTER HANDLE:

[rank: 22][epoch: 0][iter: 13] AFTER HANDLE:

[rank: 11][epoch: 0][iter: 13] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 13] AFTER HANDLE:

[rank: 2][epoch: 0][iter: 13] AFTER HANDLE:

[rank: 14][epoch: 0][iter: 13] AFTER HANDLE:
tensor([0.0012, 0.0021, 0.0019,  ..., 0.0013, 0.0029, 0.0003], device='cuda:1')
[rank: 5][epoch: 0][iter: 13] AFTER HANDLE:
tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:3')
[rank: 9][epoch: 0][iter: 13] AFTER HANDLE:
tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:3')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:3')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:0')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:0')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:1')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:0')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:0')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:0')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:1')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:2')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:0')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:2')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:2')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:1')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:3')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:3')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:2')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:3')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:1')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:2')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:2')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:1')
[rank: 23][epoch: 0][iter: 13] AFTER HANDLE:
tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:1')
[rank: 19][epoch: 0][iter: 13] AFTER HANDLE:

[rank: 3][epoch: 0][iter: 13] NEW GRAD:

[rank: 12][epoch: 0][iter: 13] NEW GRAD:

[rank: 4][epoch: 0][iter: 13] NEW GRAD:

[rank: 21][epoch: 0][iter: 13] NEW GRAD:

[rank: 8][epoch: 0][iter: 13] NEW GRAD:

[rank: 16][epoch: 0][iter: 13] NEW GRAD:

[rank: 0][epoch: 0][iter: 13] NEW GRAD:

[rank: 13][epoch: 0][iter: 13] NEW GRAD:

[rank: 6][epoch: 0][iter: 13] NEW GRAD:

[rank: 20][epoch: 0][iter: 13] NEW GRAD:

[rank: 10][epoch: 0][iter: 13] NEW GRAD:

[rank: 18][epoch: 0][iter: 13] NEW GRAD:

[rank: 1][epoch: 0][iter: 13] NEW GRAD:

[rank: 15][epoch: 0][iter: 13] NEW GRAD:

[rank: 7][epoch: 0][iter: 13] NEW GRAD:

[rank: 22][epoch: 0][iter: 13] NEW GRAD:

[rank: 11][epoch: 0][iter: 13] NEW GRAD:

[rank: 17][epoch: 0][iter: 13] NEW GRAD:

[rank: 2][epoch: 0][iter: 13] NEW GRAD:

[rank: 14][epoch: 0][iter: 13] NEW GRAD:

[rank: 5][epoch: 0][iter: 13] NEW GRAD:
tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:3')
[rank: 9][epoch: 0][iter: 13] NEW GRAD:
tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:3')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:3')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:0')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:0')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:1')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:0')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:0')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:0')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:1')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:2')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:0')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:2')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:2')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:1')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:3')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:3')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:2')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:3')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:1')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:2')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:2')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:1')
[rank: 23][epoch: 0][iter: 13] NEW GRAD:
tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:1')
[rank: 19][epoch: 0][iter: 13] NEW GRAD:
tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:3')tensor([-9.6173e-05, -1.6153e-04,  5.0201e-04,  ..., -2.3652e-04,
         2.0308e-04,  9.1833e-04], device='cuda:3')
[rank: 3][epoch: 0][iter: 14] BEFORE:
tensor([-3.1688e-04,  1.8787e-03, -7.4526e-04,  ..., -2.6428e-03,
        -3.3351e-04,  9.8317e-06], device='cuda:3')
[rank: 4][epoch: 0][iter: 14] BEFORE:

[rank: 12][epoch: 0][iter: 14] BEFORE:

[rank: 8][epoch: 0][iter: 14] BEFORE:
tensor([-0.0031, -0.0024, -0.0036,  ...,  0.0008, -0.0042,  0.0053],
       device='cuda:0')tensor([ 0.0007,  0.0019,  0.0014,  ..., -0.0019, -0.0005, -0.0014],
       device='cuda:0')
[rank: 16][epoch: 0][iter: 14] BEFORE:
tensor([ 3.0612e-03, -4.9377e-05,  2.5833e-03,  ..., -2.6927e-03,
         1.5752e-03,  1.1153e-03], device='cuda:0')
[rank: 13][epoch: 0][iter: 14] BEFORE:

[rank: 0][epoch: 0][iter: 14] BEFORE:

[rank: 21][epoch: 0][iter: 14] BEFORE:
tensor([ 0.0007, -0.0007,  0.0032,  ..., -0.0052, -0.0045, -0.0001],
       device='cuda:0')tensor([-6.6624e-04, -1.9255e-03,  9.4320e-05,  ...,  1.1953e-03,
         8.4808e-04,  6.1903e-03], device='cuda:1')
[rank: 10][epoch: 0][iter: 14] BEFORE:
tensor([ 0.0007, -0.0003, -0.0004,  ...,  0.0002,  0.0010, -0.0024],
       device='cuda:0')
[rank: 20][epoch: 0][iter: 14] BEFORE:

[rank: 15][epoch: 0][iter: 14] BEFORE:

[rank: 6][epoch: 0][iter: 14] BEFORE:

[rank: 18][epoch: 0][iter: 14] BEFORE:
tensor([-0.0008, -0.0012,  0.0023,  ...,  0.0025, -0.0013, -0.0011],
       device='cuda:2')tensor([ 0.0032,  0.0016,  0.0017,  ..., -0.0103, -0.0013, -0.0006],
       device='cuda:1')tensor([ 8.4183e-04,  7.8223e-05, -1.3114e-03,  ..., -1.0208e-03,
        -3.2029e-03,  1.5794e-03], device='cuda:3')
[rank: 7][epoch: 0][iter: 14] BEFORE:
tensor([-0.0022, -0.0044,  0.0006,  ...,  0.0007,  0.0012, -0.0018],
       device='cuda:2')
[rank: 11][epoch: 0][iter: 14] BEFORE:
tensor([ 0.0026,  0.0064,  0.0077,  ...,  0.0010,  0.0003, -0.0057],
       device='cuda:0')
[rank: 1][epoch: 0][iter: 14] BEFORE:

[rank: 5][epoch: 0][iter: 14] BEFORE:

[rank: 14][epoch: 0][iter: 14] BEFORE:

[rank: 17][epoch: 0][iter: 14] BEFORE:
tensor([-0.0028,  0.0007,  0.0019,  ...,  0.0022,  0.0003,  0.0018],
       device='cuda:3')
[rank: 22][epoch: 0][iter: 14] BEFORE:

[rank: 2][epoch: 0][iter: 14] BEFORE:
tensor([ 0.0009, -0.0009,  0.0020,  ...,  0.0057, -0.0011, -0.0032],
       device='cuda:3')tensor([ 0.0021,  0.0011,  0.0009,  ..., -0.0019,  0.0001,  0.0005],
       device='cuda:2')tensor([ 0.0004, -0.0031,  0.0005,  ..., -0.0006,  0.0010, -0.0012],
       device='cuda:1')tensor([-0.0043, -0.0037,  0.0008,  ...,  0.0004,  0.0014, -0.0001],
       device='cuda:1')tensor([ 7.0353e-04,  1.7469e-03,  2.6726e-04,  ...,  6.1438e-04,
        -6.2581e-05, -2.4475e-03], device='cuda:2')tensor([ 9.4093e-04,  4.3272e-05,  2.0932e-03,  ...,  1.1781e-03,
         7.2083e-04, -2.6443e-03], device='cuda:1')
[rank: 9][epoch: 0][iter: 14] BEFORE:
tensor([-6.0976e-05,  2.2849e-03, -9.6025e-05,  ..., -2.0412e-03,
         3.8376e-03,  2.9333e-04], device='cuda:2')
[rank: 23][epoch: 0][iter: 14] BEFORE:

[rank: 19][epoch: 0][iter: 14] BEFORE:

[rank: 8][epoch: 0][iter: 14] AFTER HANDLE:

[rank: 13][epoch: 0][iter: 14] AFTER HANDLE:

[rank: 7][epoch: 0][iter: 14] AFTER HANDLE:

[rank: 0][epoch: 0][iter: 14] AFTER HANDLE:

[rank: 20][epoch: 0][iter: 14] AFTER HANDLE:

[rank: 16][epoch: 0][iter: 14] AFTER HANDLE:

[rank: 10][epoch: 0][iter: 14] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 14] AFTER HANDLE:

[rank: 5][epoch: 0][iter: 14] AFTER HANDLE:

[rank: 3][epoch: 0][iter: 14] AFTER HANDLE:

[rank: 21][epoch: 0][iter: 14] AFTER HANDLE:

[rank: 18][epoch: 0][iter: 14] AFTER HANDLE:

[rank: 11][epoch: 0][iter: 14] AFTER HANDLE:

[rank: 14][epoch: 0][iter: 14] AFTER HANDLE:
tensor([0.0002, 0.0022, 0.0016,  ..., 0.0002, 0.0008, 0.0021], device='cuda:2')
[rank: 6][epoch: 0][iter: 14] AFTER HANDLE:

[rank: 1][epoch: 0][iter: 14] AFTER HANDLE:

[rank: 22][epoch: 0][iter: 14] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 14] AFTER HANDLE:
tensor([ 0.0004,  0.0003,  0.0012,  ..., -0.0005,  0.0000, -0.0000],
       device='cuda:1')
[rank: 12][epoch: 0][iter: 14] AFTER HANDLE:

[rank: 4][epoch: 0][iter: 14] AFTER HANDLE:

[rank: 2][epoch: 0][iter: 14] AFTER HANDLE:
tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:3')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:3')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:0')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:1')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:3')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:0')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:0')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:0')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:2')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:3')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:1')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:3')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:1')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:2')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:3')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:2')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:2')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:1')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:2')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:1')
[rank: 9][epoch: 0][iter: 14] AFTER HANDLE:
tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:0')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:0')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:2')
[rank: 23][epoch: 0][iter: 14] AFTER HANDLE:

[rank: 19][epoch: 0][iter: 14] AFTER HANDLE:

[rank: 8][epoch: 0][iter: 14] NEW GRAD:

[rank: 13][epoch: 0][iter: 14] NEW GRAD:

[rank: 7][epoch: 0][iter: 14] NEW GRAD:

[rank: 0][epoch: 0][iter: 14] NEW GRAD:

[rank: 20][epoch: 0][iter: 14] NEW GRAD:

[rank: 16][epoch: 0][iter: 14] NEW GRAD:

[rank: 10][epoch: 0][iter: 14] NEW GRAD:

[rank: 15][epoch: 0][iter: 14] NEW GRAD:

[rank: 5][epoch: 0][iter: 14] NEW GRAD:

[rank: 3][epoch: 0][iter: 14] NEW GRAD:

[rank: 21][epoch: 0][iter: 14] NEW GRAD:

[rank: 18][epoch: 0][iter: 14] NEW GRAD:

[rank: 11][epoch: 0][iter: 14] NEW GRAD:

[rank: 14][epoch: 0][iter: 14] NEW GRAD:

[rank: 6][epoch: 0][iter: 14] NEW GRAD:

[rank: 1][epoch: 0][iter: 14] NEW GRAD:

[rank: 22][epoch: 0][iter: 14] NEW GRAD:

[rank: 17][epoch: 0][iter: 14] NEW GRAD:
tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:1')
[rank: 12][epoch: 0][iter: 14] NEW GRAD:

[rank: 4][epoch: 0][iter: 14] NEW GRAD:

[rank: 2][epoch: 0][iter: 14] NEW GRAD:
tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:3')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:3')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:0')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:1')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:3')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:0')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:0')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:0')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:2')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:3')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:1')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:3')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:1')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:2')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:3')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:2')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:2')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:1')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:2')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:1')
[rank: 9][epoch: 0][iter: 14] NEW GRAD:
tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:0')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:0')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:2')
[rank: 23][epoch: 0][iter: 14] NEW GRAD:

[rank: 19][epoch: 0][iter: 14] NEW GRAD:
tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:1')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:3')tensor([ 3.5931e-04,  2.6516e-04,  1.2486e-03,  ..., -4.9344e-04,
         6.1247e-06, -3.6795e-05], device='cuda:3')
[rank: 8][epoch: 0][iter: 15] BEFORE:

[rank: 13][epoch: 0][iter: 15] BEFORE:
tensor([ 5.4626e-05,  1.7169e-03, -6.5515e-04,  ...,  3.4651e-03,
         1.0598e-03,  6.5817e-04], device='cuda:0')
[rank: 7][epoch: 0][iter: 15] BEFORE:
tensor([ 0.0071, -0.0018, -0.0006,  ...,  0.0009,  0.0013,  0.0006],
       device='cuda:1')
[rank: 0][epoch: 0][iter: 15] BEFORE:
tensor([ 0.0034,  0.0022, -0.0002,  ..., -0.0002,  0.0007,  0.0004],
       device='cuda:3')tensor([ 1.7019e-03, -1.2933e-03,  5.5116e-04,  ..., -1.8889e-03,
         2.1246e-05,  6.6739e-04], device='cuda:0')
[rank: 16][epoch: 0][iter: 15] BEFORE:

[rank: 15][epoch: 0][iter: 15] BEFORE:

[rank: 20][epoch: 0][iter: 15] BEFORE:
tensor([ 0.0143, -0.0015, -0.0018,  ..., -0.0002,  0.0004, -0.0025],
       device='cuda:0')
[rank: 5][epoch: 0][iter: 15] BEFORE:
tensor([ 0.0084, -0.0010, -0.0019,  ...,  0.0015,  0.0019, -0.0020],
       device='cuda:3')
[rank: 3][epoch: 0][iter: 15] BEFORE:
tensor([ 0.0009,  0.0057, -0.0025,  ...,  0.0010,  0.0020,  0.0009],
       device='cuda:0')
[rank: 10][epoch: 0][iter: 15] BEFORE:
tensor([-0.0006, -0.0016,  0.0012,  ...,  0.0012, -0.0011,  0.0006],
       device='cuda:1')
[rank: 21][epoch: 0][iter: 15] BEFORE:
tensor([ 0.0035, -0.0004,  0.0015,  ..., -0.0001, -0.0033, -0.0072],
       device='cuda:3')
[rank: 18][epoch: 0][iter: 15] BEFORE:

[rank: 11][epoch: 0][iter: 15] BEFORE:

[rank: 14][epoch: 0][iter: 15] BEFORE:
tensor([-2.0030e-03,  2.1930e-03,  3.9979e-04,  ..., -1.9736e-05,
         4.2185e-03,  3.4484e-03], device='cuda:1')
[rank: 1][epoch: 0][iter: 15] BEFORE:
tensor([-0.0021,  0.0001, -0.0011,  ..., -0.0017, -0.0033, -0.0023],
       device='cuda:2')tensor([-0.0035,  0.0019,  0.0012,  ...,  0.0018, -0.0079, -0.0050],
       device='cuda:2')
[rank: 6][epoch: 0][iter: 15] BEFORE:
tensor([-6.9530e-04,  1.5641e-03,  7.1722e-04,  ...,  4.5452e-04,
         7.0183e-05,  6.1890e-04], device='cuda:2')tensor([ 0.0018,  0.0021,  0.0010,  ...,  0.0011,  0.0005, -0.0012],
       device='cuda:1')tensor([ 0.0065, -0.0036, -0.0026,  ...,  0.0012, -0.0010,  0.0018],
       device='cuda:3')
[rank: 17][epoch: 0][iter: 15] BEFORE:

[rank: 4][epoch: 0][iter: 15] BEFORE:

[rank: 12][epoch: 0][iter: 15] BEFORE:

[rank: 2][epoch: 0][iter: 15] BEFORE:

[rank: 9][epoch: 0][iter: 15] BEFORE:
tensor([ 0.0043, -0.0051, -0.0009,  ..., -0.0005,  0.0014,  0.0002],
       device='cuda:2')tensor([-0.0037,  0.0014,  0.0019,  ...,  0.0012, -0.0013, -0.0028],
       device='cuda:1')tensor([ 1.4596e-03,  3.0407e-03,  1.2993e-04,  ...,  5.8482e-05,
         1.4044e-03, -9.8367e-04], device='cuda:0')tensor([-0.0065,  0.0011,  0.0036,  ...,  0.0023,  0.0004, -0.0009],
       device='cuda:2')tensor([-0.0044, -0.0022,  0.0019,  ...,  0.0003,  0.0031,  0.0013],
       device='cuda:0')tensor([-0.0016,  0.0001,  0.0001,  ...,  0.0007, -0.0003,  0.0010],
       device='cuda:1')
[rank: 23][epoch: 0][iter: 15] BEFORE:
tensor([-0.0012,  0.0006, -0.0029,  ...,  0.0040,  0.0021, -0.0027],
       device='cuda:3')
[rank: 19][epoch: 0][iter: 15] BEFORE:

[rank: 22][epoch: 0][iter: 15] BEFORE:

[rank: 20][epoch: 0][iter: 15] AFTER HANDLE:

[rank: 23][epoch: 0][iter: 15] AFTER HANDLE:

[rank: 21][epoch: 0][iter: 15] AFTER HANDLE:

[rank: 0][epoch: 0][iter: 15] AFTER HANDLE:

[rank: 16][epoch: 0][iter: 15] AFTER HANDLE:

[rank: 8][epoch: 0][iter: 15] AFTER HANDLE:

[rank: 13][epoch: 0][iter: 15] AFTER HANDLE:

[rank: 4][epoch: 0][iter: 15] AFTER HANDLE:
tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:2')
[rank: 1][epoch: 0][iter: 15] AFTER HANDLE:

[rank: 18][epoch: 0][iter: 15] AFTER HANDLE:

[rank: 11][epoch: 0][iter: 15] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 15] AFTER HANDLE:

[rank: 5][epoch: 0][iter: 15] AFTER HANDLE:
tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:3')
[rank: 2][epoch: 0][iter: 15] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 15] AFTER HANDLE:

[rank: 9][epoch: 0][iter: 15] AFTER HANDLE:

[rank: 12][epoch: 0][iter: 15] AFTER HANDLE:

[rank: 7][epoch: 0][iter: 15] AFTER HANDLE:
tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:1')
[rank: 3][epoch: 0][iter: 15] AFTER HANDLE:
tensor([-0.0032,  0.0047,  0.0004,  ...,  0.0006,  0.0000, -0.0007],
       device='cuda:3')
[rank: 10][epoch: 0][iter: 15] AFTER HANDLE:

[rank: 14][epoch: 0][iter: 15] AFTER HANDLE:

[rank: 6][epoch: 0][iter: 15] AFTER HANDLE:
tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:0')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:0')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:0')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:0')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:1')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:0')
[rank: 22][epoch: 0][iter: 15] AFTER HANDLE:
tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:1')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:2')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:3')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:3')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:1')
[rank: 23][epoch: 0][iter: 15] NEW GRAD:
tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:2')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:1')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:1')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:0')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:3')
[rank: 21][epoch: 0][iter: 15] NEW GRAD:
tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:3')
[rank: 19][epoch: 0][iter: 15] AFTER HANDLE:
tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:2')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:2')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:2')
[rank: 20][epoch: 0][iter: 15] NEW GRAD:

[rank: 0][epoch: 0][iter: 15] NEW GRAD:

[rank: 16][epoch: 0][iter: 15] NEW GRAD:

[rank: 8][epoch: 0][iter: 15] NEW GRAD:

[rank: 13][epoch: 0][iter: 15] NEW GRAD:

[rank: 4][epoch: 0][iter: 15] NEW GRAD:
tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:2')
[rank: 1][epoch: 0][iter: 15] NEW GRAD:

[rank: 18][epoch: 0][iter: 15] NEW GRAD:

[rank: 11][epoch: 0][iter: 15] NEW GRAD:

[rank: 15][epoch: 0][iter: 15] NEW GRAD:

[rank: 5][epoch: 0][iter: 15] NEW GRAD:
tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:3')
[rank: 2][epoch: 0][iter: 15] NEW GRAD:

[rank: 17][epoch: 0][iter: 15] NEW GRAD:

[rank: 9][epoch: 0][iter: 15] NEW GRAD:

[rank: 12][epoch: 0][iter: 15] NEW GRAD:

[rank: 7][epoch: 0][iter: 15] NEW GRAD:
tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:1')
[rank: 3][epoch: 0][iter: 15] NEW GRAD:
tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:3')
[rank: 10][epoch: 0][iter: 15] NEW GRAD:

[rank: 14][epoch: 0][iter: 15] NEW GRAD:

[rank: 6][epoch: 0][iter: 15] NEW GRAD:
tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:0')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:0')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:0')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:0')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:1')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:0')
[rank: 22][epoch: 0][iter: 15] NEW GRAD:
tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:1')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:2')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:3')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:3')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:1')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:2')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:2')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:1')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:1')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:0')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:3')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:3')
[rank: 19][epoch: 0][iter: 15] NEW GRAD:
tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:2')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:2')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:2')tensor([ 1.0726e-03,  4.2213e-04, -4.3643e-05,  ...,  5.8783e-04,
         4.4241e-05, -7.0215e-04], device='cuda:3')
[rank: 23][epoch: 0][iter: 16] BEFORE:

[rank: 21][epoch: 0][iter: 16] BEFORE:
tensor([ 0.0009, -0.0027, -0.0040,  ...,  0.0012, -0.0014, -0.0008],
       device='cuda:3')tensor([ 0.0015,  0.0007, -0.0052,  ..., -0.0003, -0.0006,  0.0001],
       device='cuda:1')
[rank: 0][epoch: 0][iter: 16] BEFORE:

[rank: 20][epoch: 0][iter: 16] BEFORE:
tensor([ 0.0010,  0.0005,  0.0013,  ..., -0.0025, -0.0024, -0.0007],
       device='cuda:0')
[rank: 16][epoch: 0][iter: 16] BEFORE:

[rank: 8][epoch: 0][iter: 16] BEFORE:
tensor([ 0.0022, -0.0010,  0.0026,  ..., -0.0030,  0.0004,  0.0001],
       device='cuda:0')
[rank: 13][epoch: 0][iter: 16] BEFORE:
tensor([-3.2623e-04,  1.7921e-03, -8.1904e-04,  ...,  9.9189e-04,
        -8.3189e-05,  2.3885e-03], device='cuda:0')tensor([-0.0008, -0.0002, -0.0011,  ..., -0.0012, -0.0007, -0.0016],
       device='cuda:0')
[rank: 4][epoch: 0][iter: 16] BEFORE:
tensor([-0.0011,  0.0010,  0.0018,  ..., -0.0056,  0.0045, -0.0035],
       device='cuda:1')
[rank: 11][epoch: 0][iter: 16] BEFORE:

[rank: 18][epoch: 0][iter: 16] BEFORE:

[rank: 15][epoch: 0][iter: 16] BEFORE:
tensor([-0.0013, -0.0002, -0.0007,  ..., -0.0009, -0.0020, -0.0007],
       device='cuda:0')tensor([ 0.0024,  0.0003,  0.0011,  ...,  0.0024, -0.0014, -0.0008],
       device='cuda:3')
[rank: 1][epoch: 0][iter: 16] BEFORE:
tensor([-0.0019,  0.0008,  0.0030,  ...,  0.0037, -0.0003, -0.0028],
       device='cuda:2')tensor([-0.0003,  0.0004,  0.0007,  ...,  0.0025,  0.0009,  0.0004],
       device='cuda:3')
[rank: 5][epoch: 0][iter: 16] BEFORE:

[rank: 22][epoch: 0][iter: 16] BEFORE:

[rank: 2][epoch: 0][iter: 16] BEFORE:

[rank: 17][epoch: 0][iter: 16] BEFORE:

[rank: 7][epoch: 0][iter: 16] BEFORE:
tensor([-4.3759e-05, -2.8687e-05, -5.8060e-05,  ...,  5.9577e-04,
        -9.2297e-04, -4.5105e-04], device='cuda:1')tensor([-0.0012, -0.0015,  0.0030,  ...,  0.0051, -0.0010, -0.0016],
       device='cuda:2')
[rank: 12][epoch: 0][iter: 16] BEFORE:

[rank: 10][epoch: 0][iter: 16] BEFORE:
tensor([-0.0021, -0.0011, -0.0010,  ..., -0.0028, -0.0024,  0.0016],
       device='cuda:1')tensor([-0.0003, -0.0008, -0.0014,  ..., -0.0047, -0.0021,  0.0001],
       device='cuda:1')
[rank: 3][epoch: 0][iter: 16] BEFORE:
tensor([-7.2960e-04, -8.3371e-04,  9.1141e-04,  ...,  9.8083e-05,
        -7.7004e-04, -6.1475e-04], device='cuda:0')tensor([-0.0033,  0.0021, -0.0013,  ..., -0.0003,  0.0001, -0.0012],
       device='cuda:2')tensor([-0.0016,  0.0002,  0.0015,  ...,  0.0003, -0.0023, -0.0029],
       device='cuda:3')tensor([ 1.1386e-03, -9.6052e-04,  2.1212e-03,  ...,  9.8076e-06,
         2.1464e-03, -8.6830e-04], device='cuda:2')
[rank: 9][epoch: 0][iter: 16] BEFORE:

[rank: 6][epoch: 0][iter: 16] BEFORE:

[rank: 19][epoch: 0][iter: 16] BEFORE:
tensor([-0.0019,  0.0006, -0.0004,  ..., -0.0005,  0.0028, -0.0003],
       device='cuda:3')
[rank: 14][epoch: 0][iter: 16] BEFORE:
tensor([-0.0026, -0.0004, -0.0016,  ...,  0.0025, -0.0008,  0.0017],
       device='cuda:1')
[rank: 21][epoch: 0][iter: 16] AFTER HANDLE:

[rank: 5][epoch: 0][iter: 16] AFTER HANDLE:

[rank: 16][epoch: 0][iter: 16] AFTER HANDLE:

[rank: 0][epoch: 0][iter: 16] AFTER HANDLE:

[rank: 12][epoch: 0][iter: 16] AFTER HANDLE:

[rank: 8][epoch: 0][iter: 16] AFTER HANDLE:

[rank: 23][epoch: 0][iter: 16] AFTER HANDLE:

[rank: 7][epoch: 0][iter: 16] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 16] AFTER HANDLE:

[rank: 1][epoch: 0][iter: 16] AFTER HANDLE:

[rank: 13][epoch: 0][iter: 16] AFTER HANDLE:

[rank: 11][epoch: 0][iter: 16] AFTER HANDLE:

[rank: 20][epoch: 0][iter: 16] AFTER HANDLE:

[rank: 4][epoch: 0][iter: 16] AFTER HANDLE:

[rank: 18][epoch: 0][iter: 16] AFTER HANDLE:

[rank: 2][epoch: 0][iter: 16] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 16] AFTER HANDLE:

[rank: 10][epoch: 0][iter: 16] AFTER HANDLE:

[rank: 22][epoch: 0][iter: 16] AFTER HANDLE:
tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:2')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:3')
[rank: 3][epoch: 0][iter: 16] AFTER HANDLE:
tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:2')
[rank: 9][epoch: 0][iter: 16] AFTER HANDLE:
tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:1')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:1')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:0')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:0')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:0')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:0')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:3')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:3')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:1')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:1')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:1')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:3')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:0')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:0')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:2')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:2')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:3')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:2')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:2')
[rank: 6][epoch: 0][iter: 16] AFTER HANDLE:

[rank: 19][epoch: 0][iter: 16] AFTER HANDLE:
tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:3')
[rank: 14][epoch: 0][iter: 16] AFTER HANDLE:
tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:1')
[rank: 21][epoch: 0][iter: 16] NEW GRAD:

[rank: 5][epoch: 0][iter: 16] NEW GRAD:

[rank: 16][epoch: 0][iter: 16] NEW GRAD:

[rank: 0][epoch: 0][iter: 16] NEW GRAD:

[rank: 12][epoch: 0][iter: 16] NEW GRAD:

[rank: 8][epoch: 0][iter: 16] NEW GRAD:

[rank: 23][epoch: 0][iter: 16] NEW GRAD:

[rank: 7][epoch: 0][iter: 16] NEW GRAD:

[rank: 17][epoch: 0][iter: 16] NEW GRAD:

[rank: 1][epoch: 0][iter: 16] NEW GRAD:

[rank: 13][epoch: 0][iter: 16] NEW GRAD:

[rank: 11][epoch: 0][iter: 16] NEW GRAD:

[rank: 20][epoch: 0][iter: 16] NEW GRAD:

[rank: 4][epoch: 0][iter: 16] NEW GRAD:

[rank: 18][epoch: 0][iter: 16] NEW GRAD:

[rank: 2][epoch: 0][iter: 16] NEW GRAD:

[rank: 15][epoch: 0][iter: 16] NEW GRAD:

[rank: 10][epoch: 0][iter: 16] NEW GRAD:

[rank: 22][epoch: 0][iter: 16] NEW GRAD:
tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:2')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:3')
[rank: 3][epoch: 0][iter: 16] NEW GRAD:
tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:2')
[rank: 9][epoch: 0][iter: 16] NEW GRAD:
tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:1')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:1')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:0')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:0')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:0')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:0')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:3')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:3')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:1')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:1')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:1')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:3')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:0')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:0')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:2')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:2')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:3')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:2')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:2')
[rank: 6][epoch: 0][iter: 16] NEW GRAD:

[rank: 19][epoch: 0][iter: 16] NEW GRAD:
tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:3')
[rank: 14][epoch: 0][iter: 16] NEW GRAD:
tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:1')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:2')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:3')tensor([-4.3967e-04, -1.2662e-05, -1.5286e-04,  ..., -2.3461e-04,
        -3.9815e-04, -4.2839e-04], device='cuda:2')
[rank: 5][epoch: 0][iter: 17] BEFORE:

[rank: 16][epoch: 0][iter: 17] BEFORE:
tensor([-0.0006, -0.0017, -0.0010,  ...,  0.0014,  0.0011, -0.0006],
       device='cuda:1')
[rank: 0][epoch: 0][iter: 17] BEFORE:
tensor([-0.0009,  0.0055,  0.0040,  ..., -0.0012, -0.0009,  0.0010],
       device='cuda:0')
[rank: 12][epoch: 0][iter: 17] BEFORE:
tensor([ 0.0013, -0.0005, -0.0047,  ...,  0.0092, -0.0007,  0.0073],
       device='cuda:0')
[rank: 21][epoch: 0][iter: 17] BEFORE:

[rank: 8][epoch: 0][iter: 17] BEFORE:
tensor([-0.0003,  0.0027, -0.0005,  ..., -0.0011, -0.0008, -0.0015],
       device='cuda:0')
[rank: 7][epoch: 0][iter: 17] BEFORE:
tensor([ 7.8903e-05,  3.1382e-03,  3.2117e-03,  ...,  9.4578e-04,
        -4.9961e-04,  1.1173e-03], device='cuda:1')
[rank: 1][epoch: 0][iter: 17] BEFORE:
tensor([-4.8959e-04,  3.8586e-04,  6.3116e-04,  ...,  1.1594e-03,
         5.8489e-05, -1.7743e-03], device='cuda:0')
[rank: 17][epoch: 0][iter: 17] BEFORE:

[rank: 13][epoch: 0][iter: 17] BEFORE:

[rank: 11][epoch: 0][iter: 17] BEFORE:
tensor([-0.0004, -0.0011,  0.0003,  ..., -0.0005,  0.0010,  0.0030],
       device='cuda:1')
[rank: 23][epoch: 0][iter: 17] BEFORE:
tensor([-0.0009, -0.0018, -0.0026,  ..., -0.0005,  0.0005,  0.0024],
       device='cuda:1')
[rank: 4][epoch: 0][iter: 17] BEFORE:

[rank: 15][epoch: 0][iter: 17] BEFORE:
tensor([-0.0022,  0.0003,  0.0003,  ...,  0.0011, -0.0050, -0.0001],
       device='cuda:3')
[rank: 20][epoch: 0][iter: 17] BEFORE:

[rank: 2][epoch: 0][iter: 17] BEFORE:

[rank: 18][epoch: 0][iter: 17] BEFORE:
tensor([-0.0014,  0.0024,  0.0032,  ...,  0.0042,  0.0015, -0.0019],
       device='cuda:1')tensor([ 0.0014, -0.0017, -0.0007,  ...,  0.0012,  0.0003, -0.0005],
       device='cuda:0')
[rank: 10][epoch: 0][iter: 17] BEFORE:
tensor([ 0.0044,  0.0026,  0.0065,  ..., -0.0010, -0.0002, -0.0020],
       device='cuda:3')
[rank: 3][epoch: 0][iter: 17] BEFORE:
tensor([-0.0046, -0.0040,  0.0027,  ..., -0.0021,  0.0021,  0.0007],
       device='cuda:3')tensor([ 1.2821e-03,  3.8809e-03,  1.0319e-03,  ...,  7.1354e-05,
        -3.8364e-03, -1.1634e-03], device='cuda:2')
[rank: 6][epoch: 0][iter: 17] BEFORE:

[rank: 9][epoch: 0][iter: 17] BEFORE:

[rank: 22][epoch: 0][iter: 17] BEFORE:
tensor([-0.0010,  0.0003,  0.0008,  ...,  0.0006, -0.0002, -0.0002],
       device='cuda:2')
[rank: 14][epoch: 0][iter: 17] BEFORE:
tensor([-1.2906e-03, -3.5595e-03,  2.5397e-03,  ..., -1.4354e-03,
         1.1880e-05,  5.5520e-05], device='cuda:2')tensor([-0.0022,  0.0030,  0.0014,  ..., -0.0004, -0.0009,  0.0003],
       device='cuda:2')tensor([-0.0005, -0.0034, -0.0041,  ..., -0.0026, -0.0009, -0.0027],
       device='cuda:0')tensor([-0.0022, -0.0007, -0.0025,  ..., -0.0005, -0.0003, -0.0015],
       device='cuda:3')
[rank: 19][epoch: 0][iter: 17] BEFORE:
tensor([-0.0006,  0.0002, -0.0002,  ..., -0.0007,  0.0003,  0.0004],
       device='cuda:1')tensor([-0.0033, -0.0049, -0.0002,  ..., -0.0006, -0.0013, -0.0004],
       device='cuda:2')
[rank: 5][epoch: 0][iter: 17] AFTER HANDLE:
tensor([ 0.0020,  0.0032, -0.0054,  ...,  0.0010, -0.0006, -0.0019],
       device='cuda:2')
[rank: 0][epoch: 0][iter: 17] AFTER HANDLE:

[rank: 16][epoch: 0][iter: 17] AFTER HANDLE:

[rank: 8][epoch: 0][iter: 17] AFTER HANDLE:

[rank: 12][epoch: 0][iter: 17] AFTER HANDLE:

[rank: 4][epoch: 0][iter: 17] AFTER HANDLE:

[rank: 21][epoch: 0][iter: 17] AFTER HANDLE:

[rank: 1][epoch: 0][iter: 17] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 17] AFTER HANDLE:

[rank: 11][epoch: 0][iter: 17] AFTER HANDLE:

[rank: 13][epoch: 0][iter: 17] AFTER HANDLE:
tensor([0.0013, 0.0007, 0.0025,  ..., 0.0021, 0.0011, 0.0004], device='cuda:3')
[rank: 7][epoch: 0][iter: 17] AFTER HANDLE:

[rank: 23][epoch: 0][iter: 17] AFTER HANDLE:

[rank: 2][epoch: 0][iter: 17] AFTER HANDLE:

[rank: 18][epoch: 0][iter: 17] AFTER HANDLE:

[rank: 10][epoch: 0][iter: 17] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 17] AFTER HANDLE:

[rank: 6][epoch: 0][iter: 17] AFTER HANDLE:

[rank: 20][epoch: 0][iter: 17] AFTER HANDLE:

[rank: 3][epoch: 0][iter: 17] AFTER HANDLE:
tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:3')
[rank: 9][epoch: 0][iter: 17] AFTER HANDLE:

[rank: 14][epoch: 0][iter: 17] AFTER HANDLE:
tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:1')
[rank: 22][epoch: 0][iter: 17] AFTER HANDLE:
tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:0')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:0')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:0')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:0')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:0')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:1')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:1')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:1')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:3')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:1')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:3')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:3')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:2')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:2')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:2')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:3')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:2')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:0')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:3')
[rank: 19][epoch: 0][iter: 17] AFTER HANDLE:
tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:1')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:2')
[rank: 5][epoch: 0][iter: 17] NEW GRAD:
tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:2')
[rank: 0][epoch: 0][iter: 17] NEW GRAD:

[rank: 16][epoch: 0][iter: 17] NEW GRAD:

[rank: 8][epoch: 0][iter: 17] NEW GRAD:

[rank: 12][epoch: 0][iter: 17] NEW GRAD:

[rank: 4][epoch: 0][iter: 17] NEW GRAD:

[rank: 21][epoch: 0][iter: 17] NEW GRAD:

[rank: 1][epoch: 0][iter: 17] NEW GRAD:

[rank: 17][epoch: 0][iter: 17] NEW GRAD:

[rank: 11][epoch: 0][iter: 17] NEW GRAD:

[rank: 13][epoch: 0][iter: 17] NEW GRAD:

[rank: 7][epoch: 0][iter: 17] NEW GRAD:

[rank: 23][epoch: 0][iter: 17] NEW GRAD:

[rank: 2][epoch: 0][iter: 17] NEW GRAD:

[rank: 18][epoch: 0][iter: 17] NEW GRAD:

[rank: 10][epoch: 0][iter: 17] NEW GRAD:

[rank: 15][epoch: 0][iter: 17] NEW GRAD:

[rank: 6][epoch: 0][iter: 17] NEW GRAD:

[rank: 20][epoch: 0][iter: 17] NEW GRAD:

[rank: 3][epoch: 0][iter: 17] NEW GRAD:
tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:3')
[rank: 9][epoch: 0][iter: 17] NEW GRAD:

[rank: 14][epoch: 0][iter: 17] NEW GRAD:
tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:1')
[rank: 22][epoch: 0][iter: 17] NEW GRAD:
tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:0')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:0')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:0')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:0')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:0')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:1')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:1')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:1')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:3')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:1')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:3')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:3')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:2')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:2')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:2')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:3')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:2')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:0')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:3')
[rank: 19][epoch: 0][iter: 17] NEW GRAD:
tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:1')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:2')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:2')tensor([-5.6319e-04,  2.1708e-04,  2.0356e-04,  ...,  8.5608e-05,
        -2.8918e-04,  1.1157e-04], device='cuda:3')
[rank: 5][epoch: 0][iter: 18] BEFORE:
tensor([ 0.0003,  0.0009,  0.0012,  ..., -0.0011,  0.0003, -0.0006],
       device='cuda:1')
[rank: 0][epoch: 0][iter: 18] BEFORE:

[rank: 16][epoch: 0][iter: 18] BEFORE:
tensor([ 0.0033, -0.0034, -0.0018,  ...,  0.0008,  0.0019,  0.0009],
       device='cuda:0')
[rank: 8][epoch: 0][iter: 18] BEFORE:
tensor([-0.0021,  0.0016, -0.0008,  ..., -0.0010, -0.0010, -0.0033],
       device='cuda:0')
[rank: 4][epoch: 0][iter: 18] BEFORE:
tensor([-0.0013, -0.0004,  0.0002,  ..., -0.0011,  0.0014,  0.0017],
       device='cuda:0')
[rank: 12][epoch: 0][iter: 18] BEFORE:
tensor([-1.6068e-03,  1.7895e-04,  7.1788e-05,  ...,  2.6243e-03,
         7.8516e-04, -6.1850e-05], device='cuda:0')
[rank: 17][epoch: 0][iter: 18] BEFORE:

[rank: 11][epoch: 0][iter: 18] BEFORE:

[rank: 13][epoch: 0][iter: 18] BEFORE:

[rank: 7][epoch: 0][iter: 18] BEFORE:
tensor([ 0.0007, -0.0004,  0.0002,  ...,  0.0005, -0.0026, -0.0001],
       device='cuda:1')
[rank: 21][epoch: 0][iter: 18] BEFORE:
tensor([ 0.0018,  0.0002, -0.0007,  ...,  0.0011,  0.0006,  0.0016],
       device='cuda:3')tensor([ 0.0023,  0.0013, -0.0005,  ...,  0.0012,  0.0027,  0.0049],
       device='cuda:0')
[rank: 1][epoch: 0][iter: 18] BEFORE:
tensor([ 0.0023, -0.0040, -0.0002,  ...,  0.0012,  0.0019,  0.0014],
       device='cuda:3')tensor([-0.0003, -0.0001,  0.0013,  ..., -0.0001,  0.0003,  0.0019],
       device='cuda:1')
[rank: 10][epoch: 0][iter: 18] BEFORE:
tensor([-0.0022, -0.0001, -0.0010,  ..., -0.0004,  0.0007, -0.0010],
       device='cuda:1')
[rank: 18][epoch: 0][iter: 18] BEFORE:

[rank: 2][epoch: 0][iter: 18] BEFORE:

[rank: 6][epoch: 0][iter: 18] BEFORE:

[rank: 23][epoch: 0][iter: 18] BEFORE:
tensor([-0.0077, -0.0006, -0.0083,  ..., -0.0010,  0.0004, -0.0004],
       device='cuda:2')
[rank: 15][epoch: 0][iter: 18] BEFORE:
tensor([-0.0019,  0.0030, -0.0018,  ..., -0.0019,  0.0017, -0.0006],
       device='cuda:1')tensor([-0.0011,  0.0034, -0.0025,  ...,  0.0012,  0.0035, -0.0009],
       device='cuda:2')tensor([ 2.0143e-03,  1.6453e-04, -2.6550e-04,  ...,  1.3884e-03,
         3.6153e-04,  3.8091e-05], device='cuda:2')
[rank: 20][epoch: 0][iter: 18] BEFORE:

[rank: 14][epoch: 0][iter: 18] BEFORE:

[rank: 3][epoch: 0][iter: 18] BEFORE:
tensor([-4.6141e-04,  1.0694e-03,  6.2203e-04,  ..., -1.1135e-03,
        -1.2583e-03, -4.9401e-05], device='cuda:3')
[rank: 19][epoch: 0][iter: 18] BEFORE:
tensor([-0.0029,  0.0037,  0.0030,  ..., -0.0030, -0.0001, -0.0038],
       device='cuda:3')tensor([-0.0007,  0.0007,  0.0001,  ...,  0.0003, -0.0023, -0.0019],
       device='cuda:2')tensor([ 2.8767e-05,  4.1036e-04,  2.4378e-03,  ...,  3.5936e-03,
         2.8788e-03, -1.3009e-03], device='cuda:0')
[rank: 9][epoch: 0][iter: 18] BEFORE:
tensor([-0.0005,  0.0011, -0.0008,  ..., -0.0011, -0.0002,  0.0008],
       device='cuda:2')
[rank: 16][epoch: 0][iter: 18] AFTER HANDLE:

[rank: 5][epoch: 0][iter: 18] AFTER HANDLE:
tensor([-0.0013,  0.0010, -0.0043,  ...,  0.0007, -0.0073,  0.0024],
       device='cuda:3')
[rank: 22][epoch: 0][iter: 18] BEFORE:

[rank: 8][epoch: 0][iter: 18] AFTER HANDLE:

[rank: 13][epoch: 0][iter: 18] AFTER HANDLE:

[rank: 18][epoch: 0][iter: 18] AFTER HANDLE:

[rank: 7][epoch: 0][iter: 18] AFTER HANDLE:

[rank: 0][epoch: 0][iter: 18] AFTER HANDLE:

[rank: 21][epoch: 0][iter: 18] AFTER HANDLE:

[rank: 11][epoch: 0][iter: 18] AFTER HANDLE:

[rank: 12][epoch: 0][iter: 18] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 18] AFTER HANDLE:

[rank: 6][epoch: 0][iter: 18] AFTER HANDLE:

[rank: 1][epoch: 0][iter: 18] AFTER HANDLE:

[rank: 23][epoch: 0][iter: 18] AFTER HANDLE:

[rank: 10][epoch: 0][iter: 18] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 18] AFTER HANDLE:
tensor([-0.0004,  0.0004, -0.0004,  ...,  0.0002,  0.0001,  0.0003],
       device='cuda:3')
[rank: 4][epoch: 0][iter: 18] AFTER HANDLE:

[rank: 2][epoch: 0][iter: 18] AFTER HANDLE:

[rank: 20][epoch: 0][iter: 18] AFTER HANDLE:
tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:1')
[rank: 14][epoch: 0][iter: 18] AFTER HANDLE:
tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:0')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:1')
[rank: 3][epoch: 0][iter: 18] AFTER HANDLE:
tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:2')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:0')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:1')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:2')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:3')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:0')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:1')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:3')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:0')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:1')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:2')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:1')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:3')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:2')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:3')
[rank: 19][epoch: 0][iter: 18] AFTER HANDLE:
tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:0')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:2')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:0')
[rank: 9][epoch: 0][iter: 18] AFTER HANDLE:
tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:2')
[rank: 16][epoch: 0][iter: 18] NEW GRAD:

[rank: 5][epoch: 0][iter: 18] NEW GRAD:
tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:3')
[rank: 22][epoch: 0][iter: 18] AFTER HANDLE:

[rank: 8][epoch: 0][iter: 18] NEW GRAD:

[rank: 13][epoch: 0][iter: 18] NEW GRAD:

[rank: 18][epoch: 0][iter: 18] NEW GRAD:

[rank: 7][epoch: 0][iter: 18] NEW GRAD:

[rank: 0][epoch: 0][iter: 18] NEW GRAD:

[rank: 21][epoch: 0][iter: 18] NEW GRAD:

[rank: 11][epoch: 0][iter: 18] NEW GRAD:

[rank: 12][epoch: 0][iter: 18] NEW GRAD:

[rank: 17][epoch: 0][iter: 18] NEW GRAD:

[rank: 6][epoch: 0][iter: 18] NEW GRAD:

[rank: 1][epoch: 0][iter: 18] NEW GRAD:

[rank: 23][epoch: 0][iter: 18] NEW GRAD:

[rank: 10][epoch: 0][iter: 18] NEW GRAD:

[rank: 15][epoch: 0][iter: 18] NEW GRAD:
tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:3')
[rank: 4][epoch: 0][iter: 18] NEW GRAD:

[rank: 2][epoch: 0][iter: 18] NEW GRAD:

[rank: 20][epoch: 0][iter: 18] NEW GRAD:
tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:1')
[rank: 14][epoch: 0][iter: 18] NEW GRAD:
tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:0')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:1')
[rank: 3][epoch: 0][iter: 18] NEW GRAD:
tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:2')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:0')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:1')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:2')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:3')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:0')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:1')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:3')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:0')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:1')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:2')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:1')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:3')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:2')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:3')
[rank: 19][epoch: 0][iter: 18] NEW GRAD:
tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:0')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:2')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:0')
[rank: 9][epoch: 0][iter: 18] NEW GRAD:
tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:2')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:3')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:3')
[rank: 22][epoch: 0][iter: 18] NEW GRAD:
tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:1')tensor([-4.3198e-04,  3.9749e-04, -3.9331e-04,  ...,  1.9694e-04,
         9.3079e-05,  2.7913e-04], device='cuda:2')
[rank: 16][epoch: 0][iter: 19] BEFORE:

[rank: 5][epoch: 0][iter: 19] BEFORE:
tensor([-0.0013, -0.0010,  0.0005,  ..., -0.0084, -0.0063, -0.0008],
       device='cuda:0')
[rank: 8][epoch: 0][iter: 19] BEFORE:

[rank: 13][epoch: 0][iter: 19] BEFORE:

[rank: 18][epoch: 0][iter: 19] BEFORE:
tensor([-1.0063e-03, -7.2684e-04,  9.3500e-05,  ...,  5.0284e-04,
         1.9061e-03, -1.0530e-03], device='cuda:0')
[rank: 7][epoch: 0][iter: 19] BEFORE:
tensor([-1.8281e-03, -9.2025e-04, -3.9150e-07,  ...,  1.9963e-03,
         1.3437e-03,  8.5853e-04], device='cuda:1')tensor([-8.8377e-05,  2.4514e-04,  9.6365e-04,  ...,  4.4464e-03,
        -4.7593e-04, -5.1461e-03], device='cuda:2')
[rank: 0][epoch: 0][iter: 19] BEFORE:

[rank: 11][epoch: 0][iter: 19] BEFORE:
tensor([-0.0030, -0.0003, -0.0009,  ..., -0.0022, -0.0025,  0.0003],
       device='cuda:3')
[rank: 17][epoch: 0][iter: 19] BEFORE:
tensor([-0.0010, -0.0034, -0.0030,  ...,  0.0028,  0.0021,  0.0033],
       device='cuda:0')
[rank: 12][epoch: 0][iter: 19] BEFORE:
tensor([ 0.0003, -0.0019, -0.0036,  ...,  0.0005,  0.0059,  0.0050],
       device='cuda:3')
[rank: 21][epoch: 0][iter: 19] BEFORE:

[rank: 1][epoch: 0][iter: 19] BEFORE:
tensor([ 0.0004,  0.0004, -0.0002,  ..., -0.0079, -0.0069,  0.0006],
       device='cuda:1')
[rank: 6][epoch: 0][iter: 19] BEFORE:

[rank: 15][epoch: 0][iter: 19] BEFORE:

[rank: 10][epoch: 0][iter: 19] BEFORE:
tensor([ 0.0015, -0.0008, -0.0014,  ..., -0.0003,  0.0149,  0.0135],
       device='cuda:1')tensor([-0.0009,  0.0012,  0.0018,  ..., -0.0015, -0.0058, -0.0006],
       device='cuda:1')
[rank: 4][epoch: 0][iter: 19] BEFORE:
tensor([-3.9320e-05,  3.9317e-05,  1.6295e-03,  ...,  2.6813e-03,
         4.0238e-03,  5.7556e-03], device='cuda:0')tensor([ 0.0017, -0.0009, -0.0031,  ...,  0.0023,  0.0007, -0.0006],
       device='cuda:2')
[rank: 20][epoch: 0][iter: 19] BEFORE:

[rank: 2][epoch: 0][iter: 19] BEFORE:
tensor([ 0.0018, -0.0032,  0.0021,  ..., -0.0003,  0.0031,  0.0018],
       device='cuda:2')tensor([ 0.0001, -0.0002,  0.0014,  ...,  0.0017,  0.0040,  0.0017],
       device='cuda:3')
[rank: 23][epoch: 0][iter: 19] BEFORE:

[rank: 3][epoch: 0][iter: 19] BEFORE:

[rank: 9][epoch: 0][iter: 19] BEFORE:
tensor([-0.0051, -0.0027, -0.0016,  ..., -0.0055, -0.0126, -0.0065],
       device='cuda:0')
[rank: 14][epoch: 0][iter: 19] BEFORE:

[rank: 22][epoch: 0][iter: 19] BEFORE:

[rank: 16][epoch: 0][iter: 19] AFTER HANDLE:

[rank: 0][epoch: 0][iter: 19] AFTER HANDLE:

[rank: 8][epoch: 0][iter: 19] AFTER HANDLE:
tensor([0.0016, 0.0005, 0.0006,  ..., 0.0013, 0.0027, 0.0012], device='cuda:1')
[rank: 5][epoch: 0][iter: 19] AFTER HANDLE:

[rank: 12][epoch: 0][iter: 19] AFTER HANDLE:
tensor([-0.0012, -0.0033,  0.0060,  ...,  0.0147,  0.0077,  0.0058],
       device='cuda:0')
[rank: 18][epoch: 0][iter: 19] AFTER HANDLE:

[rank: 1][epoch: 0][iter: 19] AFTER HANDLE:

[rank: 10][epoch: 0][iter: 19] AFTER HANDLE:

[rank: 7][epoch: 0][iter: 19] AFTER HANDLE:

[rank: 13][epoch: 0][iter: 19] AFTER HANDLE:

[rank: 21][epoch: 0][iter: 19] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 19] AFTER HANDLE:
tensor([0.0006, 0.0007, 0.0005,  ..., 0.0088, 0.0102, 0.0083], device='cuda:2')
[rank: 2][epoch: 0][iter: 19] AFTER HANDLE:

[rank: 11][epoch: 0][iter: 19] AFTER HANDLE:

[rank: 6][epoch: 0][iter: 19] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 19] AFTER HANDLE:
tensor([-0.0004, -0.0007, -0.0000,  ...,  0.0011,  0.0014,  0.0014],
       device='cuda:3')
[rank: 19][epoch: 0][iter: 19] BEFORE:
tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:3')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:1')
[rank: 4][epoch: 0][iter: 19] AFTER HANDLE:
tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:2')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:2')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:0')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:0')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:0')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:1')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:0')
[rank: 20][epoch: 0][iter: 19] AFTER HANDLE:
tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:2')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:1')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:2')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:3')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:1')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:1')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:1')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:2')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:3')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:2')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:3')
[rank: 23][epoch: 0][iter: 19] AFTER HANDLE:
tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:3')
[rank: 3][epoch: 0][iter: 19] AFTER HANDLE:

[rank: 9][epoch: 0][iter: 19] AFTER HANDLE:
tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:0')
[rank: 14][epoch: 0][iter: 19] AFTER HANDLE:

[rank: 22][epoch: 0][iter: 19] AFTER HANDLE:

[rank: 16][epoch: 0][iter: 19] NEW GRAD:

[rank: 0][epoch: 0][iter: 19] NEW GRAD:

[rank: 8][epoch: 0][iter: 19] NEW GRAD:

[rank: 5][epoch: 0][iter: 19] NEW GRAD:

[rank: 12][epoch: 0][iter: 19] NEW GRAD:
tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:0')
[rank: 18][epoch: 0][iter: 19] NEW GRAD:

[rank: 1][epoch: 0][iter: 19] NEW GRAD:

[rank: 10][epoch: 0][iter: 19] NEW GRAD:

[rank: 7][epoch: 0][iter: 19] NEW GRAD:

[rank: 13][epoch: 0][iter: 19] NEW GRAD:

[rank: 21][epoch: 0][iter: 19] NEW GRAD:

[rank: 17][epoch: 0][iter: 19] NEW GRAD:

[rank: 2][epoch: 0][iter: 19] NEW GRAD:

[rank: 11][epoch: 0][iter: 19] NEW GRAD:

[rank: 6][epoch: 0][iter: 19] NEW GRAD:

[rank: 15][epoch: 0][iter: 19] NEW GRAD:
tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:3')
[rank: 19][epoch: 0][iter: 19] AFTER HANDLE:
tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:3')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:1')
[rank: 4][epoch: 0][iter: 19] NEW GRAD:
tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:2')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:2')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:0')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:0')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:0')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:1')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:0')
[rank: 20][epoch: 0][iter: 19] NEW GRAD:
tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:2')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:1')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:2')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:3')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:1')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:1')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:1')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:2')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:3')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:2')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:3')
[rank: 23][epoch: 0][iter: 19] NEW GRAD:
tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:3')
[rank: 3][epoch: 0][iter: 19] NEW GRAD:

[rank: 9][epoch: 0][iter: 19] NEW GRAD:
tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:0')
[rank: 14][epoch: 0][iter: 19] NEW GRAD:

[rank: 22][epoch: 0][iter: 19] NEW GRAD:

[rank: 19][epoch: 0][iter: 19] NEW GRAD:
tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:3')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:1')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:0')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:2')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:3')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:3')tensor([-4.0309e-04, -6.8538e-04, -8.3680e-06,  ...,  1.1063e-03,
         1.4327e-03,  1.3997e-03], device='cuda:2')
[rank: 16][epoch: 0][iter: 20] BEFORE:

[rank: 0][epoch: 0][iter: 20] BEFORE:
tensor([ 3.6460e-04, -5.4693e-05, -5.9691e-04,  ...,  1.8396e-03,
        -1.8134e-04,  3.7152e-04], device='cuda:0')
[rank: 8][epoch: 0][iter: 20] BEFORE:

[rank: 5][epoch: 0][iter: 20] BEFORE:
tensor([ 0.0023, -0.0005,  0.0045,  ...,  0.0004, -0.0012,  0.0012],
       device='cuda:0')
[rank: 12][epoch: 0][iter: 20] BEFORE:
tensor([ 0.0018, -0.0003,  0.0031,  ...,  0.0015, -0.0034, -0.0003],
       device='cuda:0')tensor([ 0.0009, -0.0008,  0.0025,  ...,  0.0023, -0.0044,  0.0006],
       device='cuda:1')tensor([ 4.6723e-03,  1.8429e-03, -4.0459e-03,  ...,  1.0663e-03,
        -1.5843e-03,  6.8219e-05], device='cuda:0')
[rank: 10][epoch: 0][iter: 20] BEFORE:

[rank: 7][epoch: 0][iter: 20] BEFORE:

[rank: 13][epoch: 0][iter: 20] BEFORE:

[rank: 18][epoch: 0][iter: 20] BEFORE:
tensor([ 0.0013,  0.0007,  0.0082,  ...,  0.0006, -0.0023,  0.0021],
       device='cuda:2')
[rank: 1][epoch: 0][iter: 20] BEFORE:
tensor([-2.6638e-03, -4.5142e-05, -2.5998e-03,  ..., -3.6708e-04,
        -1.6636e-03,  3.4287e-03], device='cuda:3')
[rank: 17][epoch: 0][iter: 20] BEFORE:
tensor([-0.0169,  0.0033, -0.0218,  ...,  0.0015,  0.0003, -0.0029],
       device='cuda:1')
[rank: 11][epoch: 0][iter: 20] BEFORE:

[rank: 2][epoch: 0][iter: 20] BEFORE:

[rank: 21][epoch: 0][iter: 20] BEFORE:

[rank: 15][epoch: 0][iter: 20] BEFORE:
tensor([-2.0149e-05, -2.0662e-03,  2.1396e-03,  ...,  6.2138e-03,
         9.2004e-04, -1.4564e-02], device='cuda:1')
[rank: 6][epoch: 0][iter: 20] BEFORE:
tensor([-1.5314e-03,  1.0514e-03, -1.8856e-03,  ..., -8.6127e-04,
        -3.4161e-05, -4.6757e-03], device='cuda:1')tensor([ 0.0020, -0.0008,  0.0013,  ..., -0.0015,  0.0005, -0.0001],
       device='cuda:3')tensor([ 0.0022,  0.0025,  0.0023,  ...,  0.0011, -0.0025, -0.0071],
       device='cuda:1')tensor([ 0.0038, -0.0010,  0.0033,  ...,  0.0006, -0.0047,  0.0006],
       device='cuda:3')
[rank: 4][epoch: 0][iter: 20] BEFORE:
tensor([-0.0039, -0.0004, -0.0075,  ...,  0.0107,  0.0010,  0.0040],
       device='cuda:2')
[rank: 14][epoch: 0][iter: 20] BEFORE:
tensor([ 0.0035, -0.0026,  0.0099,  ..., -0.0015, -0.0049,  0.0036],
       device='cuda:2')
[rank: 20][epoch: 0][iter: 20] BEFORE:

[rank: 3][epoch: 0][iter: 20] BEFORE:
tensor([-0.0047,  0.0006, -0.0023,  ..., -0.0013, -0.0002, -0.0025],
       device='cuda:0')tensor([-4.1096e-04, -1.1808e-03, -3.2454e-04,  ...,  3.8090e-04,
         4.1234e-04, -4.4511e-05], device='cuda:2')
[rank: 23][epoch: 0][iter: 20] BEFORE:
tensor([-0.0031,  0.0025, -0.0044,  ...,  0.0019, -0.0025,  0.0026],
       device='cuda:3')tensor([ 6.3628e-03,  9.6285e-05,  6.9795e-03,  ..., -3.9038e-03,
         4.6423e-03,  1.1721e-02], device='cuda:0')
[rank: 19][epoch: 0][iter: 20] BEFORE:
tensor([ 0.0016, -0.0019,  0.0019,  ...,  0.0036,  0.0002,  0.0015],
       device='cuda:3')
[rank: 22][epoch: 0][iter: 20] BEFORE:

[rank: 9][epoch: 0][iter: 20] BEFORE:
tensor([-0.0073, -0.0011, -0.0052,  ..., -0.0017,  0.0033,  0.0049],
       device='cuda:3')tensor([ 0.0009, -0.0015,  0.0029,  ...,  0.0012, -0.0007,  0.0046],
       device='cuda:2')
[rank: 0][epoch: 0][iter: 20] AFTER HANDLE:

[rank: 5][epoch: 0][iter: 20] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 20] AFTER HANDLE:

[rank: 10][epoch: 0][iter: 20] AFTER HANDLE:

[rank: 16][epoch: 0][iter: 20] AFTER HANDLE:

[rank: 21][epoch: 0][iter: 20] AFTER HANDLE:

[rank: 2][epoch: 0][iter: 20] AFTER HANDLE:

[rank: 4][epoch: 0][iter: 20] AFTER HANDLE:

[rank: 13][epoch: 0][iter: 20] AFTER HANDLE:

[rank: 11][epoch: 0][iter: 20] AFTER HANDLE:
tensor([0.0095, 0.0008, 0.0098,  ..., 0.0005, 0.0010, 0.0059], device='cuda:2')
[rank: 18][epoch: 0][iter: 20] AFTER HANDLE:

[rank: 23][epoch: 0][iter: 20] AFTER HANDLE:

[rank: 3][epoch: 0][iter: 20] AFTER HANDLE:

[rank: 6][epoch: 0][iter: 20] AFTER HANDLE:

[rank: 14][epoch: 0][iter: 20] AFTER HANDLE:

[rank: 8][epoch: 0][iter: 20] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 20] AFTER HANDLE:

[rank: 20][epoch: 0][iter: 20] AFTER HANDLE:

[rank: 1][epoch: 0][iter: 20] AFTER HANDLE:

[rank: 7][epoch: 0][iter: 20] AFTER HANDLE:

[rank: 12][epoch: 0][iter: 20] AFTER HANDLE:
tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:1')
[rank: 19][epoch: 0][iter: 20] AFTER HANDLE:

[rank: 22][epoch: 0][iter: 20] AFTER HANDLE:
tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:0')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:1')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:3')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:2')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:0')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:1')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:2')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:0')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:1')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:3')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:2')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:3')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:3')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:2')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:2')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:0')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:1')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:0')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:1')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:3')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:0')
[rank: 9][epoch: 0][iter: 20] AFTER HANDLE:
tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:3')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:2')
[rank: 0][epoch: 0][iter: 20] NEW GRAD:

[rank: 5][epoch: 0][iter: 20] NEW GRAD:

[rank: 15][epoch: 0][iter: 20] NEW GRAD:

[rank: 10][epoch: 0][iter: 20] NEW GRAD:

[rank: 16][epoch: 0][iter: 20] NEW GRAD:

[rank: 21][epoch: 0][iter: 20] NEW GRAD:

[rank: 2][epoch: 0][iter: 20] NEW GRAD:

[rank: 4][epoch: 0][iter: 20] NEW GRAD:

[rank: 13][epoch: 0][iter: 20] NEW GRAD:

[rank: 11][epoch: 0][iter: 20] NEW GRAD:

[rank: 18][epoch: 0][iter: 20] NEW GRAD:

[rank: 23][epoch: 0][iter: 20] NEW GRAD:

[rank: 3][epoch: 0][iter: 20] NEW GRAD:

[rank: 6][epoch: 0][iter: 20] NEW GRAD:

[rank: 14][epoch: 0][iter: 20] NEW GRAD:

[rank: 8][epoch: 0][iter: 20] NEW GRAD:

[rank: 17][epoch: 0][iter: 20] NEW GRAD:

[rank: 20][epoch: 0][iter: 20] NEW GRAD:

[rank: 1][epoch: 0][iter: 20] NEW GRAD:

[rank: 7][epoch: 0][iter: 20] NEW GRAD:

[rank: 12][epoch: 0][iter: 20] NEW GRAD:
tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:1')
[rank: 19][epoch: 0][iter: 20] NEW GRAD:

[rank: 22][epoch: 0][iter: 20] NEW GRAD:
tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:0')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:1')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:3')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:2')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:0')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:1')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:2')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:0')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:1')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:3')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:2')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:3')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:3')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:2')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:2')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:0')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:1')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:0')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:1')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:3')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:0')
[rank: 9][epoch: 0][iter: 20] NEW GRAD:
tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:3')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:2')tensor([-0.0001, -0.0005,  0.0001,  ...,  0.0010, -0.0009,  0.0005],
       device='cuda:1')
[rank: 5][epoch: 0][iter: 21] BEFORE:

[rank: 15][epoch: 0][iter: 21] BEFORE:

[rank: 0][epoch: 0][iter: 21] BEFORE:
tensor([-6.7888e-04,  1.5182e-02, -1.3201e-03,  ...,  3.8701e-03,
        -2.2456e-05, -9.5687e-04], device='cuda:1')tensor([ 9.9757e-04, -4.5185e-03,  1.9020e-03,  ..., -8.4847e-06,
        -7.5569e-04, -3.9364e-04], device='cuda:3')
[rank: 16][epoch: 0][iter: 21] BEFORE:
tensor([-0.0005,  0.0037,  0.0009,  ..., -0.0034, -0.0024,  0.0001],
       device='cuda:0')
[rank: 21][epoch: 0][iter: 21] BEFORE:
tensor([-1.3413e-05,  1.3190e-04, -1.3402e-03,  ..., -7.6497e-04,
        -8.9205e-04,  9.7410e-04], device='cuda:0')
[rank: 4][epoch: 0][iter: 21] BEFORE:

[rank: 13][epoch: 0][iter: 21] BEFORE:
tensor([-7.0120e-05,  3.2536e-03,  1.2774e-04,  ...,  5.9530e-04,
        -5.4147e-03, -7.8113e-04], device='cuda:1')
[rank: 11][epoch: 0][iter: 21] BEFORE:

[rank: 2][epoch: 0][iter: 21] BEFORE:
tensor([-4.7727e-05,  3.9099e-04,  7.6665e-04,  ...,  2.8094e-03,
        -3.1369e-04, -9.6423e-04], device='cuda:0')tensor([-0.0006,  0.0058, -0.0002,  ...,  0.0001,  0.0007,  0.0008],
       device='cuda:1')
[rank: 18][epoch: 0][iter: 21] BEFORE:
tensor([-0.0005,  0.0026, -0.0007,  ...,  0.0066,  0.0014, -0.0013],
       device='cuda:3')
[rank: 3][epoch: 0][iter: 21] BEFORE:

[rank: 6][epoch: 0][iter: 21] BEFORE:

[rank: 23][epoch: 0][iter: 21] BEFORE:

[rank: 14][epoch: 0][iter: 21] BEFORE:
tensor([ 0.0004, -0.0014,  0.0024,  ...,  0.0004,  0.0007,  0.0002],
       device='cuda:2')
[rank: 8][epoch: 0][iter: 21] BEFORE:
tensor([ 2.9773e-03, -2.2306e-02,  7.3723e-03,  ...,  3.4649e-03,
        -2.0509e-04, -2.3109e-05], device='cuda:2')tensor([-0.0004,  0.0009,  0.0007,  ...,  0.0033, -0.0012, -0.0007],
       device='cuda:2')tensor([-0.0004, -0.0003, -0.0028,  ...,  0.0067,  0.0034, -0.0017],
       device='cuda:3')
[rank: 17][epoch: 0][iter: 21] BEFORE:
tensor([ 1.5350e-04, -8.5028e-04, -6.2076e-05,  ..., -1.5626e-03,
        -1.4600e-03,  7.1719e-04], device='cuda:2')
[rank: 10][epoch: 0][iter: 21] BEFORE:
tensor([ 0.0010, -0.0020,  0.0026,  ..., -0.0020, -0.0011, -0.0007],
       device='cuda:3')
[rank: 7][epoch: 0][iter: 21] BEFORE:

[rank: 20][epoch: 0][iter: 21] BEFORE:
tensor([-0.0017,  0.0197, -0.0040,  ...,  0.0031,  0.0035,  0.0007],
       device='cuda:1')
[rank: 12][epoch: 0][iter: 21] BEFORE:
tensor([ 6.2641e-05,  2.5270e-03, -3.2759e-04,  ...,  3.2138e-03,
         1.3618e-03,  8.3145e-04], device='cuda:0')
[rank: 1][epoch: 0][iter: 21] BEFORE:
tensor([ 4.2615e-04,  9.9682e-05, -1.5431e-03,  ...,  2.9719e-03,
         1.9942e-03,  4.9385e-04], device='cuda:3')
[rank: 22][epoch: 0][iter: 21] BEFORE:

[rank: 9][epoch: 0][iter: 21] BEFORE:
tensor([-0.0038,  0.0100,  0.0022,  ...,  0.0009,  0.0014,  0.0007],
       device='cuda:0')
[rank: 19][epoch: 0][iter: 21] BEFORE:
tensor([-4.7438e-05,  4.3030e-03,  8.2260e-04,  ...,  4.8276e-03,
        -1.7040e-03,  1.8386e-03], device='cuda:1')
[rank: 5][epoch: 0][iter: 21] AFTER HANDLE:
tensor([ 0.0007,  0.0065, -0.0004,  ...,  0.0066,  0.0006, -0.0009],
       device='cuda:0')tensor([-2.7024e-03,  1.1080e-03,  3.6157e-04,  ...,  4.9157e-05,
         1.8307e-03, -4.9021e-04], device='cuda:2')
[rank: 13][epoch: 0][iter: 21] AFTER HANDLE:

[rank: 18][epoch: 0][iter: 21] AFTER HANDLE:

[rank: 2][epoch: 0][iter: 21] AFTER HANDLE:

[rank: 7][epoch: 0][iter: 21] AFTER HANDLE:

[rank: 21][epoch: 0][iter: 21] AFTER HANDLE:

[rank: 11][epoch: 0][iter: 21] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 21] AFTER HANDLE:

[rank: 16][epoch: 0][iter: 21] AFTER HANDLE:

[rank: 3][epoch: 0][iter: 21] AFTER HANDLE:

[rank: 4][epoch: 0][iter: 21] AFTER HANDLE:

[rank: 23][epoch: 0][iter: 21] AFTER HANDLE:

[rank: 8][epoch: 0][iter: 21] AFTER HANDLE:

[rank: 14][epoch: 0][iter: 21] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 21] AFTER HANDLE:

[rank: 0][epoch: 0][iter: 21] AFTER HANDLE:

[rank: 6][epoch: 0][iter: 21] AFTER HANDLE:
tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:2')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:1')
[rank: 12][epoch: 0][iter: 21] AFTER HANDLE:
tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:3')
[rank: 1][epoch: 0][iter: 21] AFTER HANDLE:
tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:1')
[rank: 20][epoch: 0][iter: 21] AFTER HANDLE:

[rank: 10][epoch: 0][iter: 21] AFTER HANDLE:
tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:1')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:2')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:2')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:3')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:1')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:3')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:3')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:0')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:3')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:0')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:3')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:0')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:2')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:1')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:0')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:2')
[rank: 22][epoch: 0][iter: 21] AFTER HANDLE:

[rank: 9][epoch: 0][iter: 21] AFTER HANDLE:
tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:0')
[rank: 19][epoch: 0][iter: 21] AFTER HANDLE:
tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:1')
[rank: 5][epoch: 0][iter: 21] NEW GRAD:
tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:0')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:2')
[rank: 13][epoch: 0][iter: 21] NEW GRAD:

[rank: 18][epoch: 0][iter: 21] NEW GRAD:

[rank: 2][epoch: 0][iter: 21] NEW GRAD:

[rank: 7][epoch: 0][iter: 21] NEW GRAD:

[rank: 21][epoch: 0][iter: 21] NEW GRAD:

[rank: 11][epoch: 0][iter: 21] NEW GRAD:

[rank: 15][epoch: 0][iter: 21] NEW GRAD:

[rank: 16][epoch: 0][iter: 21] NEW GRAD:

[rank: 3][epoch: 0][iter: 21] NEW GRAD:

[rank: 4][epoch: 0][iter: 21] NEW GRAD:

[rank: 23][epoch: 0][iter: 21] NEW GRAD:

[rank: 8][epoch: 0][iter: 21] NEW GRAD:

[rank: 14][epoch: 0][iter: 21] NEW GRAD:

[rank: 17][epoch: 0][iter: 21] NEW GRAD:

[rank: 0][epoch: 0][iter: 21] NEW GRAD:

[rank: 6][epoch: 0][iter: 21] NEW GRAD:
tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:2')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:1')
[rank: 12][epoch: 0][iter: 21] NEW GRAD:
tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:3')
[rank: 1][epoch: 0][iter: 21] NEW GRAD:
tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:1')
[rank: 20][epoch: 0][iter: 21] NEW GRAD:

[rank: 10][epoch: 0][iter: 21] NEW GRAD:
tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:1')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:2')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:2')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:3')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:1')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:3')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:3')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:0')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:3')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:0')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:3')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:0')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:2')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:1')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:0')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:2')
[rank: 22][epoch: 0][iter: 21] NEW GRAD:

[rank: 9][epoch: 0][iter: 21] NEW GRAD:
tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:0')
[rank: 19][epoch: 0][iter: 21] NEW GRAD:
tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:1')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:0')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:2')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:3')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:2')tensor([-1.9568e-04,  1.8238e-03,  3.6859e-04,  ...,  1.9430e-03,
        -4.1445e-05, -2.1022e-04], device='cuda:1')
[rank: 5][epoch: 0][iter: 22] BEFORE:
tensor([-0.0002,  0.0023, -0.0014,  ..., -0.0013, -0.0060, -0.0046],
       device='cuda:1')
[rank: 13][epoch: 0][iter: 22] BEFORE:
tensor([ 0.0001,  0.0008, -0.0006,  ..., -0.0005,  0.0160, -0.0014],
       device='cuda:1')
[rank: 18][epoch: 0][iter: 22] BEFORE:

[rank: 7][epoch: 0][iter: 22] BEFORE:
tensor([ 0.0004,  0.0012,  0.0003,  ..., -0.0094, -0.0124, -0.0119],
       device='cuda:2')
[rank: 2][epoch: 0][iter: 22] BEFORE:

[rank: 11][epoch: 0][iter: 22] BEFORE:
tensor([ 5.5108e-04, -1.5662e-03, -1.7454e-04,  ...,  3.7331e-03,
        -9.4546e-05, -4.6624e-04], device='cuda:3')
[rank: 21][epoch: 0][iter: 22] BEFORE:

[rank: 15][epoch: 0][iter: 22] BEFORE:
tensor([ 0.0020, -0.0002, -0.0017,  ..., -0.0015, -0.0023, -0.0030],
       device='cuda:2')tensor([-0.0002, -0.0022,  0.0005,  ...,  0.0037, -0.0111, -0.0011],
       device='cuda:3')
[rank: 16][epoch: 0][iter: 22] BEFORE:

[rank: 4][epoch: 0][iter: 22] BEFORE:
tensor([-0.0001, -0.0040, -0.0051,  ...,  0.0018, -0.0027,  0.0046],
       device='cuda:1')tensor([-0.0018,  0.0007,  0.0008,  ..., -0.0013, -0.0029, -0.0006],
       device='cuda:3')
[rank: 3][epoch: 0][iter: 22] BEFORE:

[rank: 8][epoch: 0][iter: 22] BEFORE:

[rank: 17][epoch: 0][iter: 22] BEFORE:
tensor([-0.0027,  0.0003, -0.0002,  ...,  0.0014,  0.0035,  0.0012],
       device='cuda:0')
[rank: 23][epoch: 0][iter: 22] BEFORE:

[rank: 0][epoch: 0][iter: 22] BEFORE:

[rank: 12][epoch: 0][iter: 22] BEFORE:
tensor([ 0.0028,  0.0029, -0.0016,  ..., -0.0166, -0.0163, -0.0179],
       device='cuda:0')tensor([-0.0003, -0.0008, -0.0012,  ..., -0.0021,  0.0013,  0.0011],
       device='cuda:0')
[rank: 6][epoch: 0][iter: 22] BEFORE:

[rank: 20][epoch: 0][iter: 22] BEFORE:
tensor([-2.7919e-03, -3.8335e-03,  2.4128e-03,  ...,  3.9158e-05,
        -1.3811e-02, -1.4618e-02], device='cuda:3')
[rank: 10][epoch: 0][iter: 22] BEFORE:
tensor([-0.0030,  0.0009,  0.0003,  ..., -0.0034, -0.0017, -0.0005],
       device='cuda:0')tensor([-0.0002, -0.0025, -0.0023,  ...,  0.0019, -0.0014, -0.0011],
       device='cuda:1')tensor([-0.0007,  0.0089, -0.0017,  ...,  0.0019,  0.0022,  0.0026],
       device='cuda:2')tensor([-0.0019, -0.0006,  0.0007,  ..., -0.0015, -0.0016, -0.0021],
       device='cuda:3')tensor([-2.2665e-03, -2.6277e-03,  1.4034e-05,  ...,  1.9118e-03,
         1.9203e-03,  1.3096e-03], device='cuda:0')
[rank: 14][epoch: 0][iter: 22] BEFORE:
tensor([-0.0016, -0.0008, -0.0029,  ..., -0.0007, -0.0030, -0.0138],
       device='cuda:2')
[rank: 22][epoch: 0][iter: 22] BEFORE:

[rank: 1][epoch: 0][iter: 22] BEFORE:
tensor([ 0.0034,  0.0002, -0.0008,  ...,  0.0033,  0.0003,  0.0001],
       device='cuda:2')
[rank: 19][epoch: 0][iter: 22] BEFORE:
tensor([ 1.6296e-03, -6.5317e-04,  7.1731e-04,  ...,  5.8928e-03,
         1.0760e-04, -2.9897e-05], device='cuda:0')tensor([ 0.0003, -0.0024,  0.0007,  ..., -0.0013,  0.0027,  0.0023],
       device='cuda:1')
[rank: 9][epoch: 0][iter: 22] BEFORE:

[rank: 17][epoch: 0][iter: 22] AFTER HANDLE:

[rank: 13][epoch: 0][iter: 22] AFTER HANDLE:

[rank: 5][epoch: 0][iter: 22] AFTER HANDLE:
tensor([-0.0010, -0.0007, -0.0002,  ...,  0.0003,  0.0020,  0.0030],
       device='cuda:2')
[rank: 0][epoch: 0][iter: 22] AFTER HANDLE:

[rank: 8][epoch: 0][iter: 22] AFTER HANDLE:

[rank: 16][epoch: 0][iter: 22] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 22] AFTER HANDLE:

[rank: 4][epoch: 0][iter: 22] AFTER HANDLE:

[rank: 21][epoch: 0][iter: 22] AFTER HANDLE:

[rank: 3][epoch: 0][iter: 22] AFTER HANDLE:

[rank: 11][epoch: 0][iter: 22] AFTER HANDLE:

[rank: 18][epoch: 0][iter: 22] AFTER HANDLE:

[rank: 12][epoch: 0][iter: 22] AFTER HANDLE:

[rank: 7][epoch: 0][iter: 22] AFTER HANDLE:

[rank: 23][epoch: 0][iter: 22] AFTER HANDLE:

[rank: 2][epoch: 0][iter: 22] AFTER HANDLE:

[rank: 10][epoch: 0][iter: 22] AFTER HANDLE:
tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:3')
[rank: 14][epoch: 0][iter: 22] AFTER HANDLE:

[rank: 6][epoch: 0][iter: 22] AFTER HANDLE:

[rank: 20][epoch: 0][iter: 22] AFTER HANDLE:

[rank: 1][epoch: 0][iter: 22] AFTER HANDLE:
tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:1')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:1')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:1')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:1')
[rank: 22][epoch: 0][iter: 22] AFTER HANDLE:
tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:0')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:0')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:0')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:3')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:0')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:1')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:3')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:3')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:2')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:0')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:3')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:3')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:2')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:2')
[rank: 19][epoch: 0][iter: 22] AFTER HANDLE:
tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:2')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:2')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:0')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:1')
[rank: 9][epoch: 0][iter: 22] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 22] NEW GRAD:

[rank: 13][epoch: 0][iter: 22] NEW GRAD:

[rank: 5][epoch: 0][iter: 22] NEW GRAD:
tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:2')
[rank: 0][epoch: 0][iter: 22] NEW GRAD:

[rank: 8][epoch: 0][iter: 22] NEW GRAD:

[rank: 16][epoch: 0][iter: 22] NEW GRAD:

[rank: 15][epoch: 0][iter: 22] NEW GRAD:

[rank: 4][epoch: 0][iter: 22] NEW GRAD:

[rank: 21][epoch: 0][iter: 22] NEW GRAD:

[rank: 3][epoch: 0][iter: 22] NEW GRAD:

[rank: 11][epoch: 0][iter: 22] NEW GRAD:

[rank: 18][epoch: 0][iter: 22] NEW GRAD:

[rank: 12][epoch: 0][iter: 22] NEW GRAD:

[rank: 7][epoch: 0][iter: 22] NEW GRAD:

[rank: 23][epoch: 0][iter: 22] NEW GRAD:

[rank: 2][epoch: 0][iter: 22] NEW GRAD:

[rank: 10][epoch: 0][iter: 22] NEW GRAD:
tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:3')
[rank: 14][epoch: 0][iter: 22] NEW GRAD:

[rank: 6][epoch: 0][iter: 22] NEW GRAD:

[rank: 20][epoch: 0][iter: 22] NEW GRAD:

[rank: 1][epoch: 0][iter: 22] NEW GRAD:
tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:1')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:1')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:1')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:1')
[rank: 22][epoch: 0][iter: 22] NEW GRAD:
tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:0')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:0')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:0')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:3')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:0')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:1')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:3')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:3')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:2')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:0')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:3')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:3')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:2')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:2')
[rank: 19][epoch: 0][iter: 22] NEW GRAD:
tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:2')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:2')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:0')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:1')
[rank: 9][epoch: 0][iter: 22] NEW GRAD:
tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:3')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:2')tensor([-4.8444e-04,  6.1508e-07, -5.3807e-04,  ...,  2.9424e-04,
        -1.0399e-03, -2.2778e-03], device='cuda:1')
[rank: 17][epoch: 0][iter: 23] BEFORE:
tensor([ 0.0004,  0.0089, -0.0055,  ..., -0.0008, -0.0002,  0.0006],
       device='cuda:1')
[rank: 13][epoch: 0][iter: 23] BEFORE:

[rank: 5][epoch: 0][iter: 23] BEFORE:
tensor([ 0.0033, -0.0062, -0.0070,  ..., -0.0011,  0.0044,  0.0039],
       device='cuda:1')tensor([ 0.0018, -0.0050,  0.0014,  ..., -0.0041, -0.0018, -0.0032],
       device='cuda:1')
[rank: 8][epoch: 0][iter: 23] BEFORE:

[rank: 0][epoch: 0][iter: 23] BEFORE:

[rank: 15][epoch: 0][iter: 23] BEFORE:
tensor([ 8.7635e-05, -5.7904e-03,  9.3354e-04,  ...,  4.0366e-03,
         2.9589e-04, -8.2384e-04], device='cuda:0')
[rank: 16][epoch: 0][iter: 23] BEFORE:
tensor([ 3.6431e-05, -4.4280e-04, -1.1125e-03,  ...,  3.4648e-03,
         3.9354e-03,  2.4168e-03], device='cuda:0')
[rank: 4][epoch: 0][iter: 23] BEFORE:
tensor([-0.0013,  0.0039, -0.0037,  ..., -0.0024,  0.0023, -0.0001],
       device='cuda:3')
[rank: 11][epoch: 0][iter: 23] BEFORE:

[rank: 3][epoch: 0][iter: 23] BEFORE:
tensor([ 0.0018,  0.0009,  0.0015,  ...,  0.0021, -0.0001,  0.0044],
       device='cuda:0')tensor([-0.0017,  0.0048,  0.0014,  ...,  0.0016,  0.0063,  0.0062],
       device='cuda:0')
[rank: 21][epoch: 0][iter: 23] BEFORE:
tensor([-0.0028, -0.0012, -0.0006,  ..., -0.0013, -0.0020, -0.0050],
       device='cuda:3')
[rank: 18][epoch: 0][iter: 23] BEFORE:
tensor([-0.0017, -0.0002,  0.0008,  ...,  0.0065,  0.0005,  0.0007],
       device='cuda:3')
[rank: 12][epoch: 0][iter: 23] BEFORE:

[rank: 7][epoch: 0][iter: 23] BEFORE:

[rank: 23][epoch: 0][iter: 23] BEFORE:

[rank: 10][epoch: 0][iter: 23] BEFORE:
tensor([ 0.0019,  0.0094,  0.0010,  ..., -0.0041,  0.0010,  0.0016],
       device='cuda:2')
[rank: 2][epoch: 0][iter: 23] BEFORE:

[rank: 14][epoch: 0][iter: 23] BEFORE:

[rank: 6][epoch: 0][iter: 23] BEFORE:
tensor([-3.9527e-03,  1.5153e-03,  2.8881e-03,  ..., -1.1801e-02,
        -2.6314e-03,  2.3172e-05], device='cuda:1')tensor([-0.0001,  0.0010, -0.0019,  ..., -0.0010, -0.0021,  0.0042],
       device='cuda:2')
[rank: 1][epoch: 0][iter: 23] BEFORE:
tensor([-0.0003, -0.0004, -0.0016,  ...,  0.0019,  0.0022, -0.0004],
       device='cuda:0')tensor([-0.0018,  0.0033, -0.0006,  ...,  0.0081,  0.0072,  0.0081],
       device='cuda:3')
[rank: 20][epoch: 0][iter: 23] BEFORE:
tensor([-0.0017, -0.0025,  0.0032,  ..., -0.0014,  0.0042,  0.0039],
       device='cuda:2')tensor([ 0.0029, -0.0024, -0.0002,  ...,  0.0008, -0.0053, -0.0054],
       device='cuda:2')
[rank: 9][epoch: 0][iter: 23] BEFORE:
tensor([ 0.0006, -0.0007, -0.0017,  ...,  0.0006, -0.0005,  0.0010],
       device='cuda:2')tensor([ 0.0014, -0.0003,  0.0008,  ...,  0.0057,  0.0035, -0.0012],
       device='cuda:3')tensor([-0.0006,  0.0028,  0.0042,  ..., -0.0088, -0.0035, -0.0030],
       device='cuda:1')
[rank: 19][epoch: 0][iter: 23] BEFORE:

[rank: 10][epoch: 0][iter: 23] AFTER HANDLE:

[rank: 5][epoch: 0][iter: 23] AFTER HANDLE:

[rank: 13][epoch: 0][iter: 23] AFTER HANDLE:

[rank: 22][epoch: 0][iter: 23] BEFORE:

[rank: 0][epoch: 0][iter: 23] AFTER HANDLE:

[rank: 18][epoch: 0][iter: 23] AFTER HANDLE:

[rank: 11][epoch: 0][iter: 23] AFTER HANDLE:

[rank: 7][epoch: 0][iter: 23] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 23] AFTER HANDLE:
tensor([ 2.5971e-04,  2.9806e-03, -9.9358e-05,  ...,  2.7561e-03,
         1.6154e-04, -1.1584e-03], device='cuda:0')
[rank: 2][epoch: 0][iter: 23] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 23] AFTER HANDLE:

[rank: 8][epoch: 0][iter: 23] AFTER HANDLE:

[rank: 4][epoch: 0][iter: 23] AFTER HANDLE:

[rank: 12][epoch: 0][iter: 23] AFTER HANDLE:

[rank: 21][epoch: 0][iter: 23] AFTER HANDLE:

[rank: 3][epoch: 0][iter: 23] AFTER HANDLE:

[rank: 16][epoch: 0][iter: 23] AFTER HANDLE:
tensor([-0.0024,  0.0133,  0.0103,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:1')
[rank: 6][epoch: 0][iter: 23] AFTER HANDLE:

[rank: 14][epoch: 0][iter: 23] AFTER HANDLE:

[rank: 23][epoch: 0][iter: 23] AFTER HANDLE:

[rank: 1][epoch: 0][iter: 23] AFTER HANDLE:
tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:3')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:2')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:1')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:1')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:2')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:0')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:2')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:3')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:3')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:3')
[rank: 20][epoch: 0][iter: 23] AFTER HANDLE:
tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:2')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:1')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:0')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:0')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:0')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:1')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:3')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:0')
[rank: 9][epoch: 0][iter: 23] AFTER HANDLE:
tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:2')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:2')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:3')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:1')
[rank: 19][epoch: 0][iter: 23] AFTER HANDLE:

[rank: 10][epoch: 0][iter: 23] NEW GRAD:

[rank: 5][epoch: 0][iter: 23] NEW GRAD:

[rank: 13][epoch: 0][iter: 23] NEW GRAD:

[rank: 22][epoch: 0][iter: 23] AFTER HANDLE:

[rank: 0][epoch: 0][iter: 23] NEW GRAD:

[rank: 18][epoch: 0][iter: 23] NEW GRAD:

[rank: 11][epoch: 0][iter: 23] NEW GRAD:

[rank: 7][epoch: 0][iter: 23] NEW GRAD:

[rank: 15][epoch: 0][iter: 23] NEW GRAD:
tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:0')
[rank: 2][epoch: 0][iter: 23] NEW GRAD:

[rank: 17][epoch: 0][iter: 23] NEW GRAD:

[rank: 8][epoch: 0][iter: 23] NEW GRAD:

[rank: 4][epoch: 0][iter: 23] NEW GRAD:

[rank: 12][epoch: 0][iter: 23] NEW GRAD:

[rank: 21][epoch: 0][iter: 23] NEW GRAD:

[rank: 3][epoch: 0][iter: 23] NEW GRAD:

[rank: 16][epoch: 0][iter: 23] NEW GRAD:
tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:1')
[rank: 6][epoch: 0][iter: 23] NEW GRAD:

[rank: 14][epoch: 0][iter: 23] NEW GRAD:

[rank: 23][epoch: 0][iter: 23] NEW GRAD:

[rank: 1][epoch: 0][iter: 23] NEW GRAD:
tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:3')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:2')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:1')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:1')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:2')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:0')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:2')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:3')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:3')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:3')
[rank: 20][epoch: 0][iter: 23] NEW GRAD:
tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:2')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:1')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:0')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:0')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:0')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:1')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:3')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:0')
[rank: 9][epoch: 0][iter: 23] NEW GRAD:
tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:2')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:2')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:3')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:1')
[rank: 19][epoch: 0][iter: 23] NEW GRAD:
tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:1')
[rank: 22][epoch: 0][iter: 23] NEW GRAD:
tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:3')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:0')tensor([-0.0001,  0.0011,  0.0003,  ...,  0.0001,  0.0011,  0.0007],
       device='cuda:2')
[rank: 10][epoch: 0][iter: 24] BEFORE:

[rank: 5][epoch: 0][iter: 24] BEFORE:

[rank: 13][epoch: 0][iter: 24] BEFORE:
tensor([ 0.0033, -0.0033,  0.0036,  ..., -0.0002,  0.0004,  0.0007],
       device='cuda:2')tensor([ 1.6065e-03, -4.9293e-05,  1.6818e-03,  ...,  7.2105e-05,
         2.0510e-04,  2.6555e-04], device='cuda:1')tensor([ 0.0173, -0.0020, -0.0065,  ...,  0.0006, -0.0004, -0.0004],
       device='cuda:1')
[rank: 0][epoch: 0][iter: 24] BEFORE:

[rank: 11][epoch: 0][iter: 24] BEFORE:

[rank: 7][epoch: 0][iter: 24] BEFORE:

[rank: 18][epoch: 0][iter: 24] BEFORE:
tensor([-6.4641e-05, -2.6285e-03,  3.1524e-04,  ..., -5.8377e-05,
        -5.5444e-04,  7.5852e-05], device='cuda:0')
[rank: 15][epoch: 0][iter: 24] BEFORE:
tensor([-0.0002, -0.0004, -0.0001,  ...,  0.0007,  0.0004, -0.0012],
       device='cuda:3')tensor([ 1.0237e-03,  7.2387e-04, -9.1543e-03,  ..., -5.0348e-05,
        -1.9359e-03, -1.6500e-03], device='cuda:3')tensor([-0.0064,  0.0017,  0.0016,  ..., -0.0060, -0.0036, -0.0008],
       device='cuda:2')tensor([ 0.0011,  0.0003,  0.0004,  ...,  0.0008,  0.0007, -0.0013],
       device='cuda:3')
[rank: 8][epoch: 0][iter: 24] BEFORE:

[rank: 2][epoch: 0][iter: 24] BEFORE:

[rank: 17][epoch: 0][iter: 24] BEFORE:

[rank: 4][epoch: 0][iter: 24] BEFORE:

[rank: 3][epoch: 0][iter: 24] BEFORE:
tensor([ 0.0036,  0.0019,  0.0035,  ..., -0.0011, -0.0003,  0.0008],
       device='cuda:0')
[rank: 12][epoch: 0][iter: 24] BEFORE:
tensor([ 0.0026, -0.0004, -0.0001,  ..., -0.0004, -0.0008,  0.0003],
       device='cuda:1')tensor([-0.0127,  0.0004,  0.0004,  ...,  0.0010, -0.0004,  0.0008],
       device='cuda:2')tensor([ 0.0118,  0.0082,  0.0053,  ..., -0.0004,  0.0001,  0.0004],
       device='cuda:0')
[rank: 21][epoch: 0][iter: 24] BEFORE:

[rank: 16][epoch: 0][iter: 24] BEFORE:
tensor([ 0.0001, -0.0003,  0.0006,  ...,  0.0004,  0.0007,  0.0004],
       device='cuda:0')tensor([ 4.1496e-04,  8.0040e-04,  6.0182e-04,  ..., -6.5822e-04,
        -3.2063e-05,  8.1265e-04], device='cuda:3')
[rank: 6][epoch: 0][iter: 24] BEFORE:
tensor([ 1.4881e-02,  7.4555e-03, -2.2942e-03,  ..., -1.0232e-03,
        -2.7994e-05,  9.7245e-05], device='cuda:1')tensor([ 4.3904e-03,  1.5307e-03, -3.6468e-05,  ..., -9.8575e-04,
        -1.4035e-03, -2.2313e-04], device='cuda:0')
[rank: 1][epoch: 0][iter: 24] BEFORE:
tensor([ 0.0029, -0.0071, -0.0011,  ..., -0.0011,  0.0006,  0.0013],
       device='cuda:2')
[rank: 22][epoch: 0][iter: 24] BEFORE:

[rank: 14][epoch: 0][iter: 24] BEFORE:
tensor([ 0.0108,  0.0130,  0.0130,  ...,  0.0012,  0.0006, -0.0004],
       device='cuda:1')
[rank: 23][epoch: 0][iter: 24] BEFORE:
tensor([-0.0014,  0.0006, -0.0054,  ...,  0.0003, -0.0003, -0.0011],
       device='cuda:2')
[rank: 20][epoch: 0][iter: 24] BEFORE:

[rank: 19][epoch: 0][iter: 24] BEFORE:
tensor([ 0.0072, -0.0021, -0.0017,  ..., -0.0021,  0.0009, -0.0009],
       device='cuda:2')
[rank: 9][epoch: 0][iter: 24] BEFORE:
tensor([-0.0049, -0.0045,  0.0021,  ..., -0.0031, -0.0014, -0.0018],
       device='cuda:3')tensor([-0.0027, -0.0022,  0.0016,  ..., -0.0005, -0.0019, -0.0014],
       device='cuda:3')
[rank: 0][epoch: 0][iter: 24] AFTER HANDLE:

[rank: 5][epoch: 0][iter: 24] AFTER HANDLE:

[rank: 12][epoch: 0][iter: 24] AFTER HANDLE:

[rank: 11][epoch: 0][iter: 24] AFTER HANDLE:
tensor([-0.0027,  0.0121,  0.0021,  ..., -0.0007,  0.0025, -0.0026],
       device='cuda:0')
[rank: 16][epoch: 0][iter: 24] AFTER HANDLE:

[rank: 1][epoch: 0][iter: 24] AFTER HANDLE:

[rank: 4][epoch: 0][iter: 24] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 24] AFTER HANDLE:

[rank: 10][epoch: 0][iter: 24] AFTER HANDLE:

[rank: 21][epoch: 0][iter: 24] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 24] AFTER HANDLE:

[rank: 3][epoch: 0][iter: 24] AFTER HANDLE:

[rank: 6][epoch: 0][iter: 24] AFTER HANDLE:

[rank: 13][epoch: 0][iter: 24] AFTER HANDLE:

[rank: 8][epoch: 0][iter: 24] AFTER HANDLE:

[rank: 22][epoch: 0][iter: 24] AFTER HANDLE:

[rank: 18][epoch: 0][iter: 24] AFTER HANDLE:

[rank: 2][epoch: 0][iter: 24] AFTER HANDLE:

[rank: 7][epoch: 0][iter: 24] AFTER HANDLE:

[rank: 14][epoch: 0][iter: 24] AFTER HANDLE:
tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:1')
[rank: 23][epoch: 0][iter: 24] AFTER HANDLE:

[rank: 19][epoch: 0][iter: 24] AFTER HANDLE:
tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:0')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:1')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:0')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:3')
[rank: 20][epoch: 0][iter: 24] AFTER HANDLE:
tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:0')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:1')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:0')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:3')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:2')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:1')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:1')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:3')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:2')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:1')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:0')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:2')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:2')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:2')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:3')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:2')
[rank: 9][epoch: 0][iter: 24] AFTER HANDLE:
tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:3')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:3')
[rank: 0][epoch: 0][iter: 24] NEW GRAD:

[rank: 5][epoch: 0][iter: 24] NEW GRAD:

[rank: 12][epoch: 0][iter: 24] NEW GRAD:

[rank: 11][epoch: 0][iter: 24] NEW GRAD:
tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:0')
[rank: 16][epoch: 0][iter: 24] NEW GRAD:

[rank: 1][epoch: 0][iter: 24] NEW GRAD:

[rank: 4][epoch: 0][iter: 24] NEW GRAD:

[rank: 15][epoch: 0][iter: 24] NEW GRAD:

[rank: 10][epoch: 0][iter: 24] NEW GRAD:

[rank: 21][epoch: 0][iter: 24] NEW GRAD:

[rank: 17][epoch: 0][iter: 24] NEW GRAD:

[rank: 3][epoch: 0][iter: 24] NEW GRAD:

[rank: 6][epoch: 0][iter: 24] NEW GRAD:

[rank: 13][epoch: 0][iter: 24] NEW GRAD:

[rank: 8][epoch: 0][iter: 24] NEW GRAD:

[rank: 22][epoch: 0][iter: 24] NEW GRAD:

[rank: 18][epoch: 0][iter: 24] NEW GRAD:

[rank: 2][epoch: 0][iter: 24] NEW GRAD:

[rank: 7][epoch: 0][iter: 24] NEW GRAD:

[rank: 14][epoch: 0][iter: 24] NEW GRAD:
tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:1')
[rank: 23][epoch: 0][iter: 24] NEW GRAD:

[rank: 19][epoch: 0][iter: 24] NEW GRAD:
tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:0')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:1')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:0')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:3')
[rank: 20][epoch: 0][iter: 24] NEW GRAD:
tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:0')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:1')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:0')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:3')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:2')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:1')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:1')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:3')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:2')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:1')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:0')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:2')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:2')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:2')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:3')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:2')
[rank: 9][epoch: 0][iter: 24] NEW GRAD:
tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:3')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:3')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:1')tensor([ 0.0022,  0.0010,  0.0004,  ..., -0.0006, -0.0002, -0.0003],
       device='cuda:0')
[rank: 5][epoch: 0][iter: 25] BEFORE:

[rank: 0][epoch: 0][iter: 25] BEFORE:

[rank: 11][epoch: 0][iter: 25] BEFORE:
tensor([-6.3850e-05,  2.1812e-04, -1.4502e-04,  ..., -1.5171e-02,
         2.2103e-03, -9.4992e-03], device='cuda:1')
[rank: 12][epoch: 0][iter: 25] BEFORE:
tensor([ 0.0002,  0.0015,  0.0007,  ...,  0.0003,  0.0020, -0.0014],
       device='cuda:0')tensor([-0.0008, -0.0002,  0.0009,  ..., -0.0006, -0.0003, -0.0029],
       device='cuda:3')
[rank: 16][epoch: 0][iter: 25] BEFORE:

[rank: 1][epoch: 0][iter: 25] BEFORE:
tensor([ 7.2893e-05, -2.9093e-04,  1.4047e-03,  ...,  1.3980e-04,
        -1.7093e-03,  5.5032e-03], device='cuda:0')
[rank: 4][epoch: 0][iter: 25] BEFORE:
tensor([ 0.0002, -0.0002, -0.0013,  ...,  0.0010, -0.0004,  0.0007],
       device='cuda:0')
[rank: 15][epoch: 0][iter: 25] BEFORE:
tensor([ 1.4773e-05,  3.9793e-04, -1.9925e-03,  ..., -1.8733e-03,
         1.0177e-02, -1.9019e-03], device='cuda:1')
[rank: 17][epoch: 0][iter: 25] BEFORE:
tensor([ 2.7643e-04, -1.0436e-04,  1.3413e-04,  ..., -2.2053e-05,
         5.5616e-04,  5.4048e-04], device='cuda:0')tensor([-0.0002, -0.0005, -0.0004,  ...,  0.0023, -0.0002, -0.0005],
       device='cuda:3')
[rank: 3][epoch: 0][iter: 25] BEFORE:

[rank: 21][epoch: 0][iter: 25] BEFORE:
tensor([-0.0002,  0.0002,  0.0013,  ...,  0.0020,  0.0009,  0.0005],
       device='cuda:1')
[rank: 6][epoch: 0][iter: 25] BEFORE:

[rank: 8][epoch: 0][iter: 25] BEFORE:

[rank: 13][epoch: 0][iter: 25] BEFORE:
tensor([-3.0538e-05, -8.9301e-05,  6.0180e-04,  ...,  1.1136e-04,
        -3.2114e-04, -1.2568e-04], device='cuda:3')
[rank: 22][epoch: 0][iter: 25] BEFORE:

[rank: 18][epoch: 0][iter: 25] BEFORE:

[rank: 7][epoch: 0][iter: 25] BEFORE:
tensor([-0.0015, -0.0004, -0.0012,  ..., -0.0039, -0.0007, -0.0048],
       device='cuda:0')
[rank: 14][epoch: 0][iter: 25] BEFORE:

[rank: 2][epoch: 0][iter: 25] BEFORE:
tensor([-0.0006,  0.0007,  0.0005,  ..., -0.0019, -0.0014,  0.0004],
       device='cuda:1')tensor([-1.7970e-05, -3.1373e-03, -1.8793e-03,  ..., -6.4166e-04,
        -1.8920e-04, -1.1227e-04], device='cuda:2')tensor([ 7.1053e-04, -4.2109e-05,  2.3262e-04,  ..., -1.3043e-03,
        -3.9832e-05,  2.7332e-03], device='cuda:2')
[rank: 10][epoch: 0][iter: 25] BEFORE:
tensor([ 1.6623e-03,  4.9563e-04,  8.6022e-04,  ..., -2.1920e-03,
        -3.2994e-05,  4.5521e-04], device='cuda:1')tensor([-2.6045e-04, -1.7017e-04, -7.0948e-05,  ..., -1.7515e-03,
         4.1504e-04, -1.8342e-02], device='cuda:2')tensor([ 0.0003,  0.0010, -0.0002,  ...,  0.0002,  0.0009, -0.0012],
       device='cuda:2')tensor([-4.3284e-05,  1.2405e-04, -2.0633e-04,  ...,  3.3648e-04,
         2.5566e-03,  1.8844e-03], device='cuda:3')
[rank: 9][epoch: 0][iter: 25] BEFORE:
tensor([ 0.0001,  0.0005, -0.0014,  ...,  0.0008,  0.0010,  0.0010],
       device='cuda:2')
[rank: 19][epoch: 0][iter: 25] BEFORE:

[rank: 2][epoch: 0][iter: 25] AFTER HANDLE:

[rank: 23][epoch: 0][iter: 25] BEFORE:

[rank: 5][epoch: 0][iter: 25] AFTER HANDLE:
tensor([-0.0006,  0.0005,  0.0016,  ...,  0.0054, -0.0080,  0.0028],
       device='cuda:2')
[rank: 12][epoch: 0][iter: 25] AFTER HANDLE:

[rank: 18][epoch: 0][iter: 25] AFTER HANDLE:

[rank: 1][epoch: 0][iter: 25] AFTER HANDLE:

[rank: 20][epoch: 0][iter: 25] BEFORE:

[rank: 4][epoch: 0][iter: 25] AFTER HANDLE:

[rank: 11][epoch: 0][iter: 25] AFTER HANDLE:

[rank: 13][epoch: 0][iter: 25] AFTER HANDLE:

[rank: 16][epoch: 0][iter: 25] AFTER HANDLE:

[rank: 0][epoch: 0][iter: 25] AFTER HANDLE:

[rank: 21][epoch: 0][iter: 25] AFTER HANDLE:

[rank: 6][epoch: 0][iter: 25] AFTER HANDLE:

[rank: 8][epoch: 0][iter: 25] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 25] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 25] AFTER HANDLE:

[rank: 3][epoch: 0][iter: 25] AFTER HANDLE:

[rank: 22][epoch: 0][iter: 25] AFTER HANDLE:

[rank: 7][epoch: 0][iter: 25] AFTER HANDLE:
tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:1')
[rank: 14][epoch: 0][iter: 25] AFTER HANDLE:
tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:3')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:2')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:3')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:1')
[rank: 10][epoch: 0][iter: 25] AFTER HANDLE:
tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:0')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:2')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:1')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:0')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:0')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:3')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:1')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:0')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:0')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:1')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:2')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:0')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:3')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:1')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:3')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:2')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:3')
[rank: 9][epoch: 0][iter: 25] AFTER HANDLE:
tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:2')
[rank: 19][epoch: 0][iter: 25] AFTER HANDLE:

[rank: 2][epoch: 0][iter: 25] NEW GRAD:

[rank: 23][epoch: 0][iter: 25] AFTER HANDLE:

[rank: 5][epoch: 0][iter: 25] NEW GRAD:
tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:2')
[rank: 12][epoch: 0][iter: 25] NEW GRAD:

[rank: 18][epoch: 0][iter: 25] NEW GRAD:

[rank: 1][epoch: 0][iter: 25] NEW GRAD:

[rank: 20][epoch: 0][iter: 25] AFTER HANDLE:

[rank: 4][epoch: 0][iter: 25] NEW GRAD:

[rank: 11][epoch: 0][iter: 25] NEW GRAD:

[rank: 13][epoch: 0][iter: 25] NEW GRAD:

[rank: 16][epoch: 0][iter: 25] NEW GRAD:

[rank: 0][epoch: 0][iter: 25] NEW GRAD:

[rank: 21][epoch: 0][iter: 25] NEW GRAD:

[rank: 6][epoch: 0][iter: 25] NEW GRAD:

[rank: 8][epoch: 0][iter: 25] NEW GRAD:

[rank: 15][epoch: 0][iter: 25] NEW GRAD:

[rank: 17][epoch: 0][iter: 25] NEW GRAD:

[rank: 3][epoch: 0][iter: 25] NEW GRAD:

[rank: 22][epoch: 0][iter: 25] NEW GRAD:

[rank: 7][epoch: 0][iter: 25] NEW GRAD:
tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:1')
[rank: 14][epoch: 0][iter: 25] NEW GRAD:
tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:3')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:2')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:3')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:1')
[rank: 10][epoch: 0][iter: 25] NEW GRAD:
tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:0')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:2')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:1')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:0')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:0')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:3')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:1')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:0')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:0')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:1')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:2')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:0')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:3')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:1')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:3')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:2')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:3')
[rank: 9][epoch: 0][iter: 25] NEW GRAD:
tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:2')
[rank: 19][epoch: 0][iter: 25] NEW GRAD:

[rank: 23][epoch: 0][iter: 25] NEW GRAD:
tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:2')
[rank: 20][epoch: 0][iter: 25] NEW GRAD:
tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:3')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:1')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:3')tensor([-5.3736e-05, -4.4607e-05, -6.1957e-05,  ..., -7.5208e-04,
         4.5323e-04, -1.2572e-03], device='cuda:0')
[rank: 5][epoch: 0][iter: 26] BEFORE:
tensor([ 0.0025, -0.0014,  0.0010,  ..., -0.0003, -0.0002, -0.0002],
       device='cuda:1')
[rank: 2][epoch: 0][iter: 26] BEFORE:

[rank: 12][epoch: 0][iter: 26] BEFORE:
tensor([-0.0005, -0.0049,  0.0036,  ...,  0.0001,  0.0027, -0.0008],
       device='cuda:2')
[rank: 18][epoch: 0][iter: 26] BEFORE:
tensor([ 5.0225e-05,  3.2034e-04, -4.4974e-03,  ...,  2.2279e-03,
         1.5922e-05,  3.1261e-04], device='cuda:0')
[rank: 4][epoch: 0][iter: 26] BEFORE:
tensor([ 0.0009,  0.0011,  0.0013,  ..., -0.0002, -0.0015,  0.0037],
       device='cuda:2')
[rank: 11][epoch: 0][iter: 26] BEFORE:

[rank: 13][epoch: 0][iter: 26] BEFORE:
tensor([-1.2217e-03, -7.5385e-06,  2.8178e-03,  ...,  2.5548e-04,
         3.5113e-03, -5.0571e-04], device='cuda:0')
[rank: 1][epoch: 0][iter: 26] BEFORE:

[rank: 16][epoch: 0][iter: 26] BEFORE:
tensor([ 0.0058,  0.0039, -0.0012,  ..., -0.0038,  0.0021, -0.0013],
       device='cuda:3')tensor([-4.6302e-04,  3.9171e-03,  5.9710e-04,  ...,  1.1566e-04,
        -4.2122e-05, -2.7723e-04], device='cuda:1')
[rank: 0][epoch: 0][iter: 26] BEFORE:

[rank: 6][epoch: 0][iter: 26] BEFORE:
tensor([-1.7029e-04, -4.2956e-04, -2.5876e-04,  ..., -4.7518e-04,
        -4.8332e-05,  1.8718e-03], device='cuda:0')
[rank: 8][epoch: 0][iter: 26] BEFORE:

[rank: 15][epoch: 0][iter: 26] BEFORE:
tensor([-0.0005,  0.0002,  0.0002,  ..., -0.0019, -0.0009, -0.0018],
       device='cuda:1')
[rank: 21][epoch: 0][iter: 26] BEFORE:

[rank: 17][epoch: 0][iter: 26] BEFORE:
tensor([-0.0094, -0.0038, -0.0022,  ...,  0.0008, -0.0017,  0.0006],
       device='cuda:2')tensor([-3.8719e-05, -4.6692e-04, -7.4731e-03,  ..., -2.2384e-05,
        -1.5972e-03,  1.5201e-03], device='cuda:0')tensor([-0.0010, -0.0030, -0.0007,  ..., -0.0018,  0.0003, -0.0002],
       device='cuda:0')tensor([-0.0002,  0.0004, -0.0020,  ..., -0.0009,  0.0005, -0.0009],
       device='cuda:3')
[rank: 22][epoch: 0][iter: 26] BEFORE:

[rank: 7][epoch: 0][iter: 26] BEFORE:
tensor([-8.7140e-05, -7.6146e-04,  3.8682e-05,  ...,  1.1613e-02,
         5.9296e-03,  5.8227e-03], device='cuda:1')
[rank: 10][epoch: 0][iter: 26] BEFORE:

[rank: 3][epoch: 0][iter: 26] BEFORE:

[rank: 14][epoch: 0][iter: 26] BEFORE:
tensor([ 0.0001, -0.0001,  0.0009,  ..., -0.0032,  0.0012, -0.0004],
       device='cuda:1')tensor([ 1.2003e-03,  5.5188e-03, -3.0352e-04,  ..., -3.6342e-04,
         7.2751e-05,  5.8572e-04], device='cuda:3')tensor([ 0.0015,  0.0047, -0.0022,  ...,  0.0016,  0.0005,  0.0003],
       device='cuda:2')tensor([-5.4817e-05, -1.1466e-03,  6.8070e-03,  ...,  2.4513e-03,
        -2.2006e-04, -8.4038e-04], device='cuda:3')tensor([ 0.0020,  0.0001,  0.0004,  ..., -0.0010, -0.0005, -0.0003],
       device='cuda:2')tensor([-1.0500e-03, -6.5856e-04, -9.7207e-05,  ..., -1.6409e-02,
        -1.8189e-02,  2.5291e-04], device='cuda:2')
[rank: 23][epoch: 0][iter: 26] BEFORE:

[rank: 20][epoch: 0][iter: 26] BEFORE:

[rank: 9][epoch: 0][iter: 26] BEFORE:
tensor([ 2.1773e-04, -1.0076e-03,  1.5876e-03,  ..., -5.8677e-03,
         5.0584e-03,  5.5541e-05], device='cuda:3')
[rank: 19][epoch: 0][iter: 26] BEFORE:
tensor([ 0.0026, -0.0008,  0.0030,  ...,  0.0007, -0.0003, -0.0004],
       device='cuda:1')tensor([ 0.0006, -0.0039, -0.0020,  ...,  0.0003, -0.0005, -0.0005],
       device='cuda:0')
[rank: 2][epoch: 0][iter: 26] AFTER HANDLE:

[rank: 13][epoch: 0][iter: 26] AFTER HANDLE:

[rank: 5][epoch: 0][iter: 26] AFTER HANDLE:

[rank: 16][epoch: 0][iter: 26] AFTER HANDLE:

[rank: 10][epoch: 0][iter: 26] AFTER HANDLE:

[rank: 22][epoch: 0][iter: 26] AFTER HANDLE:

[rank: 0][epoch: 0][iter: 26] AFTER HANDLE:

[rank: 14][epoch: 0][iter: 26] AFTER HANDLE:

[rank: 6][epoch: 0][iter: 26] AFTER HANDLE:

[rank: 18][epoch: 0][iter: 26] AFTER HANDLE:

[rank: 11][epoch: 0][iter: 26] AFTER HANDLE:

[rank: 23][epoch: 0][iter: 26] AFTER HANDLE:

[rank: 1][epoch: 0][iter: 26] AFTER HANDLE:

[rank: 12][epoch: 0][iter: 26] AFTER HANDLE:

[rank: 4][epoch: 0][iter: 26] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 26] AFTER HANDLE:

[rank: 8][epoch: 0][iter: 26] AFTER HANDLE:

[rank: 21][epoch: 0][iter: 26] AFTER HANDLE:

[rank: 3][epoch: 0][iter: 26] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 26] AFTER HANDLE:

[rank: 7][epoch: 0][iter: 26] AFTER HANDLE:
tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:3')
[rank: 9][epoch: 0][iter: 26] AFTER HANDLE:

[rank: 20][epoch: 0][iter: 26] AFTER HANDLE:
tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:2')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:1')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:1')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:0')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:2')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:2')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:0')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:2')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:2')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:2')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:3')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:3')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:1')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:0')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:0')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:1')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:0')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:1')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:3')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:3')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:3')
[rank: 19][epoch: 0][iter: 26] AFTER HANDLE:
tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:1')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:0')
[rank: 2][epoch: 0][iter: 26] NEW GRAD:

[rank: 13][epoch: 0][iter: 26] NEW GRAD:

[rank: 5][epoch: 0][iter: 26] NEW GRAD:

[rank: 16][epoch: 0][iter: 26] NEW GRAD:

[rank: 10][epoch: 0][iter: 26] NEW GRAD:

[rank: 22][epoch: 0][iter: 26] NEW GRAD:

[rank: 0][epoch: 0][iter: 26] NEW GRAD:

[rank: 14][epoch: 0][iter: 26] NEW GRAD:

[rank: 6][epoch: 0][iter: 26] NEW GRAD:

[rank: 18][epoch: 0][iter: 26] NEW GRAD:

[rank: 11][epoch: 0][iter: 26] NEW GRAD:

[rank: 23][epoch: 0][iter: 26] NEW GRAD:

[rank: 1][epoch: 0][iter: 26] NEW GRAD:

[rank: 12][epoch: 0][iter: 26] NEW GRAD:

[rank: 4][epoch: 0][iter: 26] NEW GRAD:

[rank: 17][epoch: 0][iter: 26] NEW GRAD:

[rank: 8][epoch: 0][iter: 26] NEW GRAD:

[rank: 21][epoch: 0][iter: 26] NEW GRAD:

[rank: 3][epoch: 0][iter: 26] NEW GRAD:

[rank: 15][epoch: 0][iter: 26] NEW GRAD:

[rank: 7][epoch: 0][iter: 26] NEW GRAD:
tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:3')
[rank: 9][epoch: 0][iter: 26] NEW GRAD:

[rank: 20][epoch: 0][iter: 26] NEW GRAD:
tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:2')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:1')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:1')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:0')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:2')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:2')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:0')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:2')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:2')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:2')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:3')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:3')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:1')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:0')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:0')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:1')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:0')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:1')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:3')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:3')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:3')
[rank: 19][epoch: 0][iter: 26] NEW GRAD:
tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:1')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:0')tensor([ 1.0408e-04, -7.2875e-05, -2.0561e-05,  ..., -6.2552e-04,
        -2.8171e-04,  2.7323e-04], device='cuda:3')
[rank: 13][epoch: 0][iter: 27] BEFORE:

[rank: 5][epoch: 0][iter: 27] BEFORE:

[rank: 2][epoch: 0][iter: 27] BEFORE:
tensor([-0.0008,  0.0010,  0.0038,  ..., -0.0003, -0.0006,  0.0006],
       device='cuda:1')tensor([-0.0006, -0.0003,  0.0002,  ...,  0.0008,  0.0009,  0.0006],
       device='cuda:1')
[rank: 16][epoch: 0][iter: 27] BEFORE:
tensor([-4.8679e-04, -2.0226e-03, -1.2719e-03,  ...,  5.5865e-04,
         4.1167e-05,  2.1573e-03], device='cuda:2')
[rank: 22][epoch: 0][iter: 27] BEFORE:
tensor([-6.3754e-06, -4.0947e-04, -5.8436e-04,  ..., -1.5504e-03,
         1.9253e-02, -2.8587e-03], device='cuda:0')
[rank: 0][epoch: 0][iter: 27] BEFORE:
tensor([-0.0015,  0.0029,  0.0024,  ...,  0.0025,  0.0048,  0.0023],
       device='cuda:2')
[rank: 6][epoch: 0][iter: 27] BEFORE:
tensor([ 1.0262e-05, -7.8509e-04, -2.2719e-04,  ...,  2.2403e-04,
         1.1406e-04,  1.4485e-04], device='cuda:0')
[rank: 11][epoch: 0][iter: 27] BEFORE:

[rank: 14][epoch: 0][iter: 27] BEFORE:
tensor([-1.5894e-04,  6.9930e-04, -4.9009e-04,  ...,  1.6110e-03,
        -3.3224e-05, -1.0592e-03], device='cuda:2')
[rank: 18][epoch: 0][iter: 27] BEFORE:
tensor([-0.0027, -0.0048,  0.0013,  ...,  0.0019, -0.0009,  0.0009],
       device='cuda:3')
[rank: 1][epoch: 0][iter: 27] BEFORE:
tensor([-3.5027e-04, -1.1722e-02,  3.5000e-04,  ...,  3.4951e-05,
        -3.8152e-04, -1.3787e-04], device='cuda:2')
[rank: 23][epoch: 0][iter: 27] BEFORE:
tensor([-1.1925e-03,  7.0390e-05,  2.9999e-03,  ..., -1.5066e-03,
        -6.3569e-04,  3.5252e-03], device='cuda:2')
[rank: 4][epoch: 0][iter: 27] BEFORE:

[rank: 12][epoch: 0][iter: 27] BEFORE:
tensor([-1.2646e-05, -4.7917e-05,  1.2143e-03,  ...,  7.2236e-03,
        -1.7268e-03, -1.6040e-04], device='cuda:1')
[rank: 8][epoch: 0][iter: 27] BEFORE:
tensor([ 0.0001, -0.0047,  0.0006,  ..., -0.0004, -0.0020,  0.0011],
       device='cuda:3')
[rank: 17][epoch: 0][iter: 27] BEFORE:
tensor([ 8.1189e-04,  6.4819e-03, -8.3992e-04,  ..., -7.2391e-05,
         1.2687e-04, -3.3962e-04], device='cuda:0')tensor([ 3.3399e-04, -4.0233e-03, -1.4793e-03,  ...,  7.4999e-07,
         4.3960e-04,  1.6319e-03], device='cuda:0')
[rank: 3][epoch: 0][iter: 27] BEFORE:

[rank: 10][epoch: 0][iter: 27] BEFORE:

[rank: 21][epoch: 0][iter: 27] BEFORE:

[rank: 7][epoch: 0][iter: 27] BEFORE:
tensor([-0.0033,  0.0014,  0.0008,  ...,  0.0034,  0.0046,  0.0010],
       device='cuda:1')
[rank: 15][epoch: 0][iter: 27] BEFORE:
tensor([-0.0017, -0.0007,  0.0056,  ..., -0.0011,  0.0024, -0.0018],
       device='cuda:3')tensor([ 0.0002, -0.0063, -0.0059,  ...,  0.0021, -0.0082,  0.0064],
       device='cuda:0')
[rank: 20][epoch: 0][iter: 27] BEFORE:

[rank: 5][epoch: 0][iter: 27] AFTER HANDLE:

[rank: 16][epoch: 0][iter: 27] AFTER HANDLE:

[rank: 13][epoch: 0][iter: 27] AFTER HANDLE:

[rank: 0][epoch: 0][iter: 27] AFTER HANDLE:

[rank: 9][epoch: 0][iter: 27] BEFORE:

[rank: 22][epoch: 0][iter: 27] AFTER HANDLE:

[rank: 4][epoch: 0][iter: 27] AFTER HANDLE:

[rank: 18][epoch: 0][iter: 27] AFTER HANDLE:

[rank: 12][epoch: 0][iter: 27] AFTER HANDLE:

[rank: 1][epoch: 0][iter: 27] AFTER HANDLE:

[rank: 11][epoch: 0][iter: 27] AFTER HANDLE:

[rank: 23][epoch: 0][iter: 27] AFTER HANDLE:

[rank: 6][epoch: 0][iter: 27] AFTER HANDLE:

[rank: 19][epoch: 0][iter: 27] BEFORE:

[rank: 14][epoch: 0][iter: 27] AFTER HANDLE:

[rank: 2][epoch: 0][iter: 27] AFTER HANDLE:
tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:2')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:1')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:3')
[rank: 17][epoch: 0][iter: 27] AFTER HANDLE:
tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:3')
[rank: 3][epoch: 0][iter: 27] AFTER HANDLE:

[rank: 8][epoch: 0][iter: 27] AFTER HANDLE:
tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:0')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:1')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:0')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:1')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:0')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:1')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:2')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:0')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:2')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:0')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:1')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:3')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:3')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:2')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:3')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:2')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:2')
[rank: 10][epoch: 0][iter: 27] AFTER HANDLE:

[rank: 21][epoch: 0][iter: 27] AFTER HANDLE:

[rank: 7][epoch: 0][iter: 27] AFTER HANDLE:
tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:1')
[rank: 15][epoch: 0][iter: 27] AFTER HANDLE:
tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:3')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:0')
[rank: 20][epoch: 0][iter: 27] AFTER HANDLE:

[rank: 5][epoch: 0][iter: 27] NEW GRAD:

[rank: 16][epoch: 0][iter: 27] NEW GRAD:

[rank: 13][epoch: 0][iter: 27] NEW GRAD:

[rank: 0][epoch: 0][iter: 27] NEW GRAD:

[rank: 9][epoch: 0][iter: 27] AFTER HANDLE:

[rank: 22][epoch: 0][iter: 27] NEW GRAD:

[rank: 4][epoch: 0][iter: 27] NEW GRAD:

[rank: 18][epoch: 0][iter: 27] NEW GRAD:

[rank: 12][epoch: 0][iter: 27] NEW GRAD:

[rank: 1][epoch: 0][iter: 27] NEW GRAD:

[rank: 11][epoch: 0][iter: 27] NEW GRAD:

[rank: 23][epoch: 0][iter: 27] NEW GRAD:

[rank: 6][epoch: 0][iter: 27] NEW GRAD:

[rank: 19][epoch: 0][iter: 27] AFTER HANDLE:

[rank: 14][epoch: 0][iter: 27] NEW GRAD:

[rank: 2][epoch: 0][iter: 27] NEW GRAD:
tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:2')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:1')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:3')
[rank: 17][epoch: 0][iter: 27] NEW GRAD:
tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:3')
[rank: 3][epoch: 0][iter: 27] NEW GRAD:

[rank: 8][epoch: 0][iter: 27] NEW GRAD:
tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:0')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:1')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:0')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:1')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:0')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:1')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:2')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:0')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:2')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:0')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:1')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:3')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:3')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:2')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:3')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:2')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:2')
[rank: 10][epoch: 0][iter: 27] NEW GRAD:

[rank: 21][epoch: 0][iter: 27] NEW GRAD:

[rank: 7][epoch: 0][iter: 27] NEW GRAD:
tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:1')
[rank: 15][epoch: 0][iter: 27] NEW GRAD:
tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:3')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:0')
[rank: 20][epoch: 0][iter: 27] NEW GRAD:
tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:3')
[rank: 19][epoch: 0][iter: 27] NEW GRAD:
tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:3')
[rank: 9][epoch: 0][iter: 27] NEW GRAD:
tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:1')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:3')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:2')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:0')tensor([-5.5403e-04, -1.1677e-03, -3.3704e-05,  ...,  4.9480e-04,
         4.6042e-04,  5.7490e-04], device='cuda:1')
[rank: 5][epoch: 0][iter: 28] BEFORE:
tensor([-0.0006, -0.0004,  0.0008,  ..., -0.0032,  0.0006,  0.0034],
       device='cuda:1')
[rank: 13][epoch: 0][iter: 28] BEFORE:

[rank: 16][epoch: 0][iter: 28] BEFORE:
tensor([-0.0029, -0.0010,  0.0007,  ..., -0.0024, -0.0012, -0.0027],
       device='cuda:1')
[rank: 0][epoch: 0][iter: 28] BEFORE:
tensor([ 0.0003,  0.0020, -0.0043,  ...,  0.0013,  0.0007,  0.0016],
       device='cuda:0')
[rank: 4][epoch: 0][iter: 28] BEFORE:

[rank: 22][epoch: 0][iter: 28] BEFORE:
tensor([-9.3373e-05,  5.7707e-04,  2.5196e-03,  ...,  1.6403e-03,
         2.9788e-03, -5.6540e-03], device='cuda:0')tensor([-0.0005, -0.0002, -0.0004,  ...,  0.0009,  0.0009, -0.0002],
       device='cuda:0')
[rank: 18][epoch: 0][iter: 28] BEFORE:

[rank: 11][epoch: 0][iter: 28] BEFORE:

[rank: 1][epoch: 0][iter: 28] BEFORE:
tensor([-0.0001,  0.0014,  0.0005,  ...,  0.0018,  0.0006, -0.0039],
       device='cuda:2')
[rank: 12][epoch: 0][iter: 28] BEFORE:
tensor([-0.0004, -0.0001,  0.0014,  ..., -0.0022, -0.0004,  0.0010],
       device='cuda:2')
[rank: 6][epoch: 0][iter: 28] BEFORE:
tensor([ 0.0024, -0.0019, -0.0005,  ...,  0.0006, -0.0042,  0.0006],
       device='cuda:3')tensor([-0.0085,  0.0010, -0.0062,  ...,  0.0010,  0.0015, -0.0002],
       device='cuda:1')
[rank: 14][epoch: 0][iter: 28] BEFORE:
tensor([ 6.3477e-04,  1.1176e-03, -9.6261e-05,  ..., -4.7485e-04,
        -6.0369e-04, -5.2185e-04], device='cuda:2')
[rank: 2][epoch: 0][iter: 28] BEFORE:
tensor([-5.8714e-04,  3.9733e-05,  2.4834e-04,  ..., -1.6329e-03,
         1.4244e-03,  3.0480e-04], device='cuda:0')
[rank: 17][epoch: 0][iter: 28] BEFORE:

[rank: 3][epoch: 0][iter: 28] BEFORE:
tensor([2.2030e-04, 1.1380e-03, 7.2945e-05,  ..., 4.7204e-04, 1.0709e-02,
        1.2239e-02], device='cuda:2')
[rank: 8][epoch: 0][iter: 28] BEFORE:
tensor([-6.2446e-05,  6.9846e-04, -6.9731e-04,  ..., -6.9951e-03,
        -1.2629e-04, -2.6529e-03], device='cuda:2')tensor([ 0.0015, -0.0008,  0.0067,  ...,  0.0135,  0.0102, -0.0011],
       device='cuda:1')
[rank: 7][epoch: 0][iter: 28] BEFORE:

[rank: 23][epoch: 0][iter: 28] BEFORE:
tensor([-0.0010, -0.0014, -0.0016,  ..., -0.0003,  0.0012,  0.0010],
       device='cuda:3')tensor([ 0.0009, -0.0009,  0.0001,  ..., -0.0010, -0.0008,  0.0010],
       device='cuda:0')
[rank: 15][epoch: 0][iter: 28] BEFORE:
tensor([-3.7115e-04, -4.9599e-04,  2.0986e-05,  ..., -8.4054e-04,
        -4.5760e-04, -9.7041e-04], device='cuda:3')tensor([ 1.5417e-04, -7.1557e-04,  8.7659e-05,  ...,  1.0910e-02,
         1.0314e-02, -1.2384e-03], device='cuda:3')
[rank: 19][epoch: 0][iter: 28] BEFORE:

[rank: 10][epoch: 0][iter: 28] BEFORE:
tensor([ 2.1730e-03, -1.5027e-03,  3.8262e-03,  ...,  2.5757e-03,
        -4.7049e-05,  4.1505e-03], device='cuda:3')
[rank: 21][epoch: 0][iter: 28] BEFORE:

[rank: 9][epoch: 0][iter: 28] BEFORE:
tensor([-1.1326e-03, -3.9453e-03,  8.5664e-05,  ...,  9.1260e-04,
        -1.8981e-03, -4.3258e-03], device='cuda:3')
[rank: 1][epoch: 0][iter: 28] AFTER HANDLE:

[rank: 13][epoch: 0][iter: 28] AFTER HANDLE:

[rank: 5][epoch: 0][iter: 28] AFTER HANDLE:

[rank: 20][epoch: 0][iter: 28] BEFORE:
tensor([ 0.0028,  0.0042,  0.0047,  ...,  0.0004,  0.0008, -0.0012],
       device='cuda:2')
[rank: 18][epoch: 0][iter: 28] AFTER HANDLE:

[rank: 3][epoch: 0][iter: 28] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 28] AFTER HANDLE:

[rank: 4][epoch: 0][iter: 28] AFTER HANDLE:

[rank: 23][epoch: 0][iter: 28] AFTER HANDLE:

[rank: 8][epoch: 0][iter: 28] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 28] AFTER HANDLE:

[rank: 2][epoch: 0][iter: 28] AFTER HANDLE:

[rank: 12][epoch: 0][iter: 28] AFTER HANDLE:

[rank: 7][epoch: 0][iter: 28] AFTER HANDLE:

[rank: 22][epoch: 0][iter: 28] AFTER HANDLE:

[rank: 11][epoch: 0][iter: 28] AFTER HANDLE:

[rank: 16][epoch: 0][iter: 28] AFTER HANDLE:

[rank: 0][epoch: 0][iter: 28] AFTER HANDLE:

[rank: 14][epoch: 0][iter: 28] AFTER HANDLE:

[rank: 6][epoch: 0][iter: 28] AFTER HANDLE:
tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:1')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:1')
[rank: 19][epoch: 0][iter: 28] AFTER HANDLE:
tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:1')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:1')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:1')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:0')
[rank: 10][epoch: 0][iter: 28] AFTER HANDLE:
tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:2')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:3')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:3')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:0')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:3')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:0')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:1')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:2')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:0')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:3')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:2')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:3')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:0')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:0')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:2')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:2')
[rank: 21][epoch: 0][iter: 28] AFTER HANDLE:

[rank: 9][epoch: 0][iter: 28] AFTER HANDLE:
tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:3')
[rank: 1][epoch: 0][iter: 28] NEW GRAD:

[rank: 13][epoch: 0][iter: 28] NEW GRAD:

[rank: 5][epoch: 0][iter: 28] NEW GRAD:

[rank: 20][epoch: 0][iter: 28] AFTER HANDLE:
tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:2')
[rank: 18][epoch: 0][iter: 28] NEW GRAD:

[rank: 3][epoch: 0][iter: 28] NEW GRAD:

[rank: 15][epoch: 0][iter: 28] NEW GRAD:

[rank: 4][epoch: 0][iter: 28] NEW GRAD:

[rank: 23][epoch: 0][iter: 28] NEW GRAD:

[rank: 8][epoch: 0][iter: 28] NEW GRAD:

[rank: 17][epoch: 0][iter: 28] NEW GRAD:

[rank: 2][epoch: 0][iter: 28] NEW GRAD:

[rank: 12][epoch: 0][iter: 28] NEW GRAD:

[rank: 7][epoch: 0][iter: 28] NEW GRAD:

[rank: 22][epoch: 0][iter: 28] NEW GRAD:

[rank: 11][epoch: 0][iter: 28] NEW GRAD:

[rank: 16][epoch: 0][iter: 28] NEW GRAD:

[rank: 0][epoch: 0][iter: 28] NEW GRAD:

[rank: 14][epoch: 0][iter: 28] NEW GRAD:

[rank: 6][epoch: 0][iter: 28] NEW GRAD:
tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:1')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:1')
[rank: 19][epoch: 0][iter: 28] NEW GRAD:
tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:1')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:1')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:1')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:0')
[rank: 10][epoch: 0][iter: 28] NEW GRAD:
tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:2')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:3')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:3')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:0')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:3')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:0')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:1')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:2')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:0')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:3')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:2')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:3')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:0')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:0')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:2')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:2')
[rank: 21][epoch: 0][iter: 28] NEW GRAD:

[rank: 9][epoch: 0][iter: 28] NEW GRAD:
tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:3')
[rank: 20][epoch: 0][iter: 28] NEW GRAD:
tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:2')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:1')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:1')tensor([-2.0248e-04, -2.3697e-04,  3.8260e-04,  ...,  1.1419e-03,
         1.8439e-03, -2.5351e-05], device='cuda:0')
[rank: 1][epoch: 0][iter: 29] BEFORE:

[rank: 13][epoch: 0][iter: 29] BEFORE:
tensor([-0.0009,  0.0004,  0.0008,  ..., -0.0016, -0.0002, -0.0003],
       device='cuda:1')
[rank: 5][epoch: 0][iter: 29] BEFORE:
tensor([ 0.0027,  0.0005,  0.0006,  ...,  0.0044, -0.0001,  0.0030],
       device='cuda:1')tensor([ 8.5505e-04,  2.7546e-04,  3.6804e-05,  ..., -8.4114e-04,
        -1.8998e-03, -1.8000e-03], device='cuda:1')
[rank: 3][epoch: 0][iter: 29] BEFORE:

[rank: 15][epoch: 0][iter: 29] BEFORE:

[rank: 18][epoch: 0][iter: 29] BEFORE:
tensor([-1.0093e-04,  2.1406e-04, -6.7532e-05,  ..., -6.8063e-03,
        -4.6769e-03, -1.4052e-03], device='cuda:3')
[rank: 4][epoch: 0][iter: 29] BEFORE:
tensor([ 2.4684e-03, -2.8194e-04,  3.1158e-03,  ...,  5.8089e-05,
         7.3626e-05,  2.2409e-04], device='cuda:3')tensor([-0.0006, -0.0009, -0.0012,  ...,  0.0004,  0.0025,  0.0021],
       device='cuda:2')
[rank: 8][epoch: 0][iter: 29] BEFORE:

[rank: 23][epoch: 0][iter: 29] BEFORE:
tensor([-0.0001,  0.0003, -0.0001,  ..., -0.0002, -0.0002,  0.0007],
       device='cuda:0')
[rank: 17][epoch: 0][iter: 29] BEFORE:
tensor([ 0.0012,  0.0001, -0.0002,  ..., -0.0025,  0.0181,  0.0124],
       device='cuda:0')
[rank: 12][epoch: 0][iter: 29] BEFORE:

[rank: 7][epoch: 0][iter: 29] BEFORE:
tensor([ 0.0003, -0.0006,  0.0004,  ...,  0.0021,  0.0038,  0.0017],
       device='cuda:3')
[rank: 2][epoch: 0][iter: 29] BEFORE:

[rank: 11][epoch: 0][iter: 29] BEFORE:
tensor([-0.0007,  0.0007, -0.0004,  ...,  0.0001,  0.0004,  0.0002],
       device='cuda:1')tensor([ 4.1745e-04, -8.0194e-04, -2.2159e-05,  ..., -2.3252e-05,
         2.7207e-04,  2.1520e-04], device='cuda:0')tensor([-9.7196e-04, -1.8173e-04, -1.0226e-03,  ...,  1.3305e-04,
         1.5236e-05, -5.9120e-05], device='cuda:3')
[rank: 22][epoch: 0][iter: 29] BEFORE:
tensor([ 0.0012, -0.0011, -0.0013,  ..., -0.0006, -0.0048, -0.0002],
       device='cuda:2')tensor([-9.0143e-04, -7.2638e-04, -2.0814e-04,  ...,  8.9692e-05,
         2.6344e-05, -1.5635e-04], device='cuda:3')
[rank: 16][epoch: 0][iter: 29] BEFORE:

[rank: 14][epoch: 0][iter: 29] BEFORE:

[rank: 6][epoch: 0][iter: 29] BEFORE:
tensor([ 2.7147e-04, -3.1664e-04, -7.3335e-04,  ..., -1.3936e-04,
         7.9017e-05,  5.5151e-04], device='cuda:2')
[rank: 0][epoch: 0][iter: 29] BEFORE:

[rank: 10][epoch: 0][iter: 29] BEFORE:

[rank: 19][epoch: 0][iter: 29] BEFORE:
tensor([-2.2345e-03, -9.2546e-05,  4.6232e-04,  ...,  3.4902e-04,
        -7.6102e-04, -1.8834e-04], device='cuda:2')
[rank: 20][epoch: 0][iter: 29] BEFORE:
tensor([ 1.4021e-04,  4.8152e-06,  4.5497e-06,  ..., -1.6181e-04,
         9.7185e-04, -3.4697e-04], device='cuda:2')tensor([-1.5100e-03, -1.1695e-03, -1.7139e-03,  ..., -2.9848e-06,
         1.7889e-05, -3.4267e-04], device='cuda:0')
[rank: 9][epoch: 0][iter: 29] BEFORE:
tensor([ 0.0029, -0.0019,  0.0026,  ...,  0.0005,  0.0020, -0.0011],
       device='cuda:0')
[rank: 13][epoch: 0][iter: 29] AFTER HANDLE:

[rank: 21][epoch: 0][iter: 29] BEFORE:

[rank: 4][epoch: 0][iter: 29] AFTER HANDLE:

[rank: 1][epoch: 0][iter: 29] AFTER HANDLE:

[rank: 8][epoch: 0][iter: 29] AFTER HANDLE:

[rank: 18][epoch: 0][iter: 29] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 29] AFTER HANDLE:

[rank: 23][epoch: 0][iter: 29] AFTER HANDLE:

[rank: 5][epoch: 0][iter: 29] AFTER HANDLE:

[rank: 3][epoch: 0][iter: 29] AFTER HANDLE:

[rank: 11][epoch: 0][iter: 29] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 29] AFTER HANDLE:

[rank: 12][epoch: 0][iter: 29] AFTER HANDLE:

[rank: 22][epoch: 0][iter: 29] AFTER HANDLE:

[rank: 7][epoch: 0][iter: 29] AFTER HANDLE:

[rank: 2][epoch: 0][iter: 29] AFTER HANDLE:
tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:2')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:3')
[rank: 14][epoch: 0][iter: 29] AFTER HANDLE:
tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:0')
[rank: 6][epoch: 0][iter: 29] AFTER HANDLE:

[rank: 0][epoch: 0][iter: 29] AFTER HANDLE:
tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:1')
[rank: 16][epoch: 0][iter: 29] AFTER HANDLE:
tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:1')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:1')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:0')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:1')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:0')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:2')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:3')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:3')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:1')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:3')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:3')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:1')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:0')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:2')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:3')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:2')
[rank: 10][epoch: 0][iter: 29] AFTER HANDLE:

[rank: 19][epoch: 0][iter: 29] AFTER HANDLE:
tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:2')
[rank: 20][epoch: 0][iter: 29] AFTER HANDLE:
tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:2')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:0')
[rank: 9][epoch: 0][iter: 29] AFTER HANDLE:
tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:0')
[rank: 13][epoch: 0][iter: 29] NEW GRAD:

[rank: 21][epoch: 0][iter: 29] AFTER HANDLE:

[rank: 4][epoch: 0][iter: 29] NEW GRAD:

[rank: 1][epoch: 0][iter: 29] NEW GRAD:

[rank: 8][epoch: 0][iter: 29] NEW GRAD:

[rank: 18][epoch: 0][iter: 29] NEW GRAD:

[rank: 15][epoch: 0][iter: 29] NEW GRAD:

[rank: 23][epoch: 0][iter: 29] NEW GRAD:

[rank: 5][epoch: 0][iter: 29] NEW GRAD:

[rank: 3][epoch: 0][iter: 29] NEW GRAD:

[rank: 11][epoch: 0][iter: 29] NEW GRAD:

[rank: 17][epoch: 0][iter: 29] NEW GRAD:

[rank: 12][epoch: 0][iter: 29] NEW GRAD:

[rank: 22][epoch: 0][iter: 29] NEW GRAD:

[rank: 7][epoch: 0][iter: 29] NEW GRAD:

[rank: 2][epoch: 0][iter: 29] NEW GRAD:
tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:2')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:3')
[rank: 14][epoch: 0][iter: 29] NEW GRAD:
tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:0')
[rank: 6][epoch: 0][iter: 29] NEW GRAD:

[rank: 0][epoch: 0][iter: 29] NEW GRAD:
tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:1')
[rank: 16][epoch: 0][iter: 29] NEW GRAD:
tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:1')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:1')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:0')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:1')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:0')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:2')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:3')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:3')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:1')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:3')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:3')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:1')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:0')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:2')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:3')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:2')
[rank: 10][epoch: 0][iter: 29] NEW GRAD:

[rank: 19][epoch: 0][iter: 29] NEW GRAD:
tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:2')
[rank: 20][epoch: 0][iter: 29] NEW GRAD:
tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:2')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:0')
[rank: 9][epoch: 0][iter: 29] NEW GRAD:
tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:0')
[rank: 21][epoch: 0][iter: 29] NEW GRAD:
tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:2')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:3')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:0')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:1')tensor([ 0.0010,  0.0004,  0.0001,  ..., -0.0006,  0.0005,  0.0006],
       device='cuda:1')
[rank: 13][epoch: 0][iter: 30] BEFORE:
tensor([-0.0030,  0.0065,  0.0009,  ...,  0.0002,  0.0011, -0.0001],
       device='cuda:1')
[rank: 4][epoch: 0][iter: 30] BEFORE:
tensor([ 0.0022,  0.0090, -0.0017,  ..., -0.0013, -0.0009, -0.0016],
       device='cuda:0')
[rank: 1][epoch: 0][iter: 30] BEFORE:
tensor([ 6.2300e-04, -3.3222e-04, -6.2579e-06,  ...,  2.3910e-03,
        -3.9431e-04, -3.0174e-04], device='cuda:1')
[rank: 8][epoch: 0][iter: 30] BEFORE:
tensor([-0.0009, -0.0249,  0.0007,  ..., -0.0007, -0.0002,  0.0004],
       device='cuda:0')
[rank: 15][epoch: 0][iter: 30] BEFORE:
tensor([ 0.0003,  0.0004,  0.0004,  ...,  0.0019,  0.0001, -0.0006],
       device='cuda:3')
[rank: 18][epoch: 0][iter: 30] BEFORE:

[rank: 5][epoch: 0][iter: 30] BEFORE:
tensor([-0.0002,  0.0036, -0.0006,  ..., -0.0012, -0.0011,  0.0007],
       device='cuda:2')tensor([-0.0010,  0.0414,  0.0402,  ..., -0.0055, -0.0057,  0.0008],
       device='cuda:1')
[rank: 23][epoch: 0][iter: 30] BEFORE:

[rank: 3][epoch: 0][iter: 30] BEFORE:
tensor([ 0.0023,  0.0004, -0.0012,  ..., -0.0007,  0.0013,  0.0005],
       device='cuda:3')
[rank: 11][epoch: 0][iter: 30] BEFORE:
tensor([ 0.0003, -0.0029, -0.0003,  ..., -0.0010, -0.0057, -0.0005],
       device='cuda:3')
[rank: 17][epoch: 0][iter: 30] BEFORE:
tensor([-0.0002, -0.0009,  0.0003,  ..., -0.0049, -0.0070,  0.0008],
       device='cuda:1')
[rank: 12][epoch: 0][iter: 30] BEFORE:
tensor([ 1.9268e-04, -5.0666e-05, -2.8488e-04,  ...,  3.5024e-03,
        -1.9379e-03, -1.5832e-03], device='cuda:0')
[rank: 7][epoch: 0][iter: 30] BEFORE:
tensor([-8.1304e-04,  2.5899e-04, -5.4983e-04,  ..., -4.1539e-04,
        -2.8270e-04,  2.2720e-05], device='cuda:3')
[rank: 22][epoch: 0][iter: 30] BEFORE:
tensor([ 5.0658e-05, -3.1614e-04,  2.0807e-05,  ...,  3.0971e-03,
         6.4535e-03,  6.1925e-04], device='cuda:2')
[rank: 10][epoch: 0][iter: 30] BEFORE:

[rank: 2][epoch: 0][iter: 30] BEFORE:
tensor([ 9.0934e-06, -1.4568e-03, -2.9389e-04,  ..., -1.8858e-03,
        -3.8653e-03,  6.4230e-04], device='cuda:2')
[rank: 16][epoch: 0][iter: 30] BEFORE:
tensor([7.4511e-04, 4.4355e-04, 1.1661e-04,  ..., 1.8200e-03, 6.1077e-03,
        6.1731e-05], device='cuda:2')tensor([-0.0003, -0.0016,  0.0006,  ...,  0.0693,  0.0710, -0.0008],
       device='cuda:0')
[rank: 14][epoch: 0][iter: 30] BEFORE:

[rank: 20][epoch: 0][iter: 30] BEFORE:
tensor([-1.0577e-05,  3.6167e-03,  3.3375e-05,  ..., -1.2284e-04,
        -8.6938e-04,  2.1899e-03], device='cuda:2')tensor([ 5.5433e-05,  1.8348e-04, -6.2882e-05,  ...,  1.0034e-03,
        -2.6842e-04, -1.9215e-04], device='cuda:0')
[rank: 6][epoch: 0][iter: 30] BEFORE:
tensor([ 0.0007,  0.0005, -0.0002,  ...,  0.0005,  0.0017,  0.0002],
       device='cuda:2')
[rank: 0][epoch: 0][iter: 30] BEFORE:
tensor([-0.0003,  0.0017, -0.0002,  ..., -0.0044, -0.0015,  0.0018],
       device='cuda:0')
[rank: 19][epoch: 0][iter: 30] BEFORE:
tensor([-0.0018, -0.0002, -0.0001,  ..., -0.0006,  0.0026,  0.0006],
       device='cuda:3')
[rank: 9][epoch: 0][iter: 30] BEFORE:
tensor([-0.0034, -0.0057, -0.0025,  ...,  0.0155,  0.0099, -0.0030],
       device='cuda:1')
[rank: 21][epoch: 0][iter: 30] BEFORE:

[rank: 22][epoch: 0][iter: 30] AFTER HANDLE:

[rank: 20][epoch: 0][iter: 30] AFTER HANDLE:
tensor([0.0032, 0.0034, 0.0024,  ..., 0.0024, 0.0029, 0.0005], device='cuda:3')
[rank: 23][epoch: 0][iter: 30] AFTER HANDLE:

[rank: 0][epoch: 0][iter: 30] AFTER HANDLE:

[rank: 9][epoch: 0][iter: 30] AFTER HANDLE:

[rank: 19][epoch: 0][iter: 30] AFTER HANDLE:

[rank: 4][epoch: 0][iter: 30] AFTER HANDLE:

[rank: 13][epoch: 0][iter: 30] AFTER HANDLE:
tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:1')
[rank: 1][epoch: 0][iter: 30] AFTER HANDLE:

[rank: 11][epoch: 0][iter: 30] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 30] AFTER HANDLE:

[rank: 6][epoch: 0][iter: 30] AFTER HANDLE:

[rank: 12][epoch: 0][iter: 30] AFTER HANDLE:
tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:3')
[rank: 3][epoch: 0][iter: 30] AFTER HANDLE:

[rank: 8][epoch: 0][iter: 30] AFTER HANDLE:

[rank: 16][epoch: 0][iter: 30] AFTER HANDLE:

[rank: 7][epoch: 0][iter: 30] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 30] AFTER HANDLE:
tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:0')
[rank: 2][epoch: 0][iter: 30] AFTER HANDLE:

[rank: 10][epoch: 0][iter: 30] AFTER HANDLE:

[rank: 18][epoch: 0][iter: 30] AFTER HANDLE:

[rank: 5][epoch: 0][iter: 30] AFTER HANDLE:

[rank: 14][epoch: 0][iter: 30] AFTER HANDLE:
tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:2')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:0')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:1')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:3')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:0')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:1')
[rank: 21][epoch: 0][iter: 30] AFTER HANDLE:
tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:1')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:3')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:1')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:2')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:0')
[rank: 23][epoch: 0][iter: 30] NEW GRAD:
tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:3')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:0')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:0')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:3')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:3')
[rank: 20][epoch: 0][iter: 30] NEW GRAD:
tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:2')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:2')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:2')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:1')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:2')
[rank: 22][epoch: 0][iter: 30] NEW GRAD:

[rank: 0][epoch: 0][iter: 30] NEW GRAD:

[rank: 9][epoch: 0][iter: 30] NEW GRAD:

[rank: 19][epoch: 0][iter: 30] NEW GRAD:

[rank: 4][epoch: 0][iter: 30] NEW GRAD:

[rank: 13][epoch: 0][iter: 30] NEW GRAD:
tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:1')
[rank: 1][epoch: 0][iter: 30] NEW GRAD:

[rank: 11][epoch: 0][iter: 30] NEW GRAD:

[rank: 17][epoch: 0][iter: 30] NEW GRAD:

[rank: 6][epoch: 0][iter: 30] NEW GRAD:

[rank: 12][epoch: 0][iter: 30] NEW GRAD:
tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:3')
[rank: 3][epoch: 0][iter: 30] NEW GRAD:

[rank: 8][epoch: 0][iter: 30] NEW GRAD:

[rank: 16][epoch: 0][iter: 30] NEW GRAD:

[rank: 7][epoch: 0][iter: 30] NEW GRAD:

[rank: 15][epoch: 0][iter: 30] NEW GRAD:
tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:0')
[rank: 2][epoch: 0][iter: 30] NEW GRAD:

[rank: 10][epoch: 0][iter: 30] NEW GRAD:

[rank: 18][epoch: 0][iter: 30] NEW GRAD:

[rank: 5][epoch: 0][iter: 30] NEW GRAD:

[rank: 14][epoch: 0][iter: 30] NEW GRAD:
tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:2')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:0')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:1')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:3')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:0')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:1')
[rank: 21][epoch: 0][iter: 30] NEW GRAD:
tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:1')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:3')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:1')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:2')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:0')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:1')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:3')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:0')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:0')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:3')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:3')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:2')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:2')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:2')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:1')tensor([-3.7276e-05,  1.3849e-03,  1.5290e-03,  ...,  3.3061e-03,
         3.0618e-03,  6.0956e-05], device='cuda:2')
[rank: 23][epoch: 0][iter: 31] BEFORE:
tensor([-0.0012, -0.0158, -0.0007,  ...,  0.0006,  0.0007,  0.0016],
       device='cuda:3')
[rank: 20][epoch: 0][iter: 31] BEFORE:
tensor([-7.3589e-04,  1.8973e-04, -2.2914e-03,  ...,  2.1148e-04,
         1.2107e-03,  6.6002e-05], device='cuda:0')
[rank: 22][epoch: 0][iter: 31] BEFORE:
tensor([-0.0006, -0.0006,  0.0001,  ..., -0.0015,  0.0121,  0.0115],
       device='cuda:2')
[rank: 0][epoch: 0][iter: 31] BEFORE:
tensor([-1.8785e-05,  2.2993e-03, -4.6573e-03,  ...,  3.0602e-04,
         8.2069e-06, -7.5469e-04], device='cuda:0')
[rank: 19][epoch: 0][iter: 31] BEFORE:

[rank: 9][epoch: 0][iter: 31] BEFORE:
tensor([-0.0052, -0.0032, -0.0039,  ...,  0.0018, -0.0237, -0.0122],
       device='cuda:3')tensor([-3.4656e-03,  4.1872e-03, -1.0636e-03,  ..., -2.5174e-03,
        -4.8224e-05,  2.8627e-04], device='cuda:1')
[rank: 4][epoch: 0][iter: 31] BEFORE:

[rank: 13][epoch: 0][iter: 31] BEFORE:
tensor([ 5.2331e-04,  1.5443e-03, -2.7209e-03,  ...,  1.0338e-04,
         1.0295e-05, -3.9406e-04], device='cuda:0')
[rank: 1][epoch: 0][iter: 31] BEFORE:
tensor([ 8.5270e-04,  4.6333e-04, -7.8557e-05,  ...,  2.6847e-04,
        -1.5679e-03, -2.7953e-03], device='cuda:1')
[rank: 11][epoch: 0][iter: 31] BEFORE:
tensor([-6.7827e-04,  2.5664e-04,  3.4163e-04,  ...,  9.0023e-04,
         2.3996e-04,  8.9865e-05], device='cuda:1')
[rank: 17][epoch: 0][iter: 31] BEFORE:
tensor([-0.0012, -0.0009, -0.0008,  ..., -0.0010, -0.0029,  0.0002],
       device='cuda:3')
[rank: 6][epoch: 0][iter: 31] BEFORE:
tensor([ 0.0005, -0.0019, -0.0017,  ..., -0.0013, -0.0007, -0.0024],
       device='cuda:1')
[rank: 12][epoch: 0][iter: 31] BEFORE:
tensor([ 5.2289e-04,  5.9738e-06, -6.1148e-04,  ...,  6.6159e-04,
         1.5182e-03,  6.2840e-04], device='cuda:2')
[rank: 3][epoch: 0][iter: 31] BEFORE:
tensor([ 0.0018, -0.0037, -0.0038,  ...,  0.0004, -0.0003,  0.0005],
       device='cuda:0')
[rank: 8][epoch: 0][iter: 31] BEFORE:
tensor([-2.8187e-04,  4.4916e-04, -1.1482e-04,  ..., -5.8138e-05,
         1.0818e-04,  4.2091e-04], device='cuda:3')
[rank: 21][epoch: 0][iter: 31] BEFORE:
tensor([ 3.4127e-04,  1.2368e-04, -9.6281e-05,  ...,  4.6524e-04,
         2.2885e-03,  2.5556e-03], device='cuda:0')
[rank: 16][epoch: 0][iter: 31] BEFORE:

[rank: 7][epoch: 0][iter: 31] BEFORE:
tensor([-4.8865e-04, -2.6173e-04, -3.1897e-05,  ..., -5.6561e-04,
        -8.0633e-05, -6.0488e-05], device='cuda:1')
[rank: 15][epoch: 0][iter: 31] BEFORE:
tensor([-7.6910e-04, -3.7219e-04,  2.6071e-04,  ..., -1.2238e-04,
        -1.8587e-04, -8.9925e-05], device='cuda:3')
[rank: 2][epoch: 0][iter: 31] BEFORE:
tensor([ 8.2278e-06,  9.3182e-05, -4.8496e-04,  ..., -2.3210e-04,
        -2.1746e-03,  1.7920e-03], device='cuda:3')
[rank: 10][epoch: 0][iter: 31] BEFORE:
tensor([ 0.0030,  0.0014,  0.0015,  ..., -0.0012, -0.0024, -0.0034],
       device='cuda:2')tensor([ 0.0002, -0.0025, -0.0002,  ...,  0.0012, -0.0014, -0.0013],
       device='cuda:2')
[rank: 5][epoch: 0][iter: 31] BEFORE:

[rank: 18][epoch: 0][iter: 31] BEFORE:
tensor([-6.7740e-04, -2.2203e-06,  3.0018e-05,  ...,  5.5418e-03,
         1.1942e-02,  1.2421e-02], device='cuda:1')
[rank: 14][epoch: 0][iter: 31] BEFORE:

[rank: 0][epoch: 0][iter: 31] AFTER HANDLE:

[rank: 8][epoch: 0][iter: 31] AFTER HANDLE:
tensor([0.0017, 0.0157, 0.0115,  ..., 0.0003, 0.0004, 0.0005], device='cuda:0')
[rank: 16][epoch: 0][iter: 31] AFTER HANDLE:

[rank: 20][epoch: 0][iter: 31] AFTER HANDLE:

[rank: 4][epoch: 0][iter: 31] AFTER HANDLE:

[rank: 12][epoch: 0][iter: 31] AFTER HANDLE:

[rank: 3][epoch: 0][iter: 31] AFTER HANDLE:

[rank: 10][epoch: 0][iter: 31] AFTER HANDLE:

[rank: 19][epoch: 0][iter: 31] AFTER HANDLE:

[rank: 22][epoch: 0][iter: 31] AFTER HANDLE:

[rank: 6][epoch: 0][iter: 31] AFTER HANDLE:

[rank: 13][epoch: 0][iter: 31] AFTER HANDLE:

[rank: 2][epoch: 0][iter: 31] AFTER HANDLE:

[rank: 9][epoch: 0][iter: 31] AFTER HANDLE:

[rank: 17][epoch: 0][iter: 31] AFTER HANDLE:

[rank: 21][epoch: 0][iter: 31] AFTER HANDLE:

[rank: 7][epoch: 0][iter: 31] AFTER HANDLE:

[rank: 15][epoch: 0][iter: 31] AFTER HANDLE:

[rank: 1][epoch: 0][iter: 31] AFTER HANDLE:

[rank: 11][epoch: 0][iter: 31] AFTER HANDLE:
tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:2')
[rank: 23][epoch: 0][iter: 31] AFTER HANDLE:

[rank: 5][epoch: 0][iter: 31] AFTER HANDLE:
tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:2')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:0')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:0')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:0')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:0')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:0')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:0')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:3')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:2')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:3')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:2')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:2')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:1')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:2')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:1')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:1')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:1')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:3')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:3')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:1')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:3')
[rank: 18][epoch: 0][iter: 31] AFTER HANDLE:
tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:3')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:1')
[rank: 14][epoch: 0][iter: 31] AFTER HANDLE:

[rank: 0][epoch: 0][iter: 31] NEW GRAD:

[rank: 8][epoch: 0][iter: 31] NEW GRAD:

[rank: 16][epoch: 0][iter: 31] NEW GRAD:

[rank: 20][epoch: 0][iter: 31] NEW GRAD:

[rank: 4][epoch: 0][iter: 31] NEW GRAD:

[rank: 12][epoch: 0][iter: 31] NEW GRAD:

[rank: 3][epoch: 0][iter: 31] NEW GRAD:

[rank: 10][epoch: 0][iter: 31] NEW GRAD:

[rank: 19][epoch: 0][iter: 31] NEW GRAD:

[rank: 22][epoch: 0][iter: 31] NEW GRAD:

[rank: 6][epoch: 0][iter: 31] NEW GRAD:

[rank: 13][epoch: 0][iter: 31] NEW GRAD:

[rank: 2][epoch: 0][iter: 31] NEW GRAD:

[rank: 9][epoch: 0][iter: 31] NEW GRAD:

[rank: 17][epoch: 0][iter: 31] NEW GRAD:

[rank: 21][epoch: 0][iter: 31] NEW GRAD:

[rank: 7][epoch: 0][iter: 31] NEW GRAD:

[rank: 15][epoch: 0][iter: 31] NEW GRAD:

[rank: 1][epoch: 0][iter: 31] NEW GRAD:

[rank: 11][epoch: 0][iter: 31] NEW GRAD:
tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:2')
[rank: 23][epoch: 0][iter: 31] NEW GRAD:

[rank: 5][epoch: 0][iter: 31] NEW GRAD:
tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:2')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:0')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:0')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:0')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:0')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:0')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:0')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:3')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:2')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:3')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:2')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:2')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:1')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:2')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:1')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:1')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:1')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:3')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:3')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:1')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:3')
[rank: 18][epoch: 0][iter: 31] NEW GRAD:
tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:3')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:1')
[rank: 14][epoch: 0][iter: 31] NEW GRAD:
tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:2')tensor([-0.0001, -0.0001, -0.0006,  ...,  0.0004,  0.0003,  0.0009],
       device='cuda:2')
[rank: 20][epoch: 1][iter: 32] BEFORE:

[rank: 8][epoch: 1][iter: 32] BEFORE:

[rank: 22][epoch: 1][iter: 32] BEFORE:
tensor([ 5.6551e-05, -5.2123e-05,  1.9349e-04,  ...,  1.5397e-04,
         3.3640e-04,  9.9645e-04], device='cuda:0')
[rank: 19][epoch: 1][iter: 32] BEFORE:
tensor([ 0.0009,  0.0006,  0.0003,  ..., -0.0014,  0.0002, -0.0001],
       device='cuda:0')tensor([ 1.2608e-03,  2.9055e-03, -1.1170e-02,  ..., -7.2713e-05,
         1.1114e-03, -7.0690e-04], device='cuda:2')
[rank: 0][epoch: 1][iter: 32] BEFORE:
tensor([ 0.0113,  0.0113,  0.0107,  ..., -0.0054,  0.0003, -0.0031],
       device='cuda:3')
[rank: 12][epoch: 1][iter: 32] BEFORE:

[rank: 16][epoch: 1][iter: 32] BEFORE:

[rank: 21][epoch: 1][iter: 32] BEFORE:

[rank: 4][epoch: 1][iter: 32] BEFORE:

[rank: 23][epoch: 1][iter: 32] BEFORE:
tensor([ 6.7454e-04,  2.0067e-04,  5.6293e-05,  ...,  5.0550e-04,
        -1.4270e-03, -2.4715e-03], device='cuda:0')tensor([-0.0008, -0.0007, -0.0003,  ...,  0.0013,  0.0009,  0.0018],
       device='cuda:0')tensor([ 2.1758e-05, -1.4759e-03, -1.7145e-04,  ...,  1.2639e-03,
         8.6880e-04,  1.4327e-04], device='cuda:1')
[rank: 3][epoch: 1][iter: 32] BEFORE:
tensor([ 0.0006, -0.0006,  0.0004,  ..., -0.0003, -0.0008,  0.0010],
       device='cuda:0')
[rank: 13][epoch: 1][iter: 32] BEFORE:
tensor([ 3.4502e-04, -7.5986e-05,  4.3458e-04,  ...,  8.3015e-04,
        -1.1938e-04,  1.8712e-03], device='cuda:0')tensor([-0.0009, -0.0002, -0.0001,  ..., -0.0260, -0.0144, -0.0251],
       device='cuda:3')
[rank: 1][epoch: 1][iter: 32] BEFORE:

[rank: 17][epoch: 1][iter: 32] BEFORE:

[rank: 6][epoch: 1][iter: 32] BEFORE:

[rank: 15][epoch: 1][iter: 32] BEFORE:
tensor([ 0.0006,  0.0003, -0.0005,  ...,  0.0008,  0.0008,  0.0009],
       device='cuda:3')
[rank: 11][epoch: 1][iter: 32] BEFORE:

[rank: 7][epoch: 1][iter: 32] BEFORE:
tensor([ 0.0007, -0.0003,  0.0004,  ...,  0.0001, -0.0002,  0.0008],
       device='cuda:1')tensor([ 0.0009,  0.0003,  0.0006,  ...,  0.0017, -0.0011,  0.0019],
       device='cuda:1')
[rank: 9][epoch: 1][iter: 32] BEFORE:

[rank: 5][epoch: 1][iter: 32] BEFORE:
tensor([ 0.0004,  0.0004, -0.0005,  ..., -0.0017,  0.0003,  0.0006],
       device='cuda:1')
[rank: 2][epoch: 1][iter: 32] BEFORE:
tensor([ 2.1015e-03,  2.5677e-03, -9.6836e-05,  ..., -2.0532e-05,
         1.5219e-05, -3.5637e-04], device='cuda:3')tensor([ 0.0012,  0.0019, -0.0002,  ...,  0.0038, -0.0279, -0.0297],
       device='cuda:3')tensor([ 0.0003,  0.0005,  0.0003,  ..., -0.0003, -0.0003, -0.0001],
       device='cuda:2')
[rank: 18][epoch: 1][iter: 32] BEFORE:

[rank: 10][epoch: 1][iter: 32] BEFORE:
tensor([ 0.0002,  0.0002,  0.0001,  ..., -0.0023,  0.0003,  0.0006],
       device='cuda:3')
[rank: 14][epoch: 1][iter: 32] BEFORE:

[rank: 0][epoch: 1][iter: 32] AFTER HANDLE:

[rank: 16][epoch: 1][iter: 32] AFTER HANDLE:

[rank: 20][epoch: 1][iter: 32] AFTER HANDLE:
tensor([-0.0006,  0.0001, -0.0024,  ..., -0.0003, -0.0010, -0.0005],
       device='cuda:1')tensor([-0.0193,  0.0016, -0.0228,  ..., -0.0036, -0.0012,  0.0018],
       device='cuda:1')
[rank: 15][epoch: 1][iter: 32] AFTER HANDLE:

[rank: 1][epoch: 1][iter: 32] AFTER HANDLE:

[rank: 19][epoch: 1][iter: 32] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 32] AFTER HANDLE:

[rank: 8][epoch: 1][iter: 32] AFTER HANDLE:

[rank: 4][epoch: 1][iter: 32] AFTER HANDLE:

[rank: 13][epoch: 1][iter: 32] AFTER HANDLE:

[rank: 3][epoch: 1][iter: 32] AFTER HANDLE:

[rank: 17][epoch: 1][iter: 32] AFTER HANDLE:

[rank: 22][epoch: 1][iter: 32] AFTER HANDLE:

[rank: 11][epoch: 1][iter: 32] AFTER HANDLE:

[rank: 6][epoch: 1][iter: 32] AFTER HANDLE:

[rank: 12][epoch: 1][iter: 32] AFTER HANDLE:
tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:2')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:2')
[rank: 23][epoch: 1][iter: 32] AFTER HANDLE:
tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:2')
[rank: 7][epoch: 1][iter: 32] AFTER HANDLE:
tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:2')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:0')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:0')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:0')
[rank: 9][epoch: 1][iter: 32] AFTER HANDLE:

[rank: 5][epoch: 1][iter: 32] AFTER HANDLE:
tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:3')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:1')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:3')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:1')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:0')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:0')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:1')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:3')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:1')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:2')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:3')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:2')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:0')
[rank: 2][epoch: 1][iter: 32] AFTER HANDLE:

[rank: 18][epoch: 1][iter: 32] AFTER HANDLE:
tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:3')
[rank: 10][epoch: 1][iter: 32] AFTER HANDLE:
tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:3')
[rank: 14][epoch: 1][iter: 32] AFTER HANDLE:

[rank: 0][epoch: 1][iter: 32] NEW GRAD:

[rank: 16][epoch: 1][iter: 32] NEW GRAD:

[rank: 20][epoch: 1][iter: 32] NEW GRAD:
tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:1')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:1')
[rank: 15][epoch: 1][iter: 32] NEW GRAD:

[rank: 1][epoch: 1][iter: 32] NEW GRAD:

[rank: 19][epoch: 1][iter: 32] NEW GRAD:

[rank: 21][epoch: 1][iter: 32] NEW GRAD:

[rank: 8][epoch: 1][iter: 32] NEW GRAD:

[rank: 4][epoch: 1][iter: 32] NEW GRAD:

[rank: 13][epoch: 1][iter: 32] NEW GRAD:

[rank: 3][epoch: 1][iter: 32] NEW GRAD:

[rank: 17][epoch: 1][iter: 32] NEW GRAD:

[rank: 22][epoch: 1][iter: 32] NEW GRAD:

[rank: 11][epoch: 1][iter: 32] NEW GRAD:

[rank: 6][epoch: 1][iter: 32] NEW GRAD:

[rank: 12][epoch: 1][iter: 32] NEW GRAD:
tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:2')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:2')
[rank: 23][epoch: 1][iter: 32] NEW GRAD:
tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:2')
[rank: 7][epoch: 1][iter: 32] NEW GRAD:
tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:2')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:0')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:0')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:0')
[rank: 9][epoch: 1][iter: 32] NEW GRAD:

[rank: 5][epoch: 1][iter: 32] NEW GRAD:
tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:3')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:1')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:3')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:1')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:0')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:0')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:1')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:3')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:1')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:2')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:3')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:2')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:0')
[rank: 2][epoch: 1][iter: 32] NEW GRAD:

[rank: 18][epoch: 1][iter: 32] NEW GRAD:
tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:3')
[rank: 10][epoch: 1][iter: 32] NEW GRAD:
tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:3')
[rank: 14][epoch: 1][iter: 32] NEW GRAD:
tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:2')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:2')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:1')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:1')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:2')tensor([-0.0015,  0.0010, -0.0024,  ..., -0.0013, -0.0016, -0.0021],
       device='cuda:2')
[rank: 20][epoch: 1][iter: 33] BEFORE:
tensor([ 0.0002, -0.0001, -0.0008,  ...,  0.0002,  0.0004,  0.0003],
       device='cuda:0')
[rank: 15][epoch: 1][iter: 33] BEFORE:

[rank: 1][epoch: 1][iter: 33] BEFORE:
tensor([-1.6212e-04,  9.7168e-05, -7.9711e-05,  ...,  6.0672e-04,
         9.6571e-04, -1.1469e-03], device='cuda:3')
[rank: 19][epoch: 1][iter: 33] BEFORE:
tensor([ 2.1246e-03, -4.7198e-04, -1.1898e-03,  ..., -3.0739e-05,
        -1.4412e-04, -3.1065e-04], device='cuda:1')
[rank: 16][epoch: 1][iter: 33] BEFORE:
tensor([-1.3032e-03,  8.2040e-05, -2.2495e-04,  ..., -1.9017e-04,
        -3.2585e-04,  1.2336e-03], device='cuda:3')tensor([ 2.7169e-04,  1.3301e-04,  1.0579e-04,  ..., -4.0010e-05,
         1.8455e-04,  3.4539e-04], device='cuda:0')
[rank: 8][epoch: 1][iter: 33] BEFORE:

[rank: 21][epoch: 1][iter: 33] BEFORE:
tensor([ 9.5229e-05, -2.6145e-04, -5.4901e-04,  ..., -4.3915e-04,
        -3.7482e-05,  1.9374e-04], device='cuda:0')
[rank: 4][epoch: 1][iter: 33] BEFORE:
tensor([ 5.8813e-04, -3.2917e-04,  3.5364e-05,  ...,  1.1441e-04,
        -9.0339e-04, -8.3347e-04], device='cuda:1')
[rank: 13][epoch: 1][iter: 33] BEFORE:
tensor([-1.9711e-05,  7.2753e-05, -4.0927e-04,  ..., -3.4382e-04,
        -4.1795e-04,  9.4379e-04], device='cuda:0')
[rank: 3][epoch: 1][iter: 33] BEFORE:
tensor([-1.4856e-04, -7.5630e-06, -3.1607e-04,  ..., -5.1061e-03,
         8.6163e-04,  5.6710e-05], device='cuda:1')
[rank: 17][epoch: 1][iter: 33] BEFORE:

[rank: 11][epoch: 1][iter: 33] BEFORE:
tensor([ 3.4633e-04, -6.8349e-05,  8.3982e-04,  ...,  1.1244e-04,
         3.3033e-04,  1.1457e-04], device='cuda:3')
[rank: 22][epoch: 1][iter: 33] BEFORE:
tensor([-2.6305e-05,  4.0399e-04, -1.8466e-04,  ..., -1.4557e-05,
         1.1588e-05, -4.8756e-04], device='cuda:1')
[rank: 6][epoch: 1][iter: 33] BEFORE:
tensor([-1.2938e-03, -2.9789e-04, -1.6586e-03,  ..., -4.0372e-05,
        -2.9757e-04,  2.7922e-05], device='cuda:3')
[rank: 12][epoch: 1][iter: 33] BEFORE:
tensor([-0.0004, -0.0014, -0.0004,  ..., -0.0005, -0.0002, -0.0002],
       device='cuda:2')
[rank: 2][epoch: 1][iter: 33] BEFORE:

[rank: 7][epoch: 1][iter: 33] BEFORE:

[rank: 23][epoch: 1][iter: 33] BEFORE:
tensor([ 3.3211e-04,  7.5781e-05, -1.0517e-04,  ..., -8.4964e-07,
         1.1028e-04,  7.1569e-05], device='cuda:0')
[rank: 18][epoch: 1][iter: 33] BEFORE:
tensor([ 0.0002,  0.0002,  0.0003,  ...,  0.0004,  0.0006, -0.0003],
       device='cuda:2')tensor([ 0.0032,  0.0002,  0.0003,  ..., -0.0003, -0.0017,  0.0002],
       device='cuda:2')tensor([ 0.0684,  0.0934, -0.0046,  ...,  0.0003,  0.0002, -0.0005],
       device='cuda:3')
[rank: 14][epoch: 1][iter: 33] BEFORE:
tensor([ 0.0003,  0.0002,  0.0003,  ..., -0.0001,  0.0003,  0.0005],
       device='cuda:3')tensor([-1.8489e-04,  4.4687e-04, -9.1640e-04,  ..., -4.4404e-04,
         5.9411e-04, -8.5166e-05], device='cuda:2')
[rank: 9][epoch: 1][iter: 33] BEFORE:
tensor([ 1.1204e-03, -6.1697e-03,  2.3594e-05,  ...,  3.5114e-05,
         4.6580e-04, -4.3512e-04], device='cuda:2')
[rank: 5][epoch: 1][iter: 33] BEFORE:

[rank: 10][epoch: 1][iter: 33] BEFORE:
tensor([ 0.0041,  0.0039,  0.0002,  ..., -0.0010,  0.0003, -0.0007],
       device='cuda:1')tensor([ 5.6646e-04, -5.9520e-05, -1.9539e-04,  ...,  1.6965e-05,
        -1.1036e-04, -4.3901e-05], device='cuda:1')tensor([ 1.4880e-04, -7.3524e-04,  2.1080e-04,  ...,  4.3602e-05,
        -6.9618e-06,  1.2317e-04], device='cuda:2')
[rank: 0][epoch: 1][iter: 33] BEFORE:

[rank: 9][epoch: 1][iter: 33] AFTER HANDLE:

[rank: 23][epoch: 1][iter: 33] AFTER HANDLE:

[rank: 19][epoch: 1][iter: 33] AFTER HANDLE:

[rank: 7][epoch: 1][iter: 33] AFTER HANDLE:

[rank: 13][epoch: 1][iter: 33] AFTER HANDLE:

[rank: 1][epoch: 1][iter: 33] AFTER HANDLE:

[rank: 11][epoch: 1][iter: 33] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 33] AFTER HANDLE:

[rank: 17][epoch: 1][iter: 33] AFTER HANDLE:

[rank: 5][epoch: 1][iter: 33] AFTER HANDLE:

[rank: 15][epoch: 1][iter: 33] AFTER HANDLE:

[rank: 3][epoch: 1][iter: 33] AFTER HANDLE:

[rank: 10][epoch: 1][iter: 33] AFTER HANDLE:

[rank: 22][epoch: 1][iter: 33] AFTER HANDLE:

[rank: 18][epoch: 1][iter: 33] AFTER HANDLE:

[rank: 4][epoch: 1][iter: 33] AFTER HANDLE:

[rank: 12][epoch: 1][iter: 33] AFTER HANDLE:

[rank: 2][epoch: 1][iter: 33] AFTER HANDLE:

[rank: 8][epoch: 1][iter: 33] AFTER HANDLE:

[rank: 20][epoch: 1][iter: 33] AFTER HANDLE:

[rank: 16][epoch: 1][iter: 33] AFTER HANDLE:

[rank: 6][epoch: 1][iter: 33] AFTER HANDLE:

[rank: 14][epoch: 1][iter: 33] AFTER HANDLE:
tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:0')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:1')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:3')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:3')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:3')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:1')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:1')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:3')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:1')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:1')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:1')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:3')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:3')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:2')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:2')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:2')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:0')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:0')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:2')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:0')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:0')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:0')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:2')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:2')
[rank: 0][epoch: 1][iter: 33] AFTER HANDLE:

[rank: 9][epoch: 1][iter: 33] NEW GRAD:

[rank: 23][epoch: 1][iter: 33] NEW GRAD:

[rank: 19][epoch: 1][iter: 33] NEW GRAD:

[rank: 7][epoch: 1][iter: 33] NEW GRAD:

[rank: 13][epoch: 1][iter: 33] NEW GRAD:

[rank: 1][epoch: 1][iter: 33] NEW GRAD:

[rank: 11][epoch: 1][iter: 33] NEW GRAD:

[rank: 21][epoch: 1][iter: 33] NEW GRAD:

[rank: 17][epoch: 1][iter: 33] NEW GRAD:

[rank: 5][epoch: 1][iter: 33] NEW GRAD:

[rank: 15][epoch: 1][iter: 33] NEW GRAD:

[rank: 3][epoch: 1][iter: 33] NEW GRAD:

[rank: 10][epoch: 1][iter: 33] NEW GRAD:

[rank: 22][epoch: 1][iter: 33] NEW GRAD:

[rank: 18][epoch: 1][iter: 33] NEW GRAD:

[rank: 4][epoch: 1][iter: 33] NEW GRAD:

[rank: 12][epoch: 1][iter: 33] NEW GRAD:

[rank: 2][epoch: 1][iter: 33] NEW GRAD:

[rank: 8][epoch: 1][iter: 33] NEW GRAD:

[rank: 20][epoch: 1][iter: 33] NEW GRAD:

[rank: 16][epoch: 1][iter: 33] NEW GRAD:

[rank: 6][epoch: 1][iter: 33] NEW GRAD:

[rank: 14][epoch: 1][iter: 33] NEW GRAD:
tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:0')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:1')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:3')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:3')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:3')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:1')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:1')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:3')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:1')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:1')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:1')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:3')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:3')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:2')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:2')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:2')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:0')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:0')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:2')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:0')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:0')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:0')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:2')tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:2')
[rank: 0][epoch: 1][iter: 33] NEW GRAD:
tensor([ 3.2727e-03,  3.7323e-03, -3.7626e-04,  ..., -2.7981e-04,
         3.8255e-05, -1.7737e-05], device='cuda:0')
[rank: 9][epoch: 1][iter: 34] BEFORE:

[rank: 19][epoch: 1][iter: 34] BEFORE:
tensor([-7.7405e-05,  1.4813e-03,  1.0583e-03,  ..., -7.8132e-04,
        -6.8376e-04,  2.9706e-04], device='cuda:1')
[rank: 7][epoch: 1][iter: 34] BEFORE:
tensor([-2.3077e-05, -1.1306e-04, -7.8375e-05,  ..., -3.1685e-04,
        -3.5755e-03, -3.6469e-04], device='cuda:3')
[rank: 1][epoch: 1][iter: 34] BEFORE:

[rank: 23][epoch: 1][iter: 34] BEFORE:
tensor([ 7.1774e-05, -5.3123e-06,  9.8156e-05,  ...,  3.1640e-04,
        -7.0873e-04, -4.7637e-04], device='cuda:3')
[rank: 11][epoch: 1][iter: 34] BEFORE:

[rank: 13][epoch: 1][iter: 34] BEFORE:
tensor([ 9.1489e-05, -1.0370e-04,  3.3648e-04,  ...,  1.7892e-04,
        -5.6101e-04, -7.1154e-06], device='cuda:1')tensor([ 8.0798e-05, -8.3673e-04,  2.4920e-04,  ...,  4.4918e-04,
        -1.8683e-03,  4.3716e-05], device='cuda:3')
[rank: 5][epoch: 1][iter: 34] BEFORE:

[rank: 17][epoch: 1][iter: 34] BEFORE:
tensor([6.1647e-05, 6.2774e-04, 3.6914e-04,  ..., 1.0214e-04, 1.5982e-04,
        6.4419e-04], device='cuda:3')
[rank: 15][epoch: 1][iter: 34] BEFORE:

[rank: 3][epoch: 1][iter: 34] BEFORE:

[rank: 21][epoch: 1][iter: 34] BEFORE:
tensor([ 3.5629e-05, -3.9063e-05,  9.8116e-05,  ...,  2.2131e-05,
         1.0761e-04,  8.4679e-07], device='cuda:1')tensor([2.7846e-04, 2.1793e-04, 8.8652e-05,  ..., 2.6924e-04, 4.3376e-04,
        2.5500e-04], device='cuda:1')
[rank: 10][epoch: 1][iter: 34] BEFORE:
tensor([ 1.1074e-04, -3.2385e-05,  1.3203e-04,  ..., -1.0188e-03,
        -9.8916e-04, -8.8979e-04], device='cuda:1')tensor([-0.0002, -0.0003,  0.0009,  ..., -0.0001, -0.0001, -0.0001],
       device='cuda:3')
[rank: 22][epoch: 1][iter: 34] BEFORE:

[rank: 18][epoch: 1][iter: 34] BEFORE:
tensor([ 0.0015, -0.0002,  0.0002,  ...,  0.0070,  0.0083,  0.0072],
       device='cuda:3')tensor([-0.0007, -0.0003,  0.0009,  ..., -0.0002, -0.0002,  0.0017],
       device='cuda:2')tensor([ 8.5304e-04,  9.7427e-04, -3.2373e-04,  ...,  1.1421e-04,
        -7.2457e-05, -1.8448e-04], device='cuda:1')
[rank: 16][epoch: 1][iter: 34] BEFORE:

[rank: 12][epoch: 1][iter: 34] BEFORE:

[rank: 8][epoch: 1][iter: 34] BEFORE:

[rank: 6][epoch: 1][iter: 34] BEFORE:

[rank: 20][epoch: 1][iter: 34] BEFORE:

[rank: 0][epoch: 1][iter: 34] BEFORE:
tensor([-1.3254e-04,  8.4125e-04,  2.8066e-04,  ..., -9.1067e-05,
         1.5418e-04,  1.5550e-04], device='cuda:2')
[rank: 14][epoch: 1][iter: 34] BEFORE:
tensor([ 3.4218e-05,  2.9748e-04,  6.3454e-05,  ..., -2.8111e-04,
         1.8870e-03, -1.8100e-04], device='cuda:0')tensor([ 0.0002,  0.0002,  0.0003,  ..., -0.0014, -0.0022,  0.0034],
       device='cuda:2')tensor([-0.0003, -0.0003,  0.0004,  ...,  0.0002,  0.0002,  0.0002],
       device='cuda:2')
[rank: 2][epoch: 1][iter: 34] BEFORE:
tensor([ 6.3415e-05,  1.2075e-05,  7.3916e-06,  ..., -1.6194e-03,
        -1.8488e-03,  1.2997e-05], device='cuda:0')tensor([-5.7336e-05, -1.2200e-04, -4.2313e-05,  ..., -8.3246e-04,
        -3.2237e-04, -5.5232e-04], device='cuda:0')
[rank: 9][epoch: 1][iter: 34] AFTER HANDLE:
tensor([ 6.3806e-05,  1.1196e-04, -1.1027e-04,  ...,  1.5305e-03,
         1.2498e-03,  6.1493e-05], device='cuda:0')
[rank: 4][epoch: 1][iter: 34] BEFORE:
tensor([ 0.0013,  0.0004, -0.0009,  ...,  0.0010,  0.0008, -0.0009],
       device='cuda:0')
[rank: 19][epoch: 1][iter: 34] AFTER HANDLE:

[rank: 15][epoch: 1][iter: 34] AFTER HANDLE:

[rank: 11][epoch: 1][iter: 34] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 34] AFTER HANDLE:

[rank: 5][epoch: 1][iter: 34] AFTER HANDLE:

[rank: 1][epoch: 1][iter: 34] AFTER HANDLE:

[rank: 17][epoch: 1][iter: 34] AFTER HANDLE:

[rank: 13][epoch: 1][iter: 34] AFTER HANDLE:

[rank: 8][epoch: 1][iter: 34] AFTER HANDLE:

[rank: 23][epoch: 1][iter: 34] AFTER HANDLE:

[rank: 7][epoch: 1][iter: 34] AFTER HANDLE:

[rank: 3][epoch: 1][iter: 34] AFTER HANDLE:

[rank: 18][epoch: 1][iter: 34] AFTER HANDLE:
tensor([ 0.0001,  0.0001,  0.0002,  ...,  0.0002,  0.0001,  0.0004],
       device='cuda:2')
[rank: 10][epoch: 1][iter: 34] AFTER HANDLE:

[rank: 22][epoch: 1][iter: 34] AFTER HANDLE:

[rank: 6][epoch: 1][iter: 34] AFTER HANDLE:
tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:2')
[rank: 16][epoch: 1][iter: 34] AFTER HANDLE:

[rank: 12][epoch: 1][iter: 34] AFTER HANDLE:
tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:1')
[rank: 20][epoch: 1][iter: 34] AFTER HANDLE:
tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:0')
[rank: 0][epoch: 1][iter: 34] AFTER HANDLE:
tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:3')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:3')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:3')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:1')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:1')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:1')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:1')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:1')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:0')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:3')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:3')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:3')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:2')
[rank: 14][epoch: 1][iter: 34] AFTER HANDLE:
tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:2')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:2')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:2')
[rank: 2][epoch: 1][iter: 34] AFTER HANDLE:
tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:0')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:0')
[rank: 9][epoch: 1][iter: 34] NEW GRAD:
tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:0')
[rank: 4][epoch: 1][iter: 34] AFTER HANDLE:
tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:0')
[rank: 19][epoch: 1][iter: 34] NEW GRAD:

[rank: 15][epoch: 1][iter: 34] NEW GRAD:

[rank: 11][epoch: 1][iter: 34] NEW GRAD:

[rank: 21][epoch: 1][iter: 34] NEW GRAD:

[rank: 5][epoch: 1][iter: 34] NEW GRAD:

[rank: 1][epoch: 1][iter: 34] NEW GRAD:

[rank: 17][epoch: 1][iter: 34] NEW GRAD:

[rank: 13][epoch: 1][iter: 34] NEW GRAD:

[rank: 8][epoch: 1][iter: 34] NEW GRAD:

[rank: 23][epoch: 1][iter: 34] NEW GRAD:

[rank: 7][epoch: 1][iter: 34] NEW GRAD:

[rank: 3][epoch: 1][iter: 34] NEW GRAD:

[rank: 18][epoch: 1][iter: 34] NEW GRAD:
tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:2')
[rank: 10][epoch: 1][iter: 34] NEW GRAD:

[rank: 22][epoch: 1][iter: 34] NEW GRAD:

[rank: 6][epoch: 1][iter: 34] NEW GRAD:
tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:2')
[rank: 16][epoch: 1][iter: 34] NEW GRAD:

[rank: 12][epoch: 1][iter: 34] NEW GRAD:
tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:1')
[rank: 20][epoch: 1][iter: 34] NEW GRAD:
tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:0')
[rank: 0][epoch: 1][iter: 34] NEW GRAD:
tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:3')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:3')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:3')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:1')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:1')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:1')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:1')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:1')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:0')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:3')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:3')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:3')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:2')
[rank: 14][epoch: 1][iter: 34] NEW GRAD:
tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:2')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:2')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:2')
[rank: 2][epoch: 1][iter: 34] NEW GRAD:
tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:0')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:0')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:0')
[rank: 4][epoch: 1][iter: 34] NEW GRAD:
tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:0')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:2')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:2')tensor([9.9101e-05, 1.2312e-04, 1.5306e-04,  ..., 2.4637e-04, 8.5465e-05,
        3.9357e-04], device='cuda:0')
[rank: 9][epoch: 1][iter: 35] BEFORE:
tensor([-2.7876e-04, -1.2696e-04, -3.0226e-04,  ...,  3.0249e-04,
        -3.1581e-04,  7.9916e-06], device='cuda:1')
[rank: 19][epoch: 1][iter: 35] BEFORE:

[rank: 15][epoch: 1][iter: 35] BEFORE:
tensor([ 0.0003, -0.0014,  0.0004,  ...,  0.0002,  0.0008,  0.0002],
       device='cuda:3')
[rank: 11][epoch: 1][iter: 35] BEFORE:
tensor([-2.5662e-02, -2.7660e-02,  3.0889e-03,  ..., -1.2772e-05,
         2.6731e-04,  2.4934e-04], device='cuda:3')
[rank: 21][epoch: 1][iter: 35] BEFORE:
tensor([-2.7692e-04, -6.2222e-04,  1.1477e-05,  ..., -5.4020e-04,
        -5.3304e-04, -8.1308e-05], device='cuda:3')
[rank: 5][epoch: 1][iter: 35] BEFORE:

[rank: 17][epoch: 1][iter: 35] BEFORE:
tensor([-4.4205e-05, -3.7158e-04, -2.8690e-04,  ..., -2.5276e-03,
         3.9036e-03,  3.7910e-03], device='cuda:1')
[rank: 1][epoch: 1][iter: 35] BEFORE:

[rank: 13][epoch: 1][iter: 35] BEFORE:
tensor([-1.2624e-04, -2.4174e-04, -1.3502e-04,  ...,  7.1584e-05,
         6.8455e-05, -5.9948e-05], device='cuda:1')tensor([ 1.0691e-04,  9.3410e-05,  7.5223e-05,  ..., -1.3631e-04,
        -6.6227e-05,  1.1592e-03], device='cuda:1')
[rank: 8][epoch: 1][iter: 35] BEFORE:
tensor([ 9.8547e-05,  2.3526e-04, -8.7648e-05,  ...,  3.4368e-04,
        -7.0575e-04, -4.3733e-04], device='cuda:1')
[rank: 23][epoch: 1][iter: 35] BEFORE:
tensor([ 3.7226e-04,  1.7617e-04, -7.9058e-05,  ...,  1.6862e-04,
         6.4450e-04, -1.3980e-04], device='cuda:1')
[rank: 7][epoch: 1][iter: 35] BEFORE:

[rank: 18][epoch: 1][iter: 35] BEFORE:
tensor([4.6630e-04, 2.3056e-04, 1.5982e-04,  ..., 7.8762e-06, 3.1264e-05,
        1.0238e-04], device='cuda:0')
[rank: 3][epoch: 1][iter: 35] BEFORE:
tensor([ 5.5427e-04,  9.4830e-04,  1.0009e-03,  ...,  3.0564e-04,
        -5.2432e-05,  7.9444e-05], device='cuda:3')
[rank: 6][epoch: 1][iter: 35] BEFORE:
tensor([ 0.0002,  0.0002,  0.0002,  ..., -0.0004, -0.0004, -0.0002],
       device='cuda:2')
[rank: 10][epoch: 1][iter: 35] BEFORE:

[rank: 12][epoch: 1][iter: 35] BEFORE:
tensor([ 1.8123e-04, -1.9982e-04, -3.7445e-07,  ..., -4.8619e-04,
        -8.1260e-04, -3.9906e-04], device='cuda:3')
[rank: 22][epoch: 1][iter: 35] BEFORE:
tensor([-5.9008e-05, -1.0673e-04, -5.8667e-05,  ..., -7.8164e-04,
        -8.4857e-04, -6.9604e-04], device='cuda:3')tensor([-2.4554e-05,  4.9162e-05, -2.7240e-04,  ..., -5.7441e-05,
         1.2132e-03, -2.9901e-04], device='cuda:2')
[rank: 14][epoch: 1][iter: 35] BEFORE:

[rank: 0][epoch: 1][iter: 35] BEFORE:

[rank: 16][epoch: 1][iter: 35] BEFORE:

[rank: 20][epoch: 1][iter: 35] BEFORE:
tensor([-9.1118e-05,  6.4320e-05,  1.8877e-04,  ..., -1.8925e-04,
        -1.8187e-04, -2.0199e-04], device='cuda:2')
[rank: 8][epoch: 1][iter: 35] AFTER HANDLE:
tensor([ 4.4933e-06, -4.2886e-04,  3.4116e-05,  ...,  4.7986e-05,
         6.9490e-05, -1.9932e-05], device='cuda:0')
[rank: 2][epoch: 1][iter: 35] BEFORE:

[rank: 19][epoch: 1][iter: 35] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 35] AFTER HANDLE:

[rank: 4][epoch: 1][iter: 35] BEFORE:

[rank: 9][epoch: 1][iter: 35] AFTER HANDLE:

[rank: 13][epoch: 1][iter: 35] AFTER HANDLE:

[rank: 3][epoch: 1][iter: 35] AFTER HANDLE:

[rank: 17][epoch: 1][iter: 35] AFTER HANDLE:

[rank: 23][epoch: 1][iter: 35] AFTER HANDLE:

[rank: 5][epoch: 1][iter: 35] AFTER HANDLE:

[rank: 11][epoch: 1][iter: 35] AFTER HANDLE:

[rank: 15][epoch: 1][iter: 35] AFTER HANDLE:

[rank: 1][epoch: 1][iter: 35] AFTER HANDLE:

[rank: 18][epoch: 1][iter: 35] AFTER HANDLE:
tensor([-8.8569e-04, -1.0863e-03, 2.6785e-04,  ..., -8.8520e-05, 1.7395e-04,
        1.2553e-04], device='cuda:2')
[rank: 7][epoch: 1][iter: 35] AFTER HANDLE:

[rank: 10][epoch: 1][iter: 35] AFTER HANDLE:
tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:2')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:0')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:0')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:0')
[rank: 6][epoch: 1][iter: 35] AFTER HANDLE:
tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:0')
[rank: 12][epoch: 1][iter: 35] AFTER HANDLE:
tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:2')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:3')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:1')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:0')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:1')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:1')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:3')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:1')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:3')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:1')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:3')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:3')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:1')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:2')
[rank: 22][epoch: 1][iter: 35] AFTER HANDLE:
tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:3')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:2')
[rank: 14][epoch: 1][iter: 35] AFTER HANDLE:

[rank: 0][epoch: 1][iter: 35] AFTER HANDLE:

[rank: 16][epoch: 1][iter: 35] AFTER HANDLE:

[rank: 20][epoch: 1][iter: 35] AFTER HANDLE:
tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:2')
[rank: 8][epoch: 1][iter: 35] NEW GRAD:
tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:0')
[rank: 2][epoch: 1][iter: 35] AFTER HANDLE:

[rank: 19][epoch: 1][iter: 35] NEW GRAD:

[rank: 21][epoch: 1][iter: 35] NEW GRAD:

[rank: 4][epoch: 1][iter: 35] AFTER HANDLE:

[rank: 9][epoch: 1][iter: 35] NEW GRAD:

[rank: 13][epoch: 1][iter: 35] NEW GRAD:

[rank: 3][epoch: 1][iter: 35] NEW GRAD:

[rank: 17][epoch: 1][iter: 35] NEW GRAD:

[rank: 23][epoch: 1][iter: 35] NEW GRAD:

[rank: 5][epoch: 1][iter: 35] NEW GRAD:

[rank: 11][epoch: 1][iter: 35] NEW GRAD:

[rank: 15][epoch: 1][iter: 35] NEW GRAD:

[rank: 1][epoch: 1][iter: 35] NEW GRAD:

[rank: 18][epoch: 1][iter: 35] NEW GRAD:
tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:2')
[rank: 7][epoch: 1][iter: 35] NEW GRAD:

[rank: 10][epoch: 1][iter: 35] NEW GRAD:
tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:2')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:0')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:0')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:0')
[rank: 6][epoch: 1][iter: 35] NEW GRAD:
tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:0')
[rank: 12][epoch: 1][iter: 35] NEW GRAD:
tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:2')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:3')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:1')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:0')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:1')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:1')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:3')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:1')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:3')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:1')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:3')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:3')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:1')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:2')
[rank: 22][epoch: 1][iter: 35] NEW GRAD:
tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:3')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:2')
[rank: 14][epoch: 1][iter: 35] NEW GRAD:

[rank: 0][epoch: 1][iter: 35] NEW GRAD:

[rank: 16][epoch: 1][iter: 35] NEW GRAD:

[rank: 20][epoch: 1][iter: 35] NEW GRAD:
tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:2')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:0')
[rank: 2][epoch: 1][iter: 35] NEW GRAD:
tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:0')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:2')
[rank: 4][epoch: 1][iter: 35] NEW GRAD:
tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:2')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:0')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:0')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:0')tensor([-8.8569e-04, -1.0863e-03,  2.6785e-04,  ..., -8.8520e-05,
         1.7395e-04,  1.2553e-04], device='cuda:2')
[rank: 8][epoch: 1][iter: 36] BEFORE:

[rank: 19][epoch: 1][iter: 36] BEFORE:
tensor([ 1.1088e-04, -6.2966e-05,  1.6543e-04,  ...,  7.1968e-02,
        -3.5772e-03,  7.0489e-02], device='cuda:0')tensor([ 1.4699e-04,  1.3239e-04, -1.2871e-04,  ...,  1.0134e-04,
         3.8908e-06,  1.1839e-04], device='cuda:3')
[rank: 13][epoch: 1][iter: 36] BEFORE:

[rank: 3][epoch: 1][iter: 36] BEFORE:

[rank: 9][epoch: 1][iter: 36] BEFORE:
tensor([ 0.0004, -0.0103, -0.0012,  ..., -0.0048, -0.0040, -0.0023],
       device='cuda:1')
[rank: 21][epoch: 1][iter: 36] BEFORE:
tensor([-1.8541e-03, -9.0868e-05, -2.1483e-04,  ..., -1.9353e-04,
        -1.1586e-04, -1.3556e-04], device='cuda:3')
[rank: 17][epoch: 1][iter: 36] BEFORE:
tensor([-2.2365e-05,  1.7092e-04, -4.0527e-06,  ..., -1.1826e-04,
        -4.1207e-04, -3.9531e-04], device='cuda:1')
[rank: 5][epoch: 1][iter: 36] BEFORE:
tensor([-0.0029,  0.0003, -0.0042,  ..., -0.0019,  0.0011, -0.0012],
       device='cuda:1')
[rank: 15][epoch: 1][iter: 36] BEFORE:

[rank: 1][epoch: 1][iter: 36] BEFORE:

[rank: 11][epoch: 1][iter: 36] BEFORE:

[rank: 23][epoch: 1][iter: 36] BEFORE:
tensor([-2.8434e-04,  9.5612e-05, -1.2215e-03,  ..., -6.5342e-04,
         1.8178e-03,  2.0066e-03], device='cuda:1')
[rank: 18][epoch: 1][iter: 36] BEFORE:
tensor([ 0.0006, -0.0008, -0.0003,  ...,  0.0002,  0.0003,  0.0002],
       device='cuda:3')tensor([ 0.0004,  0.0004, -0.0003,  ..., -0.0001, -0.0002, -0.0005],
       device='cuda:1')
[rank: 10][epoch: 1][iter: 36] BEFORE:
tensor([5.1981e-05, 1.0531e-04, 1.0928e-03,  ..., 8.5232e-05, 9.7988e-04,
        7.8155e-05], device='cuda:3')
[rank: 7][epoch: 1][iter: 36] BEFORE:
tensor([-5.4635e-06, -7.3397e-06, -1.6721e-05,  ..., -1.0384e-04,
         1.0500e-04,  7.7559e-05], device='cuda:2')tensor([ 0.0003, -0.0003,  0.0003,  ..., -0.0004, -0.0009,  0.0023],
       device='cuda:3')
[rank: 6][epoch: 1][iter: 36] BEFORE:

[rank: 16][epoch: 1][iter: 36] BEFORE:

[rank: 12][epoch: 1][iter: 36] BEFORE:
tensor([-2.0598e-04,  4.6080e-05, -3.0247e-05,  ..., -1.3751e-04,
         1.2478e-05, -1.9872e-04], device='cuda:2')tensor([ 8.5269e-04, -1.6882e-04, -7.4368e-05,  ..., -6.9056e-05,
         1.4090e-05, -7.1549e-05], device='cuda:3')
[rank: 22][epoch: 1][iter: 36] BEFORE:
tensor([-3.9792e-05,  8.4022e-05, -4.8555e-05,  ..., -1.7348e-04,
         1.3233e-04,  2.2311e-04], device='cuda:0')
[rank: 14][epoch: 1][iter: 36] BEFORE:

[rank: 0][epoch: 1][iter: 36] BEFORE:
tensor([-8.8704e-05, -1.8908e-04, -3.5590e-04,  ...,  4.9633e-05,
        -7.3126e-05,  9.0267e-05], device='cuda:2')
[rank: 20][epoch: 1][iter: 36] BEFORE:
tensor([3.9116e-05, 9.9350e-05, 1.5813e-05,  ..., 4.9119e-05, 6.0494e-05,
        5.5571e-05], device='cuda:0')
[rank: 4][epoch: 1][iter: 36] BEFORE:
tensor([-7.9210e-05, -2.3105e-05,  5.0770e-05,  ..., -3.8232e-04,
        -4.5054e-04, -3.7260e-04], device='cuda:0')tensor([-2.6303e-05, -2.3205e-05, -5.9347e-05,  ..., -3.9010e-04,
        -3.4865e-04, -2.9793e-04], device='cuda:2')tensor([-1.0661e-04, -1.3857e-04, -7.7987e-05,  ..., -3.9679e-04,
        -1.2186e-04,  6.6453e-05], device='cuda:2')tensor([ 1.0588e-03,  1.7292e-03,  1.2154e-03,  ...,  2.5977e-04,
        -2.7813e-04,  9.1209e-05], device='cuda:0')tensor([ 2.4848e-04, -4.5703e-05,  3.9031e-04,  ..., -1.1547e-03,
        -2.2986e-03, -3.0915e-03], device='cuda:0')
[rank: 2][epoch: 1][iter: 36] BEFORE:

[rank: 16][epoch: 1][iter: 36] AFTER HANDLE:

[rank: 8][epoch: 1][iter: 36] AFTER HANDLE:

[rank: 4][epoch: 1][iter: 36] AFTER HANDLE:

[rank: 13][epoch: 1][iter: 36] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 36] AFTER HANDLE:

[rank: 0][epoch: 1][iter: 36] AFTER HANDLE:

[rank: 18][epoch: 1][iter: 36] AFTER HANDLE:

[rank: 10][epoch: 1][iter: 36] AFTER HANDLE:

[rank: 5][epoch: 1][iter: 36] AFTER HANDLE:

[rank: 14][epoch: 1][iter: 36] AFTER HANDLE:

[rank: 20][epoch: 1][iter: 36] AFTER HANDLE:

[rank: 3][epoch: 1][iter: 36] AFTER HANDLE:

[rank: 19][epoch: 1][iter: 36] AFTER HANDLE:

[rank: 9][epoch: 1][iter: 36] AFTER HANDLE:

[rank: 6][epoch: 1][iter: 36] AFTER HANDLE:

[rank: 12][epoch: 1][iter: 36] AFTER HANDLE:

[rank: 23][epoch: 1][iter: 36] AFTER HANDLE:

[rank: 1][epoch: 1][iter: 36] AFTER HANDLE:
tensor([0.0001, 0.0003, 0.0002,  ..., 0.0011, 0.0005, 0.0012], device='cuda:1')
[rank: 17][epoch: 1][iter: 36] AFTER HANDLE:

[rank: 11][epoch: 1][iter: 36] AFTER HANDLE:

[rank: 7][epoch: 1][iter: 36] AFTER HANDLE:

[rank: 15][epoch: 1][iter: 36] AFTER HANDLE:

[rank: 22][epoch: 1][iter: 36] AFTER HANDLE:
tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:2')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:0')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:0')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:0')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:1')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:1')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:0')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:2')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:2')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:1')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:2')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:0')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:3')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:3')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:1')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:2')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:0')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:3')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:1')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:1')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:3')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:3')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:3')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:2')
[rank: 2][epoch: 1][iter: 36] AFTER HANDLE:

[rank: 16][epoch: 1][iter: 36] NEW GRAD:

[rank: 8][epoch: 1][iter: 36] NEW GRAD:

[rank: 4][epoch: 1][iter: 36] NEW GRAD:

[rank: 13][epoch: 1][iter: 36] NEW GRAD:

[rank: 21][epoch: 1][iter: 36] NEW GRAD:

[rank: 0][epoch: 1][iter: 36] NEW GRAD:

[rank: 18][epoch: 1][iter: 36] NEW GRAD:

[rank: 10][epoch: 1][iter: 36] NEW GRAD:

[rank: 5][epoch: 1][iter: 36] NEW GRAD:

[rank: 14][epoch: 1][iter: 36] NEW GRAD:

[rank: 20][epoch: 1][iter: 36] NEW GRAD:

[rank: 3][epoch: 1][iter: 36] NEW GRAD:

[rank: 19][epoch: 1][iter: 36] NEW GRAD:

[rank: 9][epoch: 1][iter: 36] NEW GRAD:

[rank: 6][epoch: 1][iter: 36] NEW GRAD:

[rank: 12][epoch: 1][iter: 36] NEW GRAD:

[rank: 23][epoch: 1][iter: 36] NEW GRAD:

[rank: 1][epoch: 1][iter: 36] NEW GRAD:

[rank: 17][epoch: 1][iter: 36] NEW GRAD:

[rank: 11][epoch: 1][iter: 36] NEW GRAD:

[rank: 7][epoch: 1][iter: 36] NEW GRAD:

[rank: 15][epoch: 1][iter: 36] NEW GRAD:

[rank: 22][epoch: 1][iter: 36] NEW GRAD:
tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:2')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:0')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:0')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:0')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:1')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:1')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:0')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:2')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:2')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:1')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:2')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:0')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:3')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:3')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:1')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:2')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:0')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:3')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:1')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:1')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:3')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:3')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:3')tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:2')
[rank: 2][epoch: 1][iter: 36] NEW GRAD:
tensor([-4.7999e-05, -3.6324e-04, -2.0378e-04,  ...,  2.6121e-03,
        -3.1504e-04,  2.8558e-03], device='cuda:2')
[rank: 4][epoch: 1][iter: 37] BEFORE:

[rank: 8][epoch: 1][iter: 37] BEFORE:

[rank: 13][epoch: 1][iter: 37] BEFORE:
tensor([-2.0296e-04,  4.6957e-04, -1.2908e-04,  ..., -4.5162e-05,
        -1.2373e-04,  1.1332e-04], device='cuda:0')tensor([-0.0063,  0.0340, -0.0054,  ..., -0.0014,  0.0026,  0.0032],
       device='cuda:0')tensor([ 0.0012, -0.0021,  0.0034,  ..., -0.0003,  0.0005,  0.0004],
       device='cuda:1')
[rank: 0][epoch: 1][iter: 37] BEFORE:

[rank: 5][epoch: 1][iter: 37] BEFORE:

[rank: 18][epoch: 1][iter: 37] BEFORE:
tensor([-4.8316e-04,  1.1030e-04, -3.8150e-04,  ..., -7.3274e-05,
         2.0704e-04,  1.0635e-04], device='cuda:0')
[rank: 21][epoch: 1][iter: 37] BEFORE:
tensor([ 2.3889e-03,  3.9412e-03,  4.1876e-03,  ..., -1.8534e-05,
         6.1341e-05, -9.2510e-06], device='cuda:1')
[rank: 10][epoch: 1][iter: 37] BEFORE:
tensor([ 1.2089e-04, -4.0607e-05, -2.7579e-04,  ..., -3.7776e-05,
        -3.2364e-04,  3.5065e-05], device='cuda:2')
[rank: 14][epoch: 1][iter: 37] BEFORE:
tensor([-1.5182e-03, -1.0161e-03, -3.9572e-04,  ...,  1.1621e-04,
         1.9173e-05, -4.7265e-05], device='cuda:1')
[rank: 16][epoch: 1][iter: 37] BEFORE:
tensor([ 8.8674e-04,  3.5397e-04,  8.9971e-04,  ...,  2.6169e-05,
        -8.3760e-05, -3.2103e-05], device='cuda:2')
[rank: 6][epoch: 1][iter: 37] BEFORE:

[rank: 20][epoch: 1][iter: 37] BEFORE:
tensor([ 1.9606e-04,  3.5007e-04, -1.1884e-04,  ...,  5.0023e-03,
        -2.1201e-04, -3.4180e-05], device='cuda:2')
[rank: 1][epoch: 1][iter: 37] BEFORE:

[rank: 19][epoch: 1][iter: 37] BEFORE:

[rank: 9][epoch: 1][iter: 37] BEFORE:
tensor([ 0.0018,  0.0011,  0.0009,  ...,  0.0003, -0.0002, -0.0005],
       device='cuda:2')
[rank: 12][epoch: 1][iter: 37] BEFORE:
tensor([-6.6778e-04,  8.9248e-04, -6.1451e-04,  ..., -5.6215e-05,
         8.8170e-05, -6.2840e-04], device='cuda:0')tensor([5.2485e-05, 1.3205e-04, 4.7521e-05,  ..., 6.1338e-05, 1.7898e-05,
        3.4469e-05], device='cuda:1')tensor([-0.0001, -0.0001, -0.0003,  ...,  0.0003,  0.0004,  0.0003],
       device='cuda:0')
[rank: 11][epoch: 1][iter: 37] BEFORE:

[rank: 7][epoch: 1][iter: 37] BEFORE:

[rank: 15][epoch: 1][iter: 37] BEFORE:

[rank: 23][epoch: 1][iter: 37] BEFORE:

[rank: 3][epoch: 1][iter: 37] BEFORE:

[rank: 17][epoch: 1][iter: 37] BEFORE:
tensor([ 3.0301e-04, -1.7592e-05, -2.7261e-05,  ..., -2.5570e-04,
         9.0814e-05,  4.1767e-05], device='cuda:3')tensor([-1.1573e-04, -1.0716e-04, -2.2035e-05,  ...,  3.0708e-02,
         1.3704e-03,  1.9466e-03], device='cuda:3')tensor([-0.0010, -0.0004, -0.0003,  ...,  0.0009, -0.0003,  0.0010],
       device='cuda:0')
[rank: 22][epoch: 1][iter: 37] BEFORE:

[rank: 2][epoch: 1][iter: 37] BEFORE:
tensor([-7.0081e-05,  1.1473e-04,  5.2312e-05,  ..., -1.2617e-04,
        -2.4792e-04,  5.8380e-05], device='cuda:3')
[rank: 8][epoch: 1][iter: 37] AFTER HANDLE:

[rank: 5][epoch: 1][iter: 37] AFTER HANDLE:

[rank: 13][epoch: 1][iter: 37] AFTER HANDLE:

[rank: 20][epoch: 1][iter: 37] AFTER HANDLE:

[rank: 0][epoch: 1][iter: 37] AFTER HANDLE:

[rank: 16][epoch: 1][iter: 37] AFTER HANDLE:

[rank: 10][epoch: 1][iter: 37] AFTER HANDLE:

[rank: 4][epoch: 1][iter: 37] AFTER HANDLE:

[rank: 14][epoch: 1][iter: 37] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 37] AFTER HANDLE:

[rank: 1][epoch: 1][iter: 37] AFTER HANDLE:

[rank: 18][epoch: 1][iter: 37] AFTER HANDLE:
tensor([0.0002, 0.0003, 0.0002,  ..., 0.0002, 0.0004, 0.0002], device='cuda:1')
[rank: 9][epoch: 1][iter: 37] AFTER HANDLE:

[rank: 6][epoch: 1][iter: 37] AFTER HANDLE:
tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:3')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:3')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:3')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:1')
[rank: 11][epoch: 1][iter: 37] AFTER HANDLE:

[rank: 7][epoch: 1][iter: 37] AFTER HANDLE:

[rank: 12][epoch: 1][iter: 37] AFTER HANDLE:
tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:2')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:2')
[rank: 19][epoch: 1][iter: 37] AFTER HANDLE:
tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:0')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:1')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:1')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:0')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:0')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:0')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:2')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:0')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:2')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:1')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:1')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:2')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:1')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:2')
[rank: 15][epoch: 1][iter: 37] AFTER HANDLE:

[rank: 23][epoch: 1][iter: 37] AFTER HANDLE:

[rank: 3][epoch: 1][iter: 37] AFTER HANDLE:

[rank: 17][epoch: 1][iter: 37] AFTER HANDLE:
tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:3')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:3')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:0')
[rank: 22][epoch: 1][iter: 37] AFTER HANDLE:

[rank: 2][epoch: 1][iter: 37] AFTER HANDLE:
tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:3')
[rank: 8][epoch: 1][iter: 37] NEW GRAD:

[rank: 5][epoch: 1][iter: 37] NEW GRAD:

[rank: 13][epoch: 1][iter: 37] NEW GRAD:

[rank: 20][epoch: 1][iter: 37] NEW GRAD:

[rank: 0][epoch: 1][iter: 37] NEW GRAD:

[rank: 16][epoch: 1][iter: 37] NEW GRAD:

[rank: 10][epoch: 1][iter: 37] NEW GRAD:

[rank: 4][epoch: 1][iter: 37] NEW GRAD:

[rank: 14][epoch: 1][iter: 37] NEW GRAD:

[rank: 21][epoch: 1][iter: 37] NEW GRAD:

[rank: 1][epoch: 1][iter: 37] NEW GRAD:

[rank: 18][epoch: 1][iter: 37] NEW GRAD:

[rank: 9][epoch: 1][iter: 37] NEW GRAD:

[rank: 6][epoch: 1][iter: 37] NEW GRAD:
tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:3')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:3')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:3')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:1')
[rank: 11][epoch: 1][iter: 37] NEW GRAD:

[rank: 7][epoch: 1][iter: 37] NEW GRAD:

[rank: 12][epoch: 1][iter: 37] NEW GRAD:
tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:2')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:2')
[rank: 19][epoch: 1][iter: 37] NEW GRAD:
tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:0')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:1')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:1')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:0')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:0')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:0')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:2')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:0')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:2')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:1')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:1')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:2')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:1')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:2')
[rank: 15][epoch: 1][iter: 37] NEW GRAD:

[rank: 23][epoch: 1][iter: 37] NEW GRAD:

[rank: 3][epoch: 1][iter: 37] NEW GRAD:

[rank: 17][epoch: 1][iter: 37] NEW GRAD:
tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:3')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:3')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:0')
[rank: 22][epoch: 1][iter: 37] NEW GRAD:

[rank: 2][epoch: 1][iter: 37] NEW GRAD:
tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:3')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:3')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:3')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:3')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:1')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:2')tensor([-1.8377e-05,  1.5575e-03,  2.5801e-04,  ...,  1.2795e-03,
         5.7098e-05,  8.1109e-05], device='cuda:2')
[rank: 8][epoch: 1][iter: 38] BEFORE:

[rank: 13][epoch: 1][iter: 38] BEFORE:
tensor([-4.1446e-04, -2.9313e-03,  5.0265e-04,  ...,  2.1666e-06,
        -1.0335e-05,  3.4126e-05], device='cuda:0')tensor([-9.7029e-06,  8.4493e-05,  2.9270e-04,  ...,  4.2499e-04,
         1.4035e-04,  2.4719e-05], device='cuda:1')
[rank: 20][epoch: 1][iter: 38] BEFORE:

[rank: 0][epoch: 1][iter: 38] BEFORE:

[rank: 5][epoch: 1][iter: 38] BEFORE:
tensor([ 7.8841e-06,  1.3984e-05, -3.3014e-06,  ...,  6.4959e-04,
         3.9311e-04,  1.0293e-04], device='cuda:0')
[rank: 16][epoch: 1][iter: 38] BEFORE:
tensor([-2.3912e-05, -4.1772e-05,  1.1072e-05,  ..., -6.3352e-05,
         6.9622e-04, -6.0831e-04], device='cuda:0')
[rank: 10][epoch: 1][iter: 38] BEFORE:
tensor([-3.5777e-04,  8.2862e-05, -2.0023e-04,  ..., -1.6265e-04,
         9.9540e-05, -1.7667e-04], device='cuda:1')tensor([-0.0032, -0.0027, -0.0010,  ..., -0.0003, -0.0008, -0.0006],
       device='cuda:0')
[rank: 1][epoch: 1][iter: 38] BEFORE:
tensor([-6.8575e-04,  3.4361e-05,  3.8004e-05,  ...,  4.2655e-04,
         1.7320e-04,  3.3282e-04], device='cuda:2')
[rank: 14][epoch: 1][iter: 38] BEFORE:

[rank: 18][epoch: 1][iter: 38] BEFORE:
tensor([ 1.0232e-04, -4.0278e-05,  1.2684e-05,  ..., -1.2276e-04,
        -1.8973e-04, -1.2257e-04], device='cuda:1')
[rank: 6][epoch: 1][iter: 38] BEFORE:

[rank: 21][epoch: 1][iter: 38] BEFORE:
tensor([-0.0014,  0.0072,  0.0037,  ...,  0.0008, -0.0002,  0.0014],
       device='cuda:2')
[rank: 9][epoch: 1][iter: 38] BEFORE:
tensor([ 7.4421e-05, -4.6243e-05, -3.8556e-04,  ..., -1.0839e-04,
         4.7371e-05,  2.4243e-04], device='cuda:2')tensor([ 0.0002,  0.0016, -0.0004,  ..., -0.0003, -0.0004,  0.0005],
       device='cuda:2')tensor([ 3.2120e-04,  3.0081e-05, -7.4814e-05,  ..., -4.9536e-05,
         1.3074e-05,  8.3185e-05], device='cuda:1')
[rank: 11][epoch: 1][iter: 38] BEFORE:

[rank: 19][epoch: 1][iter: 38] BEFORE:

[rank: 7][epoch: 1][iter: 38] BEFORE:
tensor([ 2.7500e-04, -7.3445e-05, -2.3569e-04,  ..., -2.2383e-03,
        -3.0986e-04,  2.4584e-04], device='cuda:1')
[rank: 3][epoch: 1][iter: 38] BEFORE:

[rank: 4][epoch: 1][iter: 38] BEFORE:
tensor([-8.6329e-05,  7.4243e-05, -3.6680e-04,  ..., -8.7355e-04,
        -1.5725e-04, -1.8713e-04], device='cuda:3')tensor([-9.2582e-06, -1.4151e-05, -2.1730e-05,  ..., -9.7953e-05,
        -1.4991e-03,  3.9166e-05], device='cuda:3')
[rank: 23][epoch: 1][iter: 38] BEFORE:
tensor([ 0.0020, -0.0003,  0.0017,  ..., -0.0001,  0.0003,  0.0005],
       device='cuda:3')tensor([-1.4580e-05, -1.0433e-04, -8.6492e-05,  ..., -9.8122e-05,
         2.9605e-04, -5.5392e-06], device='cuda:3')
[rank: 17][epoch: 1][iter: 38] BEFORE:

[rank: 12][epoch: 1][iter: 38] BEFORE:

[rank: 22][epoch: 1][iter: 38] BEFORE:
tensor([ 3.6005e-05,  1.4950e-04,  1.5122e-04,  ..., -1.2743e-04,
         5.5506e-04,  2.0606e-04], device='cuda:0')tensor([ 0.0009,  0.0003,  0.0002,  ..., -0.0005, -0.0002, -0.0006],
       device='cuda:1')tensor([-7.2905e-03, -6.9931e-03,  1.5451e-01,  ..., -2.1351e-04,
        -6.0123e-05, -6.8581e-04], device='cuda:3')tensor([-3.8991e-04,  1.7829e-04,  2.7151e-04,  ...,  1.9994e-04,
         1.1703e-03,  2.7065e-05], device='cuda:0')
[rank: 15][epoch: 1][iter: 38] BEFORE:

[rank: 2][epoch: 1][iter: 38] BEFORE:

[rank: 0][epoch: 1][iter: 38] AFTER HANDLE:

[rank: 1][epoch: 1][iter: 38] AFTER HANDLE:

[rank: 3][epoch: 1][iter: 38] AFTER HANDLE:
tensor([ 0.0004,  0.0003, -0.0002,  ..., -0.0003, -0.0005, -0.0001],
       device='cuda:3')
[rank: 16][epoch: 1][iter: 38] AFTER HANDLE:

[rank: 8][epoch: 1][iter: 38] AFTER HANDLE:

[rank: 20][epoch: 1][iter: 38] AFTER HANDLE:

[rank: 4][epoch: 1][iter: 38] AFTER HANDLE:
tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:2')
[rank: 12][epoch: 1][iter: 38] AFTER HANDLE:

[rank: 18][epoch: 1][iter: 38] AFTER HANDLE:

[rank: 11][epoch: 1][iter: 38] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 38] AFTER HANDLE:

[rank: 7][epoch: 1][iter: 38] AFTER HANDLE:
tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:1')
[rank: 13][epoch: 1][iter: 38] AFTER HANDLE:

[rank: 17][epoch: 1][iter: 38] AFTER HANDLE:

[rank: 9][epoch: 1][iter: 38] AFTER HANDLE:

[rank: 23][epoch: 1][iter: 38] AFTER HANDLE:

[rank: 5][epoch: 1][iter: 38] AFTER HANDLE:
tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:3')
[rank: 14][epoch: 1][iter: 38] AFTER HANDLE:

[rank: 19][epoch: 1][iter: 38] AFTER HANDLE:

[rank: 10][epoch: 1][iter: 38] AFTER HANDLE:
tensor([0.0015, 0.0018, 0.0014,  ..., 0.0019, 0.0010, 0.0014], device='cuda:2')
[rank: 22][epoch: 1][iter: 38] AFTER HANDLE:

[rank: 6][epoch: 1][iter: 38] AFTER HANDLE:
tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:0')
[rank: 15][epoch: 1][iter: 38] AFTER HANDLE:
tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:0')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:0')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:0')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:0')
[rank: 2][epoch: 1][iter: 38] AFTER HANDLE:
tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:0')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:2')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:3')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:1')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:3')
[rank: 1][epoch: 1][iter: 38] NEW GRAD:
tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:1')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:1')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:1')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:3')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:1')
[rank: 3][epoch: 1][iter: 38] NEW GRAD:
tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:2')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:3')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:2')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:2')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:2')
[rank: 0][epoch: 1][iter: 38] NEW GRAD:
tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:3')
[rank: 16][epoch: 1][iter: 38] NEW GRAD:

[rank: 8][epoch: 1][iter: 38] NEW GRAD:

[rank: 20][epoch: 1][iter: 38] NEW GRAD:

[rank: 4][epoch: 1][iter: 38] NEW GRAD:
tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:2')
[rank: 12][epoch: 1][iter: 38] NEW GRAD:

[rank: 18][epoch: 1][iter: 38] NEW GRAD:

[rank: 11][epoch: 1][iter: 38] NEW GRAD:

[rank: 21][epoch: 1][iter: 38] NEW GRAD:

[rank: 7][epoch: 1][iter: 38] NEW GRAD:
tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:1')
[rank: 13][epoch: 1][iter: 38] NEW GRAD:

[rank: 17][epoch: 1][iter: 38] NEW GRAD:

[rank: 9][epoch: 1][iter: 38] NEW GRAD:

[rank: 23][epoch: 1][iter: 38] NEW GRAD:

[rank: 5][epoch: 1][iter: 38] NEW GRAD:
tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:3')
[rank: 14][epoch: 1][iter: 38] NEW GRAD:

[rank: 19][epoch: 1][iter: 38] NEW GRAD:

[rank: 10][epoch: 1][iter: 38] NEW GRAD:

[rank: 22][epoch: 1][iter: 38] NEW GRAD:

[rank: 6][epoch: 1][iter: 38] NEW GRAD:
tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:0')
[rank: 15][epoch: 1][iter: 38] NEW GRAD:
tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:0')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:0')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:0')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:0')
[rank: 2][epoch: 1][iter: 38] NEW GRAD:
tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:0')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:2')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:3')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:1')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:3')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:1')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:2')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:1')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:1')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:3')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:1')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:2')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:3')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:2')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:2')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:2')tensor([-3.3689e-04, -5.5804e-05,  6.6586e-03,  ..., -6.1541e-05,
         2.6667e-05,  8.5318e-05], device='cuda:3')
[rank: 1][epoch: 1][iter: 39] BEFORE:
tensor([ 4.9093e-05,  1.4226e-05,  1.6271e-04,  ..., -1.9372e-04,
        -2.5205e-04, -1.7194e-04], device='cuda:1')
[rank: 3][epoch: 1][iter: 39] BEFORE:
tensor([-2.4520e-04, -2.4959e-04, -2.5429e-04,  ..., -2.1666e-04,
        -7.6594e-05, -2.7908e-04], device='cuda:3')
[rank: 0][epoch: 1][iter: 39] BEFORE:
tensor([ 0.0002, -0.0003, -0.0002,  ..., -0.0001,  0.0003,  0.0002],
       device='cuda:0')
[rank: 8][epoch: 1][iter: 39] BEFORE:
tensor([ 1.0924e-04, -3.8638e-05,  4.1498e-05,  ...,  1.1208e-03,
         8.5716e-04,  8.9659e-04], device='cuda:0')
[rank: 20][epoch: 1][iter: 39] BEFORE:

[rank: 11][epoch: 1][iter: 39] BEFORE:
tensor([ 0.0001,  0.0002, -0.0002,  ..., -0.0001, -0.0001, -0.0001],
       device='cuda:0')
[rank: 4][epoch: 1][iter: 39] BEFORE:

[rank: 18][epoch: 1][iter: 39] BEFORE:
tensor([-4.3760e-04,  1.9318e-03, -7.9488e-04,  ..., -1.8645e-05,
         1.6378e-04, -6.2664e-06], device='cuda:3')
[rank: 13][epoch: 1][iter: 39] BEFORE:

[rank: 7][epoch: 1][iter: 39] BEFORE:

[rank: 16][epoch: 1][iter: 39] BEFORE:

[rank: 2][epoch: 1][iter: 39] BEFORE:
tensor([ 0.0002,  0.0002,  0.0001,  ...,  0.0013, -0.0008,  0.0012],
       device='cuda:1')tensor([-3.0871e-05, -1.7966e-04,  2.4777e-04,  ...,  1.3638e-04,
        -8.4404e-07, -2.0402e-04], device='cuda:0')tensor([ 2.8211e-05,  2.5378e-04, -1.8921e-04,  ...,  1.8861e-04,
         2.7130e-04, -2.7517e-05], device='cuda:2')
[rank: 21][epoch: 1][iter: 39] BEFORE:

[rank: 12][epoch: 1][iter: 39] BEFORE:
tensor([ 1.6873e-06,  1.5282e-06,  5.5031e-05,  ...,  6.1495e-04,
         1.0606e-04, -8.0387e-05], device='cuda:2')tensor([ 6.2998e-05, -1.2489e-04,  1.5428e-05,  ..., -9.1352e-04,
        -1.3340e-03,  4.9441e-04], device='cuda:3')
[rank: 17][epoch: 1][iter: 39] BEFORE:

[rank: 9][epoch: 1][iter: 39] BEFORE:
tensor([-9.0859e-05, -7.8878e-05, -1.7993e-04,  ..., -1.3663e-03,
        -2.6888e-04, -4.9966e-04], device='cuda:1')
[rank: 14][epoch: 1][iter: 39] BEFORE:

[rank: 5][epoch: 1][iter: 39] BEFORE:
tensor([ 0.0794,  0.0745, -0.0082,  ..., -0.0003,  0.0012, -0.0005],
       device='cuda:0')
[rank: 10][epoch: 1][iter: 39] BEFORE:

[rank: 23][epoch: 1][iter: 39] BEFORE:
tensor([-1.3344e-04, -3.6045e-05, -9.7895e-05,  ...,  1.1373e-03,
        -2.9502e-04, -2.0236e-03], device='cuda:0')
[rank: 6][epoch: 1][iter: 39] BEFORE:

[rank: 1][epoch: 1][iter: 39] AFTER HANDLE:

[rank: 19][epoch: 1][iter: 39] BEFORE:
tensor([-8.3809e-05, -4.4922e-03, -3.6059e-03,  ...,  3.0469e-04,
        -2.6048e-04,  3.8645e-05], device='cuda:1')
[rank: 22][epoch: 1][iter: 39] BEFORE:

[rank: 15][epoch: 1][iter: 39] BEFORE:

[rank: 4][epoch: 1][iter: 39] AFTER HANDLE:

[rank: 3][epoch: 1][iter: 39] AFTER HANDLE:
tensor([-0.0025, -0.0009, -0.0006,  ..., -0.0022,  0.0004,  0.0058],
       device='cuda:1')
[rank: 8][epoch: 1][iter: 39] AFTER HANDLE:

[rank: 20][epoch: 1][iter: 39] AFTER HANDLE:
tensor([ 0.0009, -0.0006, -0.0004,  ..., -0.0006, -0.0005, -0.0005],
       device='cuda:2')
[rank: 7][epoch: 1][iter: 39] AFTER HANDLE:

[rank: 2][epoch: 1][iter: 39] AFTER HANDLE:

[rank: 18][epoch: 1][iter: 39] AFTER HANDLE:

[rank: 11][epoch: 1][iter: 39] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 39] AFTER HANDLE:

[rank: 13][epoch: 1][iter: 39] AFTER HANDLE:
tensor([ 0.0837,  0.0710, -0.0148,  ..., -0.0000, -0.0001,  0.0001],
       device='cuda:1')
[rank: 0][epoch: 1][iter: 39] AFTER HANDLE:

[rank: 16][epoch: 1][iter: 39] AFTER HANDLE:
tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:2')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:3')
[rank: 12][epoch: 1][iter: 39] AFTER HANDLE:
tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:2')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:1')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:3')
[rank: 9][epoch: 1][iter: 39] AFTER HANDLE:
tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:2')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:3')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:0')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:3')
[rank: 17][epoch: 1][iter: 39] AFTER HANDLE:
tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:0')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:0')
[rank: 14][epoch: 1][iter: 39] AFTER HANDLE:
tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:3')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:2')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:2')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:3')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:1')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:1')
[rank: 5][epoch: 1][iter: 39] AFTER HANDLE:
tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:0')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:0')
[rank: 10][epoch: 1][iter: 39] AFTER HANDLE:

[rank: 23][epoch: 1][iter: 39] AFTER HANDLE:
tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:0')
[rank: 6][epoch: 1][iter: 39] AFTER HANDLE:

[rank: 1][epoch: 1][iter: 39] NEW GRAD:

[rank: 19][epoch: 1][iter: 39] AFTER HANDLE:
tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:1')
[rank: 22][epoch: 1][iter: 39] AFTER HANDLE:

[rank: 15][epoch: 1][iter: 39] AFTER HANDLE:

[rank: 4][epoch: 1][iter: 39] NEW GRAD:

[rank: 3][epoch: 1][iter: 39] NEW GRAD:
tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:1')
[rank: 8][epoch: 1][iter: 39] NEW GRAD:

[rank: 20][epoch: 1][iter: 39] NEW GRAD:
tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:2')
[rank: 7][epoch: 1][iter: 39] NEW GRAD:

[rank: 2][epoch: 1][iter: 39] NEW GRAD:

[rank: 18][epoch: 1][iter: 39] NEW GRAD:

[rank: 11][epoch: 1][iter: 39] NEW GRAD:

[rank: 21][epoch: 1][iter: 39] NEW GRAD:

[rank: 13][epoch: 1][iter: 39] NEW GRAD:
tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:1')
[rank: 0][epoch: 1][iter: 39] NEW GRAD:

[rank: 16][epoch: 1][iter: 39] NEW GRAD:
tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:2')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:3')
[rank: 12][epoch: 1][iter: 39] NEW GRAD:
tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:2')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:1')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:3')
[rank: 9][epoch: 1][iter: 39] NEW GRAD:
tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:2')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:3')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:0')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:3')
[rank: 17][epoch: 1][iter: 39] NEW GRAD:
tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:0')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:0')
[rank: 14][epoch: 1][iter: 39] NEW GRAD:
tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:3')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:2')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:2')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:3')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:1')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:1')
[rank: 5][epoch: 1][iter: 39] NEW GRAD:
tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:0')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:0')
[rank: 10][epoch: 1][iter: 39] NEW GRAD:

[rank: 23][epoch: 1][iter: 39] NEW GRAD:
tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:0')
[rank: 6][epoch: 1][iter: 39] NEW GRAD:

[rank: 19][epoch: 1][iter: 39] NEW GRAD:
tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:1')
[rank: 22][epoch: 1][iter: 39] NEW GRAD:

[rank: 15][epoch: 1][iter: 39] NEW GRAD:
tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:1')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:1')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:2')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:3')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:2')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:2')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:3')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:2')tensor([ 3.4888e-03,  2.9571e-03, -6.1867e-04,  ..., -4.8010e-05,
        -8.1996e-05,  6.7496e-05], device='cuda:3')
[rank: 1][epoch: 1][iter: 40] BEFORE:
tensor([ 6.4482e-05,  1.1035e-04,  9.0842e-05,  ...,  1.0198e-03,
         8.8556e-04, -2.4962e-04], device='cuda:1')
[rank: 3][epoch: 1][iter: 40] BEFORE:
tensor([ 9.1071e-05,  3.5036e-04, -1.4250e-04,  ...,  4.0383e-05,
        -5.5738e-04,  5.0750e-05], device='cuda:3')
[rank: 4][epoch: 1][iter: 40] BEFORE:

[rank: 8][epoch: 1][iter: 40] BEFORE:
tensor([-7.7936e-05,  9.9383e-05,  1.9903e-04,  ...,  1.6923e-04,
        -1.2242e-04, -6.7307e-04], device='cuda:0')tensor([ 0.0005,  0.0007,  0.0005,  ...,  0.0003, -0.0002,  0.0002],
       device='cuda:0')
[rank: 7][epoch: 1][iter: 40] BEFORE:

[rank: 20][epoch: 1][iter: 40] BEFORE:
tensor([ 6.7252e-06, -6.7414e-04, -1.8110e-03,  ...,  2.2009e-05,
        -2.6420e-05,  9.2294e-05], device='cuda:3')tensor([ 1.5865e-04,  3.2435e-04, -5.2684e-05,  ..., -1.7371e-05,
        -7.1366e-05, -2.1384e-05], device='cuda:0')
[rank: 18][epoch: 1][iter: 40] BEFORE:

[rank: 11][epoch: 1][iter: 40] BEFORE:

[rank: 13][epoch: 1][iter: 40] BEFORE:
tensor([-6.2989e-06, -1.2107e-04,  9.1431e-05,  ..., -1.2629e-04,
         1.3825e-04,  6.4355e-06], device='cuda:2')
[rank: 21][epoch: 1][iter: 40] BEFORE:
tensor([ 3.3800e-04, -1.7406e-04,  2.2501e-04,  ...,  1.8421e-04,
        -6.1764e-05, -2.0980e-04], device='cuda:3')tensor([-1.4830e-04, -9.5885e-05, -1.5261e-04,  ..., -7.0841e-05,
         8.5200e-07, -4.2170e-05], device='cuda:1')
[rank: 16][epoch: 1][iter: 40] BEFORE:
tensor([ 2.3207e-04, -7.8078e-05,  5.5968e-05,  ...,  3.9981e-03,
        -1.8940e-05,  4.1376e-03], device='cuda:1')
[rank: 0][epoch: 1][iter: 40] BEFORE:
tensor([-3.3627e-04,  3.2779e-04, -4.2222e-04,  ...,  2.9020e-05,
         1.2990e-05, -6.4563e-05], device='cuda:0')
[rank: 2][epoch: 1][iter: 40] BEFORE:
tensor([ 3.1309e-05,  7.6697e-05,  1.9470e-05,  ...,  6.1139e-06,
         6.5093e-05, -1.9305e-04], device='cuda:0')
[rank: 12][epoch: 1][iter: 40] BEFORE:
tensor([-1.0389e-04, -1.8726e-04, -1.6560e-04,  ...,  2.4176e-05,
         7.5984e-05, -1.8750e-05], device='cuda:2')
[rank: 9][epoch: 1][iter: 40] BEFORE:
tensor([-0.0014, -0.0016,  0.0011,  ..., -0.0005, -0.0007, -0.0003],
       device='cuda:0')
[rank: 17][epoch: 1][iter: 40] BEFORE:
tensor([-1.1756e-04,  6.8884e-05,  3.1920e-04,  ...,  7.5930e-05,
        -2.9946e-04,  6.6463e-04], device='cuda:1')tensor([-3.7462e-04, -2.1986e-03, -1.1061e-03,  ...,  2.8618e-04,
        -7.1332e-05, -4.4246e-05], device='cuda:1')
[rank: 10][epoch: 1][iter: 40] BEFORE:

[rank: 5][epoch: 1][iter: 40] BEFORE:

[rank: 14][epoch: 1][iter: 40] BEFORE:

[rank: 6][epoch: 1][iter: 40] BEFORE:
tensor([-0.0002, -0.0003, -0.0003,  ...,  0.0001,  0.0003, -0.0002],
       device='cuda:2')
[rank: 19][epoch: 1][iter: 40] BEFORE:
tensor([9.5365e-04, 3.4683e-04, 1.4297e-03,  ..., 8.0513e-05, 2.0707e-04,
        2.1962e-04], device='cuda:1')tensor([ 9.3394e-05,  2.7589e-05, -2.9749e-04,  ..., -1.7545e-04,
         1.8364e-05, -1.8396e-05], device='cuda:2')tensor([ 8.7863e-04,  3.4557e-04,  9.8573e-04,  ...,  1.3455e-04,
         9.8030e-05, -4.8672e-04], device='cuda:3')tensor([ 4.2804e-04,  7.6177e-05,  4.3354e-05,  ..., -5.4258e-05,
        -7.3919e-05, -6.5047e-04], device='cuda:2')
[rank: 23][epoch: 1][iter: 40] BEFORE:

[rank: 22][epoch: 1][iter: 40] BEFORE:
tensor([-3.5479e-05,  2.0425e-05,  2.3157e-06,  ..., -3.6632e-04,
        -2.8139e-04, -3.5160e-04], device='cuda:3')tensor([-2.4863e-05, -1.2826e-05, -3.1012e-05,  ..., -3.0737e-04,
        -1.9511e-03, -1.6976e-03], device='cuda:2')
[rank: 22][epoch: 1][iter: 40] AFTER HANDLE:

[rank: 23][epoch: 1][iter: 40] AFTER HANDLE:

[rank: 20][epoch: 1][iter: 40] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 40] AFTER HANDLE:

[rank: 0][epoch: 1][iter: 40] AFTER HANDLE:

[rank: 16][epoch: 1][iter: 40] AFTER HANDLE:

[rank: 9][epoch: 1][iter: 40] AFTER HANDLE:

[rank: 12][epoch: 1][iter: 40] AFTER HANDLE:

[rank: 4][epoch: 1][iter: 40] AFTER HANDLE:
tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:3')
[rank: 1][epoch: 1][iter: 40] AFTER HANDLE:

[rank: 18][epoch: 1][iter: 40] AFTER HANDLE:

[rank: 8][epoch: 1][iter: 40] AFTER HANDLE:

[rank: 13][epoch: 1][iter: 40] AFTER HANDLE:

[rank: 5][epoch: 1][iter: 40] AFTER HANDLE:
tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:2')
[rank: 3][epoch: 1][iter: 40] AFTER HANDLE:

[rank: 19][epoch: 1][iter: 40] AFTER HANDLE:

[rank: 10][epoch: 1][iter: 40] AFTER HANDLE:

[rank: 14][epoch: 1][iter: 40] AFTER HANDLE:

[rank: 6][epoch: 1][iter: 40] AFTER HANDLE:
tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:1')
[rank: 2][epoch: 1][iter: 40] AFTER HANDLE:

[rank: 17][epoch: 1][iter: 40] AFTER HANDLE:

[rank: 11][epoch: 1][iter: 40] AFTER HANDLE:

[rank: 15][epoch: 1][iter: 40] BEFORE:

[rank: 7][epoch: 1][iter: 40] AFTER HANDLE:
tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:0')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:0')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:0')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:1')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:0')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:0')
[rank: 23][epoch: 1][iter: 40] NEW GRAD:
tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:1')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:2')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:0')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:1')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:1')
[rank: 22][epoch: 1][iter: 40] NEW GRAD:
tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:3')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:3')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:2')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:2')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:2')
[rank: 21][epoch: 1][iter: 40] NEW GRAD:
tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:2')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:1')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:3')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:3')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:3')
[rank: 20][epoch: 1][iter: 40] NEW GRAD:

[rank: 0][epoch: 1][iter: 40] NEW GRAD:

[rank: 16][epoch: 1][iter: 40] NEW GRAD:

[rank: 9][epoch: 1][iter: 40] NEW GRAD:

[rank: 12][epoch: 1][iter: 40] NEW GRAD:

[rank: 4][epoch: 1][iter: 40] NEW GRAD:
tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:3')
[rank: 1][epoch: 1][iter: 40] NEW GRAD:

[rank: 18][epoch: 1][iter: 40] NEW GRAD:

[rank: 8][epoch: 1][iter: 40] NEW GRAD:

[rank: 13][epoch: 1][iter: 40] NEW GRAD:

[rank: 5][epoch: 1][iter: 40] NEW GRAD:
tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:2')
[rank: 3][epoch: 1][iter: 40] NEW GRAD:

[rank: 19][epoch: 1][iter: 40] NEW GRAD:

[rank: 10][epoch: 1][iter: 40] NEW GRAD:

[rank: 14][epoch: 1][iter: 40] NEW GRAD:

[rank: 6][epoch: 1][iter: 40] NEW GRAD:
tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:1')
[rank: 2][epoch: 1][iter: 40] NEW GRAD:

[rank: 17][epoch: 1][iter: 40] NEW GRAD:

[rank: 11][epoch: 1][iter: 40] NEW GRAD:

[rank: 15][epoch: 1][iter: 40] AFTER HANDLE:

[rank: 7][epoch: 1][iter: 40] NEW GRAD:
tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:0')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:0')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:0')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:1')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:0')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:0')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:1')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:2')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:0')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:1')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:1')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:3')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:3')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:2')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:2')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:2')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:2')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:1')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:3')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:3')tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:3')
[rank: 15][epoch: 1][iter: 40] NEW GRAD:
tensor([ 3.5759e-05, -1.1320e-04,  2.8327e-05,  ...,  2.5315e-04,
        -1.1554e-04,  6.1677e-05], device='cuda:3')
[rank: 23][epoch: 1][iter: 41] BEFORE:
tensor([ 0.0001, -0.0002,  0.0001,  ...,  0.0002,  0.0009,  0.0003],
       device='cuda:3')
[rank: 22][epoch: 1][iter: 41] BEFORE:
tensor([-0.0016, -0.0010, -0.0010,  ...,  0.0009, -0.0004,  0.0007],
       device='cuda:2')
[rank: 21][epoch: 1][iter: 41] BEFORE:
tensor([ 0.0016, -0.0177,  0.0021,  ..., -0.0012,  0.0008,  0.0003],
       device='cuda:1')
[rank: 20][epoch: 1][iter: 41] BEFORE:
tensor([ 5.8478e-05,  8.8055e-05,  9.1363e-05,  ..., -4.6156e-04,
         2.9017e-04, -4.8948e-04], device='cuda:0')
[rank: 0][epoch: 1][iter: 41] BEFORE:

[rank: 4][epoch: 1][iter: 41] BEFORE:

[rank: 1][epoch: 1][iter: 41] BEFORE:

[rank: 9][epoch: 1][iter: 41] BEFORE:
tensor([ 2.7759e-04,  2.5484e-04, -2.8890e-06,  ..., -1.0661e-05,
         1.4576e-04, -4.9492e-05], device='cuda:0')
[rank: 18][epoch: 1][iter: 41] BEFORE:
tensor([-5.9544e-05, -5.6314e-05, -5.4816e-05,  ...,  4.8067e-05,
         1.9295e-04, -1.0642e-04], device='cuda:0')tensor([ 1.7188e-04, -1.1931e-04, -1.3653e-05,  ..., -8.3452e-05,
         1.9192e-05,  8.1196e-05], device='cuda:1')tensor([-0.0001, -0.0001, -0.0005,  ..., -0.0056, -0.0052, -0.0035],
       device='cuda:1')
[rank: 12][epoch: 1][iter: 41] BEFORE:
tensor([-9.7896e-05, -9.9142e-07, -3.8772e-05,  ..., -7.4527e-04,
         1.3648e-04, -6.3810e-04], device='cuda:2')
[rank: 5][epoch: 1][iter: 41] BEFORE:

[rank: 8][epoch: 1][iter: 41] BEFORE:

[rank: 13][epoch: 1][iter: 41] BEFORE:

[rank: 19][epoch: 1][iter: 41] BEFORE:

[rank: 3][epoch: 1][iter: 41] BEFORE:
tensor([-0.0008, -0.0002,  0.0002,  ...,  0.0002,  0.0002, -0.0002],
       device='cuda:1')
[rank: 10][epoch: 1][iter: 41] BEFORE:
tensor([ 3.1592e-05,  1.3370e-04, -5.1031e-05,  ...,  3.5089e-04,
        -1.8323e-04, -9.3098e-05], device='cuda:0')
[rank: 16][epoch: 1][iter: 41] BEFORE:
tensor([ 0.0002, -0.0001,  0.0001,  ...,  0.0003,  0.0003, -0.0001],
       device='cuda:3')
[rank: 6][epoch: 1][iter: 41] BEFORE:
tensor([-1.8194e-03, -2.9182e-04,  1.7433e-04,  ...,  2.3047e-05,
        -4.0411e-05, -1.6439e-04], device='cuda:0')tensor([ 8.4753e-05,  6.9481e-05, -3.7088e-05,  ..., -6.3413e-05,
        -1.6940e-04,  4.8764e-04], device='cuda:1')tensor([ 6.4335e-06,  3.7487e-05,  5.7719e-04,  ..., -2.1170e-04,
         1.1522e-04, -1.3968e-04], device='cuda:3')
[rank: 2][epoch: 1][iter: 41] BEFORE:

[rank: 20][epoch: 1][iter: 41] AFTER HANDLE:

[rank: 7][epoch: 1][iter: 41] BEFORE:
tensor([ 4.9023e-04,  1.6537e-03,  4.1984e-04,  ...,  1.8863e-05,
         4.9161e-04, -3.2930e-04], device='cuda:2')
[rank: 14][epoch: 1][iter: 41] BEFORE:

[rank: 17][epoch: 1][iter: 41] BEFORE:

[rank: 0][epoch: 1][iter: 41] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 41] AFTER HANDLE:

[rank: 5][epoch: 1][iter: 41] AFTER HANDLE:

[rank: 11][epoch: 1][iter: 41] BEFORE:

[rank: 12][epoch: 1][iter: 41] AFTER HANDLE:
tensor([-0.0001,  0.0004,  0.0002,  ...,  0.0010, -0.0016, -0.0007],
       device='cuda:0')
[rank: 1][epoch: 1][iter: 41] AFTER HANDLE:

[rank: 23][epoch: 1][iter: 41] AFTER HANDLE:

[rank: 4][epoch: 1][iter: 41] AFTER HANDLE:

[rank: 9][epoch: 1][iter: 41] AFTER HANDLE:

[rank: 15][epoch: 1][iter: 41] BEFORE:

[rank: 18][epoch: 1][iter: 41] AFTER HANDLE:

[rank: 3][epoch: 1][iter: 41] AFTER HANDLE:

[rank: 22][epoch: 1][iter: 41] AFTER HANDLE:
tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:2')
[rank: 8][epoch: 1][iter: 41] AFTER HANDLE:

[rank: 13][epoch: 1][iter: 41] AFTER HANDLE:

[rank: 19][epoch: 1][iter: 41] AFTER HANDLE:
tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:2')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:0')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:3')
[rank: 10][epoch: 1][iter: 41] AFTER HANDLE:
tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:2')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:1')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:0')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:1')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:1')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:3')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:0')
[rank: 16][epoch: 1][iter: 41] AFTER HANDLE:
tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:1')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:3')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:0')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:1')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:3')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:2')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:3')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:2')
[rank: 6][epoch: 1][iter: 41] AFTER HANDLE:
tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:0')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:1')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:3')
[rank: 2][epoch: 1][iter: 41] AFTER HANDLE:

[rank: 20][epoch: 1][iter: 41] NEW GRAD:

[rank: 7][epoch: 1][iter: 41] AFTER HANDLE:
tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:2')
[rank: 14][epoch: 1][iter: 41] AFTER HANDLE:

[rank: 17][epoch: 1][iter: 41] AFTER HANDLE:

[rank: 0][epoch: 1][iter: 41] NEW GRAD:

[rank: 21][epoch: 1][iter: 41] NEW GRAD:

[rank: 5][epoch: 1][iter: 41] NEW GRAD:

[rank: 11][epoch: 1][iter: 41] AFTER HANDLE:

[rank: 12][epoch: 1][iter: 41] NEW GRAD:
tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:0')
[rank: 1][epoch: 1][iter: 41] NEW GRAD:

[rank: 23][epoch: 1][iter: 41] NEW GRAD:

[rank: 4][epoch: 1][iter: 41] NEW GRAD:

[rank: 9][epoch: 1][iter: 41] NEW GRAD:

[rank: 15][epoch: 1][iter: 41] AFTER HANDLE:

[rank: 18][epoch: 1][iter: 41] NEW GRAD:

[rank: 3][epoch: 1][iter: 41] NEW GRAD:

[rank: 22][epoch: 1][iter: 41] NEW GRAD:
tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:2')
[rank: 8][epoch: 1][iter: 41] NEW GRAD:

[rank: 13][epoch: 1][iter: 41] NEW GRAD:

[rank: 19][epoch: 1][iter: 41] NEW GRAD:
tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:2')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:0')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:3')
[rank: 10][epoch: 1][iter: 41] NEW GRAD:
tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:2')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:1')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:0')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:1')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:1')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:3')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:0')
[rank: 16][epoch: 1][iter: 41] NEW GRAD:
tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:1')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:3')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:0')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:1')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:3')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:2')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:3')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:2')
[rank: 6][epoch: 1][iter: 41] NEW GRAD:
tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:0')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:1')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:3')
[rank: 2][epoch: 1][iter: 41] NEW GRAD:

[rank: 7][epoch: 1][iter: 41] NEW GRAD:
tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:2')
[rank: 14][epoch: 1][iter: 41] NEW GRAD:

[rank: 17][epoch: 1][iter: 41] NEW GRAD:
tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:2')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:2')
[rank: 11][epoch: 1][iter: 41] NEW GRAD:

[rank: 15][epoch: 1][iter: 41] NEW GRAD:
tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:0')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:3')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:3')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:2')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:1')tensor([-7.7589e-05, -7.0134e-04,  1.3703e-04,  ..., -2.5229e-04,
        -1.6701e-04, -2.3406e-04], device='cuda:3')
[rank: 20][epoch: 1][iter: 42] BEFORE:
tensor([ 1.6875e-05, -1.9580e-04, -4.3439e-04,  ..., -8.4935e-05,
        -2.7180e-04,  2.4479e-04], device='cuda:0')
[rank: 21][epoch: 1][iter: 42] BEFORE:

[rank: 0][epoch: 1][iter: 42] BEFORE:
tensor([-3.7691e-04, -1.9507e-04,  2.8662e-05,  ..., -5.0394e-05,
         1.6685e-04,  6.2191e-04], device='cuda:1')tensor([-2.0695e-04,  6.8206e-05,  7.3273e-05,  ...,  2.2148e-04,
         5.0874e-04,  8.5725e-05], device='cuda:0')
[rank: 1][epoch: 1][iter: 42] BEFORE:
tensor([-0.0003, -0.0002, -0.0002,  ..., -0.0001, -0.0001, -0.0001],
       device='cuda:1')
[rank: 5][epoch: 1][iter: 42] BEFORE:

[rank: 23][epoch: 1][iter: 42] BEFORE:

[rank: 4][epoch: 1][iter: 42] BEFORE:
tensor([-3.6918e-05,  1.6525e-04, -3.3850e-04,  ..., -4.4304e-05,
         2.5911e-05,  2.6316e-04], device='cuda:1')tensor([-3.3499e-05,  7.7204e-06, -3.4103e-05,  ...,  2.7508e-05,
         1.4551e-04, -2.7328e-04], device='cuda:3')
[rank: 12][epoch: 1][iter: 42] BEFORE:
tensor([ 8.5103e-05, -2.3700e-04, -9.5886e-09,  ..., -7.5810e-05,
        -3.3917e-04, -1.0212e-04], device='cuda:0')
[rank: 3][epoch: 1][iter: 42] BEFORE:

[rank: 18][epoch: 1][iter: 42] BEFORE:
tensor([-2.3119e-07, -8.8445e-05, -8.3108e-05,  ...,  3.3228e-04,
         1.0566e-03,  6.0472e-04], device='cuda:0')
[rank: 9][epoch: 1][iter: 42] BEFORE:
tensor([ 4.0558e-05,  1.7042e-04,  5.2403e-04,  ...,  7.9183e-05,
        -9.4957e-05,  2.1057e-07], device='cuda:3')
[rank: 19][epoch: 1][iter: 42] BEFORE:

[rank: 13][epoch: 1][iter: 42] BEFORE:

[rank: 22][epoch: 1][iter: 42] BEFORE:

[rank: 8][epoch: 1][iter: 42] BEFORE:
tensor([ 3.4919e-05,  2.5897e-04, -1.0352e-04,  ..., -7.9833e-05,
        -1.5220e-05, -6.5662e-06], device='cuda:2')tensor([-1.2615e-04, -1.2878e-04, -1.9562e-04,  ...,  1.1171e-04,
        -6.4565e-05,  3.3381e-04], device='cuda:1')tensor([-0.0002, -0.0004,  0.0005,  ..., -0.0006,  0.0002, -0.0005],
       device='cuda:1')tensor([-5.7443e-04, -3.3722e-04, -6.8599e-04,  ..., -2.4197e-05,
        -3.5850e-04,  6.0404e-06], device='cuda:2')tensor([-7.9067e-05,  1.6300e-04,  4.2895e-04,  ...,  3.0057e-05,
        -2.0173e-04, -2.4954e-04], device='cuda:3')
[rank: 10][epoch: 1][iter: 42] BEFORE:

[rank: 2][epoch: 1][iter: 42] BEFORE:

[rank: 16][epoch: 1][iter: 42] BEFORE:
tensor([-1.3116e-04, -9.4862e-05, -7.7204e-06,  ...,  5.5812e-05,
         2.6153e-04, -2.6312e-04], device='cuda:0')tensor([-1.0470e-04,  3.2795e-05, -1.9190e-04,  ...,  3.2203e-04,
         1.2113e-04,  2.7959e-04], device='cuda:2')tensor([ 7.3080e-05, -2.1886e-05, -1.7229e-05,  ..., -6.1824e-04,
        -2.8029e-04, -5.7251e-04], device='cuda:2')
[rank: 7][epoch: 1][iter: 42] BEFORE:
tensor([-0.0003, -0.0076,  0.0003,  ...,  0.0005,  0.0007,  0.0004],
       device='cuda:0')
[rank: 11][epoch: 1][iter: 42] BEFORE:

[rank: 6][epoch: 1][iter: 42] BEFORE:

[rank: 14][epoch: 1][iter: 42] BEFORE:

[rank: 17][epoch: 1][iter: 42] BEFORE:
tensor([-1.3492e-05, -1.6437e-05,  6.8299e-05,  ..., -2.1904e-04,
         9.3943e-05, -6.7043e-06], device='cuda:3')tensor([ 2.7984e-04,  1.0042e-05, -2.4144e-04,  ...,  1.6173e-05,
         1.5755e-04,  5.8354e-04], device='cuda:3')tensor([-0.0023,  0.0010, -0.0048,  ..., -0.0019,  0.0004,  0.0008],
       device='cuda:2')tensor([ 8.7677e-07,  1.1484e-06, -7.1960e-07,  ..., -5.4978e-07,
        -1.3132e-05,  7.1895e-05], device='cuda:1')tensor([-5.5954e-05, -8.2127e-05, -2.5649e-04,  ..., -3.9646e-04,
         2.8598e-03,  1.4201e-04], device='cuda:2')
[rank: 5][epoch: 1][iter: 42] AFTER HANDLE:

[rank: 7][epoch: 1][iter: 42] AFTER HANDLE:

[rank: 6][epoch: 1][iter: 42] AFTER HANDLE:

[rank: 4][epoch: 1][iter: 42] AFTER HANDLE:

[rank: 0][epoch: 1][iter: 42] AFTER HANDLE:

[rank: 16][epoch: 1][iter: 42] AFTER HANDLE:

[rank: 11][epoch: 1][iter: 42] AFTER HANDLE:

[rank: 20][epoch: 1][iter: 42] AFTER HANDLE:

[rank: 12][epoch: 1][iter: 42] AFTER HANDLE:
tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:1')
[rank: 1][epoch: 1][iter: 42] AFTER HANDLE:

[rank: 18][epoch: 1][iter: 42] AFTER HANDLE:

[rank: 10][epoch: 1][iter: 42] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 42] AFTER HANDLE:

[rank: 13][epoch: 1][iter: 42] AFTER HANDLE:
tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:3')
[rank: 3][epoch: 1][iter: 42] AFTER HANDLE:

[rank: 17][epoch: 1][iter: 42] AFTER HANDLE:

[rank: 9][epoch: 1][iter: 42] AFTER HANDLE:

[rank: 22][epoch: 1][iter: 42] AFTER HANDLE:

[rank: 14][epoch: 1][iter: 42] AFTER HANDLE:
tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:2')
[rank: 2][epoch: 1][iter: 42] AFTER HANDLE:

[rank: 19][epoch: 1][iter: 42] AFTER HANDLE:

[rank: 8][epoch: 1][iter: 42] AFTER HANDLE:

[rank: 23][epoch: 1][iter: 42] AFTER HANDLE:

[rank: 15][epoch: 1][iter: 42] BEFORE:
tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:0')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:0')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:0')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:3')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:0')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:0')
[rank: 5][epoch: 1][iter: 42] NEW GRAD:
tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:1')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:2')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:2')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:1')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:1')
[rank: 7][epoch: 1][iter: 42] NEW GRAD:
tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:3')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:1')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:1')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:2')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:2')
[rank: 6][epoch: 1][iter: 42] NEW GRAD:
tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:2')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:3')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:0')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:3')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:3')
[rank: 4][epoch: 1][iter: 42] NEW GRAD:

[rank: 0][epoch: 1][iter: 42] NEW GRAD:

[rank: 16][epoch: 1][iter: 42] NEW GRAD:

[rank: 11][epoch: 1][iter: 42] NEW GRAD:

[rank: 20][epoch: 1][iter: 42] NEW GRAD:

[rank: 12][epoch: 1][iter: 42] NEW GRAD:
tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:1')
[rank: 1][epoch: 1][iter: 42] NEW GRAD:

[rank: 18][epoch: 1][iter: 42] NEW GRAD:

[rank: 10][epoch: 1][iter: 42] NEW GRAD:

[rank: 21][epoch: 1][iter: 42] NEW GRAD:

[rank: 13][epoch: 1][iter: 42] NEW GRAD:
tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:3')
[rank: 3][epoch: 1][iter: 42] NEW GRAD:

[rank: 17][epoch: 1][iter: 42] NEW GRAD:

[rank: 9][epoch: 1][iter: 42] NEW GRAD:

[rank: 22][epoch: 1][iter: 42] NEW GRAD:

[rank: 14][epoch: 1][iter: 42] NEW GRAD:
tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:2')
[rank: 2][epoch: 1][iter: 42] NEW GRAD:

[rank: 19][epoch: 1][iter: 42] NEW GRAD:

[rank: 8][epoch: 1][iter: 42] NEW GRAD:

[rank: 23][epoch: 1][iter: 42] NEW GRAD:

[rank: 15][epoch: 1][iter: 42] AFTER HANDLE:
tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:0')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:0')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:0')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:3')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:0')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:0')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:1')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:2')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:2')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:1')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:1')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:3')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:1')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:1')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:2')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:2')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:2')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:3')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:0')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:3')tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:3')
[rank: 15][epoch: 1][iter: 42] NEW GRAD:
tensor([-1.7852e-04, -3.1291e-04, -2.4446e-04,  ..., -7.0390e-05,
         1.5498e-04,  7.0598e-05], device='cuda:3')
[rank: 5][epoch: 1][iter: 43] BEFORE:
tensor([ 3.4599e-04,  2.2874e-04, -6.2236e-04,  ...,  9.1483e-05,
        -9.1951e-06,  4.4557e-04], device='cuda:1')
[rank: 7][epoch: 1][iter: 43] BEFORE:
tensor([ 8.7260e-05,  9.7589e-05,  2.8422e-05,  ..., -1.4464e-04,
        -1.1015e-04, -2.8333e-05], device='cuda:3')
[rank: 6][epoch: 1][iter: 43] BEFORE:
tensor([-0.0062,  0.0011, -0.0066,  ...,  0.0012,  0.0014,  0.0005],
       device='cuda:2')
[rank: 4][epoch: 1][iter: 43] BEFORE:
tensor([-7.4428e-05, -3.5653e-05, -7.2904e-05,  ...,  2.0561e-04,
         2.9708e-04,  3.5802e-04], device='cuda:0')
[rank: 0][epoch: 1][iter: 43] BEFORE:

[rank: 11][epoch: 1][iter: 43] BEFORE:
tensor([ 3.1684e-04, -2.6960e-04,  5.5770e-04,  ..., -3.0777e-04,
        -2.3864e-04,  1.6052e-05], device='cuda:0')tensor([-2.6664e-03,  6.1059e-04, -3.3722e-03,  ...,  5.9898e-06,
        -1.7861e-05,  1.4416e-04], device='cuda:3')
[rank: 20][epoch: 1][iter: 43] BEFORE:

[rank: 1][epoch: 1][iter: 43] BEFORE:
tensor([-5.5991e-04, -5.2128e-04,  2.5418e-04,  ..., -5.6252e-05,
        -1.6333e-05,  8.6887e-05], device='cuda:0')
[rank: 10][epoch: 1][iter: 43] BEFORE:
tensor([ 2.8725e-04,  2.8601e-04,  1.9450e-04,  ..., -8.1881e-05,
         1.9546e-04, -3.7417e-06], device='cuda:1')
[rank: 18][epoch: 1][iter: 43] BEFORE:

[rank: 13][epoch: 1][iter: 43] BEFORE:
tensor([-1.9353e-04, -9.2030e-04, -3.4963e-04,  ...,  2.4670e-05,
        -2.4260e-05,  9.9652e-05], device='cuda:2')
[rank: 21][epoch: 1][iter: 43] BEFORE:

[rank: 17][epoch: 1][iter: 43] BEFORE:
tensor([ 2.2214e-05, -2.0312e-04, -9.2349e-07,  ..., -4.1903e-05,
         1.3496e-04, -1.0612e-04], device='cuda:1')tensor([-9.4825e-05,  9.4144e-04,  9.4111e-04,  ..., -2.2636e-04,
        -4.8593e-07, -2.7596e-05], device='cuda:1')tensor([-5.8192e-05,  1.2156e-05,  2.8121e-05,  ...,  2.2338e-04,
         1.6702e-04,  3.2113e-06], device='cuda:2')
[rank: 12][epoch: 1][iter: 43] BEFORE:

[rank: 3][epoch: 1][iter: 43] BEFORE:

[rank: 16][epoch: 1][iter: 43] BEFORE:

[rank: 22][epoch: 1][iter: 43] BEFORE:
tensor([ 1.1253e-04,  2.4832e-05,  2.5204e-04,  ...,  1.1500e-04,
        -1.0316e-05,  5.5235e-05], device='cuda:0')tensor([ 1.3500e-05, -2.0658e-06, -1.0048e-05,  ..., -1.5660e-05,
        -1.3667e-04, -6.5906e-04], device='cuda:3')tensor([ 2.0787e-05, -3.2891e-05, -1.3349e-06,  ...,  1.3322e-04,
         1.7173e-04,  2.1905e-04], device='cuda:1')
[rank: 9][epoch: 1][iter: 43] BEFORE:
tensor([-0.0003, -0.0006, -0.0003,  ...,  0.0003,  0.0004,  0.0004],
       device='cuda:2')
[rank: 14][epoch: 1][iter: 43] BEFORE:

[rank: 2][epoch: 1][iter: 43] BEFORE:

[rank: 19][epoch: 1][iter: 43] BEFORE:

[rank: 8][epoch: 1][iter: 43] BEFORE:

[rank: 23][epoch: 1][iter: 43] BEFORE:
tensor([-2.6046e-03, -2.8773e-03, -3.1175e-03,  ..., -2.0748e-04,
         2.2363e-05, -1.4969e-03], device='cuda:2')tensor([ 0.0003, -0.0005, -0.0002,  ..., -0.0007,  0.0004, -0.0009],
       device='cuda:0')tensor([ 3.6417e-04,  7.2092e-05,  3.1480e-04,  ..., -2.2010e-04,
        -4.6542e-04, -3.4843e-04], device='cuda:2')tensor([-1.1311e-03,  1.4741e-07,  4.5694e-04,  ...,  1.5348e-03,
         2.2607e-04,  6.1044e-05], device='cuda:1')
[rank: 4][epoch: 1][iter: 43] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 43] AFTER HANDLE:

[rank: 15][epoch: 1][iter: 43] BEFORE:
tensor([-3.5128e-04, -2.9272e-04,  1.5045e-03,  ...,  4.7182e-05,
         7.7737e-05,  2.8587e-05], device='cuda:3')
[rank: 0][epoch: 1][iter: 43] AFTER HANDLE:

[rank: 10][epoch: 1][iter: 43] AFTER HANDLE:

[rank: 5][epoch: 1][iter: 43] AFTER HANDLE:

[rank: 22][epoch: 1][iter: 43] AFTER HANDLE:

[rank: 13][epoch: 1][iter: 43] AFTER HANDLE:

[rank: 18][epoch: 1][iter: 43] AFTER HANDLE:

[rank: 1][epoch: 1][iter: 43] AFTER HANDLE:

[rank: 11][epoch: 1][iter: 43] AFTER HANDLE:

[rank: 7][epoch: 1][iter: 43] AFTER HANDLE:

[rank: 20][epoch: 1][iter: 43] AFTER HANDLE:

[rank: 12][epoch: 1][iter: 43] AFTER HANDLE:

[rank: 17][epoch: 1][iter: 43] AFTER HANDLE:

[rank: 3][epoch: 1][iter: 43] AFTER HANDLE:
tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:0')
[rank: 6][epoch: 1][iter: 43] AFTER HANDLE:
tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:3')
[rank: 14][epoch: 1][iter: 43] AFTER HANDLE:

[rank: 16][epoch: 1][iter: 43] AFTER HANDLE:

[rank: 2][epoch: 1][iter: 43] AFTER HANDLE:

[rank: 9][epoch: 1][iter: 43] AFTER HANDLE:
tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:0')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:1')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:3')
[rank: 19][epoch: 1][iter: 43] AFTER HANDLE:
tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:0')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:2')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:1')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:2')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:1')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:2')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:1')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:3')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:3')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:0')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:0')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:1')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:3')
[rank: 8][epoch: 1][iter: 43] AFTER HANDLE:
tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:2')
[rank: 23][epoch: 1][iter: 43] AFTER HANDLE:
tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:2')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:0')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:2')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:1')
[rank: 4][epoch: 1][iter: 43] NEW GRAD:

[rank: 21][epoch: 1][iter: 43] NEW GRAD:

[rank: 15][epoch: 1][iter: 43] AFTER HANDLE:
tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:3')
[rank: 0][epoch: 1][iter: 43] NEW GRAD:

[rank: 10][epoch: 1][iter: 43] NEW GRAD:

[rank: 5][epoch: 1][iter: 43] NEW GRAD:

[rank: 22][epoch: 1][iter: 43] NEW GRAD:

[rank: 13][epoch: 1][iter: 43] NEW GRAD:

[rank: 18][epoch: 1][iter: 43] NEW GRAD:

[rank: 1][epoch: 1][iter: 43] NEW GRAD:

[rank: 11][epoch: 1][iter: 43] NEW GRAD:

[rank: 7][epoch: 1][iter: 43] NEW GRAD:

[rank: 20][epoch: 1][iter: 43] NEW GRAD:

[rank: 12][epoch: 1][iter: 43] NEW GRAD:

[rank: 17][epoch: 1][iter: 43] NEW GRAD:

[rank: 3][epoch: 1][iter: 43] NEW GRAD:
tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:0')
[rank: 6][epoch: 1][iter: 43] NEW GRAD:
tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:3')
[rank: 14][epoch: 1][iter: 43] NEW GRAD:

[rank: 16][epoch: 1][iter: 43] NEW GRAD:

[rank: 2][epoch: 1][iter: 43] NEW GRAD:

[rank: 9][epoch: 1][iter: 43] NEW GRAD:
tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:0')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:1')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:3')
[rank: 19][epoch: 1][iter: 43] NEW GRAD:
tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:0')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:2')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:1')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:2')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:1')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:2')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:1')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:3')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:3')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:0')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:0')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:1')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:3')
[rank: 8][epoch: 1][iter: 43] NEW GRAD:
tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:2')
[rank: 23][epoch: 1][iter: 43] NEW GRAD:
tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:2')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:0')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:2')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:1')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:3')
[rank: 15][epoch: 1][iter: 43] NEW GRAD:
tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:3')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:0')tensor([-5.1277e-04, -2.5153e-05, -5.1331e-04,  ...,  6.4621e-05,
         1.1395e-04, -5.7387e-05], device='cuda:3')
[rank: 4][epoch: 1][iter: 44] BEFORE:
tensor([ 1.0670e-04,  3.2195e-05, -1.0026e-04,  ...,  1.0106e-04,
        -2.5417e-04,  6.8839e-05], device='cuda:0')
[rank: 21][epoch: 1][iter: 44] BEFORE:
tensor([-8.0712e-06, -1.3628e-06,  1.5543e-05,  ...,  1.3219e-05,
         3.9542e-05,  4.0614e-05], device='cuda:1')
[rank: 0][epoch: 1][iter: 44] BEFORE:
tensor([-6.7435e-05, -4.8182e-05, -2.7258e-05,  ...,  1.5179e-04,
         2.5724e-04,  1.9804e-04], device='cuda:0')
[rank: 10][epoch: 1][iter: 44] BEFORE:
tensor([ 5.9730e-06, -3.7407e-05,  2.3223e-05,  ..., -2.4622e-04,
        -3.0907e-05, -5.3126e-05], device='cuda:2')
[rank: 13][epoch: 1][iter: 44] BEFORE:

[rank: 5][epoch: 1][iter: 44] BEFORE:
tensor([-2.7213e-05, -1.6502e-04, -1.7763e-04,  ..., -2.1008e-04,
        -1.4594e-04, -6.4092e-05], device='cuda:1')
[rank: 22][epoch: 1][iter: 44] BEFORE:
tensor([ 2.9598e-05, -6.8549e-05,  2.0234e-04,  ...,  1.4039e-03,
         1.3757e-03,  9.2644e-04], device='cuda:1')
[rank: 18][epoch: 1][iter: 44] BEFORE:
tensor([ 1.0839e-04,  1.6037e-04,  7.3261e-05,  ..., -1.0969e-05,
        -5.5262e-05,  2.3962e-05], device='cuda:2')
[rank: 1][epoch: 1][iter: 44] BEFORE:
tensor([-6.1352e-05, -3.7270e-05, -1.1764e-04,  ..., -6.4973e-05,
         1.2013e-04,  1.6084e-04], device='cuda:2')
[rank: 11][epoch: 1][iter: 44] BEFORE:
tensor([-8.1470e-05,  6.7382e-05,  1.8723e-05,  ...,  9.2962e-05,
         9.1228e-05,  1.3134e-04], device='cuda:1')
[rank: 7][epoch: 1][iter: 44] BEFORE:
tensor([ 3.0084e-05,  2.9723e-05, -1.8520e-04,  ..., -1.4167e-04,
        -8.1155e-04,  2.8528e-05], device='cuda:3')tensor([-1.7084e-04, -1.4866e-04,  5.3371e-05,  ...,  1.7357e-04,
        -1.8440e-05, -1.7492e-03], device='cuda:3')
[rank: 20][epoch: 1][iter: 44] BEFORE:
tensor([ 4.8605e-05,  4.9836e-05,  6.6565e-05,  ...,  1.3781e-04,
         1.3900e-04, -4.4822e-05], device='cuda:0')
[rank: 17][epoch: 1][iter: 44] BEFORE:

[rank: 3][epoch: 1][iter: 44] BEFORE:
tensor([ 2.2061e-05,  2.1037e-04,  1.7925e-04,  ...,  4.1028e-04,
        -9.2534e-05,  2.3825e-04], device='cuda:1')tensor([ 0.0011, -0.0008,  0.0011,  ...,  0.0005, -0.0012, -0.0020],
       device='cuda:3')
[rank: 12][epoch: 1][iter: 44] BEFORE:
tensor([ 8.0389e-05,  8.1276e-05,  8.4464e-05,  ..., -1.1549e-04,
        -5.9666e-04, -3.1613e-04], device='cuda:0')
[rank: 9][epoch: 1][iter: 44] BEFORE:
tensor([-3.3199e-05, -3.4410e-05, -5.0237e-06,  ...,  1.7658e-04,
        -4.4370e-04,  2.7100e-04], device='cuda:1')
[rank: 23][epoch: 1][iter: 44] BEFORE:
tensor([-4.6333e-05, -1.2586e-04, -1.1649e-04,  ...,  5.7454e-04,
        -2.0562e-04,  4.4496e-04], device='cuda:3')
[rank: 16][epoch: 1][iter: 44] BEFORE:
tensor([ 0.0005,  0.0004,  0.0004,  ..., -0.0037, -0.0051,  0.0011],
       device='cuda:0')
[rank: 14][epoch: 1][iter: 44] BEFORE:

[rank: 6][epoch: 1][iter: 44] BEFORE:
tensor([-3.4375e-04, -1.6262e-04,  4.2444e-05,  ..., -1.2803e-04,
         1.2425e-04,  1.2043e-04], device='cuda:2')tensor([ 4.1019e-04, -1.4268e-04,  6.6601e-04,  ..., -5.6712e-08,
        -1.9208e-05,  1.7314e-04], device='cuda:2')
[rank: 2][epoch: 1][iter: 44] BEFORE:

[rank: 8][epoch: 1][iter: 44] BEFORE:
tensor([-3.9477e-04,  2.9589e-04, -4.6188e-04,  ...,  1.5447e-05,
         1.4007e-04,  9.4147e-05], device='cuda:2')tensor([-1.5993e-05, -1.4921e-05, -2.9843e-05,  ...,  1.4048e-05,
         6.7566e-04, -4.5380e-05], device='cuda:0')
[rank: 15][epoch: 1][iter: 44] BEFORE:

[rank: 19][epoch: 1][iter: 44] BEFORE:

[rank: 0][epoch: 1][iter: 44] AFTER HANDLE:

[rank: 8][epoch: 1][iter: 44] AFTER HANDLE:

[rank: 20][epoch: 1][iter: 44] AFTER HANDLE:

[rank: 4][epoch: 1][iter: 44] AFTER HANDLE:

[rank: 12][epoch: 1][iter: 44] AFTER HANDLE:

[rank: 16][epoch: 1][iter: 44] AFTER HANDLE:

[rank: 1][epoch: 1][iter: 44] AFTER HANDLE:

[rank: 10][epoch: 1][iter: 44] AFTER HANDLE:

[rank: 23][epoch: 1][iter: 44] AFTER HANDLE:

[rank: 5][epoch: 1][iter: 44] AFTER HANDLE:

[rank: 13][epoch: 1][iter: 44] AFTER HANDLE:

[rank: 17][epoch: 1][iter: 44] AFTER HANDLE:

[rank: 3][epoch: 1][iter: 44] AFTER HANDLE:

[rank: 9][epoch: 1][iter: 44] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 44] AFTER HANDLE:

[rank: 7][epoch: 1][iter: 44] AFTER HANDLE:

[rank: 14][epoch: 1][iter: 44] AFTER HANDLE:

[rank: 18][epoch: 1][iter: 44] AFTER HANDLE:

[rank: 2][epoch: 1][iter: 44] AFTER HANDLE:

[rank: 11][epoch: 1][iter: 44] AFTER HANDLE:

[rank: 22][epoch: 1][iter: 44] AFTER HANDLE:

[rank: 6][epoch: 1][iter: 44] AFTER HANDLE:
tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:3')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:3')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:0')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:0')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:0')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:0')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:0')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:0')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:1')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:2')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:3')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:1')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:1')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:1')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:3')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:1')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:1')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:3')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:2')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:2')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:2')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:3')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:2')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:2')
[rank: 15][epoch: 1][iter: 44] AFTER HANDLE:

[rank: 19][epoch: 1][iter: 44] AFTER HANDLE:

[rank: 0][epoch: 1][iter: 44] NEW GRAD:

[rank: 8][epoch: 1][iter: 44] NEW GRAD:

[rank: 20][epoch: 1][iter: 44] NEW GRAD:

[rank: 4][epoch: 1][iter: 44] NEW GRAD:

[rank: 12][epoch: 1][iter: 44] NEW GRAD:

[rank: 16][epoch: 1][iter: 44] NEW GRAD:

[rank: 1][epoch: 1][iter: 44] NEW GRAD:

[rank: 10][epoch: 1][iter: 44] NEW GRAD:

[rank: 23][epoch: 1][iter: 44] NEW GRAD:

[rank: 5][epoch: 1][iter: 44] NEW GRAD:

[rank: 13][epoch: 1][iter: 44] NEW GRAD:

[rank: 17][epoch: 1][iter: 44] NEW GRAD:

[rank: 3][epoch: 1][iter: 44] NEW GRAD:

[rank: 9][epoch: 1][iter: 44] NEW GRAD:

[rank: 21][epoch: 1][iter: 44] NEW GRAD:

[rank: 7][epoch: 1][iter: 44] NEW GRAD:

[rank: 14][epoch: 1][iter: 44] NEW GRAD:

[rank: 18][epoch: 1][iter: 44] NEW GRAD:

[rank: 2][epoch: 1][iter: 44] NEW GRAD:

[rank: 11][epoch: 1][iter: 44] NEW GRAD:

[rank: 22][epoch: 1][iter: 44] NEW GRAD:

[rank: 6][epoch: 1][iter: 44] NEW GRAD:
tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:3')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:3')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:0')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:0')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:0')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:0')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:0')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:0')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:1')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:2')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:3')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:1')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:1')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:1')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:3')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:1')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:1')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:3')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:2')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:2')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:2')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:3')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:2')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:2')
[rank: 15][epoch: 1][iter: 44] NEW GRAD:

[rank: 19][epoch: 1][iter: 44] NEW GRAD:
tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:3')tensor([ 4.3835e-05, -2.3781e-05,  7.2313e-05,  ..., -4.0041e-06,
        -2.2486e-04, -2.0316e-05], device='cuda:3')
[rank: 8][epoch: 1][iter: 45] BEFORE:

[rank: 0][epoch: 1][iter: 45] BEFORE:
tensor([-1.3596e-04,  2.2874e-05,  1.2649e-04,  ..., -2.1078e-05,
         9.6179e-06,  1.5263e-05], device='cuda:0')tensor([ 4.1473e-04, -8.1870e-05, -1.1971e-04,  ...,  5.2548e-06,
         2.3006e-05,  1.0218e-05], device='cuda:0')
[rank: 4][epoch: 1][iter: 45] BEFORE:

[rank: 20][epoch: 1][iter: 45] BEFORE:
tensor([-0.0003,  0.0006, -0.0002,  ...,  0.0004, -0.0006,  0.0005],
       device='cuda:0')tensor([-3.7502e-04, -6.3318e-05,  7.3291e-06,  ...,  4.8688e-05,
         8.1445e-05,  3.9417e-05], device='cuda:0')
[rank: 12][epoch: 1][iter: 45] BEFORE:

[rank: 1][epoch: 1][iter: 45] BEFORE:
tensor([ 5.0954e-06, -1.7936e-04, -4.0587e-04,  ..., -1.8199e-04,
        -3.8233e-04,  1.9595e-04], device='cuda:0')
[rank: 16][epoch: 1][iter: 45] BEFORE:
tensor([-1.4667e-04, -1.0888e-04,  7.3908e-05,  ...,  1.0824e-05,
         1.5023e-06, -9.4641e-06], device='cuda:1')tensor([ 0.0002,  0.0008,  0.0013,  ..., -0.0024, -0.0013, -0.0002],
       device='cuda:0')
[rank: 10][epoch: 1][iter: 45] BEFORE:
tensor([ 1.0165e-04,  9.9653e-05,  1.4936e-04,  ...,  4.9043e-04,
        -5.5735e-03, -4.6872e-03], device='cuda:2')
[rank: 5][epoch: 1][iter: 45] BEFORE:

[rank: 23][epoch: 1][iter: 45] BEFORE:
tensor([ 4.1733e-04, -8.3339e-04, -5.4578e-04,  ..., -5.1021e-05,
        -7.8813e-05, -4.6919e-04], device='cuda:1')
[rank: 13][epoch: 1][iter: 45] BEFORE:
tensor([ 7.7406e-05, -2.0773e-04,  6.5936e-04,  ..., -4.1084e-05,
        -4.4624e-05,  1.5740e-04], device='cuda:3')
[rank: 17][epoch: 1][iter: 45] BEFORE:
tensor([ 5.4427e-05,  3.0191e-05, -3.9936e-04,  ..., -6.1974e-05,
        -7.7517e-05,  1.2270e-04], device='cuda:1')
[rank: 3][epoch: 1][iter: 45] BEFORE:
tensor([-0.0002, -0.0006, -0.0002,  ..., -0.0007,  0.0001, -0.0002],
       device='cuda:1')tensor([ 0.0015, -0.0007,  0.0002,  ..., -0.0003,  0.0007, -0.0003],
       device='cuda:3')
[rank: 21][epoch: 1][iter: 45] BEFORE:
tensor([ 1.1788e-04,  2.2436e-04,  1.8465e-04,  ...,  4.9270e-04,
        -6.2936e-05, -1.0680e-04], device='cuda:1')
[rank: 7][epoch: 1][iter: 45] BEFORE:
tensor([-0.0001, -0.0001, -0.0001,  ...,  0.0004,  0.0002,  0.0004],
       device='cuda:3')
[rank: 9][epoch: 1][iter: 45] BEFORE:

[rank: 14][epoch: 1][iter: 45] BEFORE:
tensor([-1.7714e-03,  9.0491e-04, -1.8090e-03,  ...,  1.4429e-04,
        -6.1142e-05,  3.3089e-05], device='cuda:1')
[rank: 2][epoch: 1][iter: 45] BEFORE:
tensor([-1.2205e-04, -1.9712e-04, -2.8506e-05,  ..., -3.8150e-04,
         6.4188e-06,  7.8280e-04], device='cuda:2')
[rank: 11][epoch: 1][iter: 45] BEFORE:

[rank: 6][epoch: 1][iter: 45] BEFORE:
tensor([ 1.5547e-04, -7.1159e-05,  1.0831e-04,  ..., -1.7727e-04,
        -5.2240e-05, -2.0986e-04], device='cuda:2')
[rank: 15][epoch: 1][iter: 45] BEFORE:

[rank: 22][epoch: 1][iter: 45] BEFORE:
tensor([2.5885e-04, 2.5161e-04, 1.3806e-04,  ..., 7.6595e-05, 2.7942e-06,
        3.2398e-05], device='cuda:3')
[rank: 18][epoch: 1][iter: 45] BEFORE:
tensor([-1.5515e-04,  2.0117e-04, -8.8623e-05,  ..., -1.7349e-07,
         7.3423e-06, -3.7690e-05], device='cuda:2')
[rank: 0][epoch: 1][iter: 45] AFTER HANDLE:

[rank: 13][epoch: 1][iter: 45] AFTER HANDLE:

[rank: 20][epoch: 1][iter: 45] AFTER HANDLE:

[rank: 10][epoch: 1][iter: 45] AFTER HANDLE:

[rank: 19][epoch: 1][iter: 45] BEFORE:

[rank: 4][epoch: 1][iter: 45] AFTER HANDLE:

[rank: 1][epoch: 1][iter: 45] AFTER HANDLE:

[rank: 12][epoch: 1][iter: 45] AFTER HANDLE:

[rank: 23][epoch: 1][iter: 45] AFTER HANDLE:

[rank: 8][epoch: 1][iter: 45] AFTER HANDLE:

[rank: 16][epoch: 1][iter: 45] AFTER HANDLE:

[rank: 5][epoch: 1][iter: 45] AFTER HANDLE:

[rank: 3][epoch: 1][iter: 45] AFTER HANDLE:

[rank: 14][epoch: 1][iter: 45] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 45] AFTER HANDLE:

[rank: 9][epoch: 1][iter: 45] AFTER HANDLE:

[rank: 17][epoch: 1][iter: 45] AFTER HANDLE:

[rank: 7][epoch: 1][iter: 45] AFTER HANDLE:

[rank: 2][epoch: 1][iter: 45] AFTER HANDLE:
tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:3')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:2')
[rank: 11][epoch: 1][iter: 45] AFTER HANDLE:
tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:2')
[rank: 6][epoch: 1][iter: 45] AFTER HANDLE:
tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:0')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:1')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:0')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:2')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:3')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:0')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:1')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:0')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:3')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:0')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:0')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:1')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:3')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:2')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:1')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:1')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:1')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:3')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:2')
[rank: 15][epoch: 1][iter: 45] AFTER HANDLE:

[rank: 22][epoch: 1][iter: 45] AFTER HANDLE:
tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:3')
[rank: 18][epoch: 1][iter: 45] AFTER HANDLE:
tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:2')
[rank: 0][epoch: 1][iter: 45] NEW GRAD:

[rank: 13][epoch: 1][iter: 45] NEW GRAD:

[rank: 20][epoch: 1][iter: 45] NEW GRAD:

[rank: 10][epoch: 1][iter: 45] NEW GRAD:

[rank: 19][epoch: 1][iter: 45] AFTER HANDLE:

[rank: 4][epoch: 1][iter: 45] NEW GRAD:

[rank: 1][epoch: 1][iter: 45] NEW GRAD:

[rank: 12][epoch: 1][iter: 45] NEW GRAD:

[rank: 23][epoch: 1][iter: 45] NEW GRAD:

[rank: 8][epoch: 1][iter: 45] NEW GRAD:

[rank: 16][epoch: 1][iter: 45] NEW GRAD:

[rank: 5][epoch: 1][iter: 45] NEW GRAD:

[rank: 3][epoch: 1][iter: 45] NEW GRAD:

[rank: 14][epoch: 1][iter: 45] NEW GRAD:

[rank: 21][epoch: 1][iter: 45] NEW GRAD:

[rank: 9][epoch: 1][iter: 45] NEW GRAD:

[rank: 17][epoch: 1][iter: 45] NEW GRAD:

[rank: 7][epoch: 1][iter: 45] NEW GRAD:

[rank: 2][epoch: 1][iter: 45] NEW GRAD:
tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:3')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:2')
[rank: 11][epoch: 1][iter: 45] NEW GRAD:
tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:2')
[rank: 6][epoch: 1][iter: 45] NEW GRAD:
tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:0')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:1')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:0')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:2')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:3')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:0')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:1')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:0')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:3')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:0')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:0')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:1')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:3')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:2')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:1')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:1')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:1')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:3')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:2')
[rank: 15][epoch: 1][iter: 45] NEW GRAD:

[rank: 22][epoch: 1][iter: 45] NEW GRAD:
tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:3')
[rank: 18][epoch: 1][iter: 45] NEW GRAD:
tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:2')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:3')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:2')
[rank: 19][epoch: 1][iter: 45] NEW GRAD:
tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:2')tensor([-5.9678e-06,  1.0814e-05,  1.1144e-05,  ..., -1.0101e-04,
        -2.9780e-04, -1.3890e-04], device='cuda:3')
[rank: 0][epoch: 1][iter: 46] BEFORE:
tensor([ 8.9650e-05,  5.8358e-05,  1.7616e-04,  ..., -8.0271e-05,
        -2.1082e-05,  1.3907e-04], device='cuda:0')
[rank: 13][epoch: 1][iter: 46] BEFORE:
tensor([-8.9524e-05, -1.6457e-04,  2.6095e-04,  ..., -1.6676e-04,
        -4.2848e-04, -3.4616e-04], device='cuda:1')
[rank: 20][epoch: 1][iter: 46] BEFORE:

[rank: 10][epoch: 1][iter: 46] BEFORE:
tensor([-6.7011e-05, -1.3301e-04,  1.2140e-05,  ..., -1.3058e-03,
         5.3349e-04,  2.9680e-04], device='cuda:0')tensor([ 1.0567e-03,  9.3357e-04,  3.1716e-04,  ..., -3.3625e-04,
        -2.2935e-04,  1.9552e-05], device='cuda:2')
[rank: 1][epoch: 1][iter: 46] BEFORE:

[rank: 4][epoch: 1][iter: 46] BEFORE:
tensor([-2.0055e-05,  9.5086e-06,  1.1725e-04,  ...,  3.6176e-05,
        -3.1961e-05, -7.2215e-06], device='cuda:1')tensor([-2.0650e-04, -4.8300e-04, -2.1487e-04,  ..., -1.5063e-05,
        -1.3264e-04, -1.1818e-04], device='cuda:0')
[rank: 12][epoch: 1][iter: 46] BEFORE:

[rank: 16][epoch: 1][iter: 46] BEFORE:
tensor([-2.3437e-04,  1.1822e-05,  1.1851e-05,  ..., -3.7561e-05,
        -1.5160e-04, -9.4172e-05], device='cuda:0')
[rank: 8][epoch: 1][iter: 46] BEFORE:
tensor([ 9.4398e-05,  8.6474e-04,  1.5704e-04,  ..., -7.9450e-05,
        -1.0048e-07, -3.0803e-05], device='cuda:0')
[rank: 23][epoch: 1][iter: 46] BEFORE:
tensor([-8.3144e-05,  8.6163e-05, -7.0129e-05,  ...,  2.2903e-04,
         2.2922e-04, -1.4880e-04], device='cuda:0')
[rank: 3][epoch: 1][iter: 46] BEFORE:
tensor([-1.6862e-04, -3.8784e-04, -1.5887e-04,  ...,  9.5528e-05,
        -5.6211e-05, -1.3105e-05], device='cuda:3')
[rank: 5][epoch: 1][iter: 46] BEFORE:

[rank: 14][epoch: 1][iter: 46] BEFORE:
tensor([ 1.4036e-04,  8.9843e-04,  6.8533e-04,  ..., -4.3451e-05,
         9.6996e-05,  1.9086e-05], device='cuda:3')
[rank: 17][epoch: 1][iter: 46] BEFORE:
tensor([ 1.1697e-05, -1.5026e-05, -2.8802e-05,  ..., -1.2027e-05,
        -2.3759e-05, -1.0613e-05], device='cuda:1')
[rank: 21][epoch: 1][iter: 46] BEFORE:
tensor([ 6.4268e-06, -7.3385e-05, -7.4072e-05,  ...,  9.1666e-05,
        -2.1299e-04, -1.2555e-04], device='cuda:2')
[rank: 7][epoch: 1][iter: 46] BEFORE:
tensor([-3.6736e-04, -3.2266e-04,  4.3561e-04,  ..., -1.4362e-04,
        -2.9490e-04,  1.4217e-05], device='cuda:1')
[rank: 9][epoch: 1][iter: 46] BEFORE:
tensor([-9.1784e-05, -1.3802e-04,  1.0216e-04,  ..., -2.8819e-04,
        -6.9134e-05, -1.0413e-06], device='cuda:1')
[rank: 2][epoch: 1][iter: 46] BEFORE:
tensor([-5.3099e-05, -5.2503e-05,  4.4117e-05,  ..., -1.7357e-04,
         1.3989e-04, -9.9422e-05], device='cuda:3')tensor([-2.3792e-04, -8.4957e-06, -6.0065e-05,  ..., -2.2041e-03,
        -1.1803e-03, -9.6436e-04], device='cuda:1')
[rank: 22][epoch: 1][iter: 46] BEFORE:
tensor([ 1.2823e-04,  1.2296e-04,  9.0679e-05,  ...,  2.2601e-04,
        -8.3776e-05, -8.5993e-05], device='cuda:2')
[rank: 11][epoch: 1][iter: 46] BEFORE:

[rank: 19][epoch: 1][iter: 46] BEFORE:

[rank: 15][epoch: 1][iter: 46] BEFORE:
tensor([ 5.4587e-06,  5.0979e-06, -1.1393e-06,  ...,  2.8427e-05,
        -9.6156e-05,  5.4111e-05], device='cuda:2')tensor([-7.0334e-05, -4.0238e-05, -6.4629e-05,  ...,  1.2851e-03,
        -1.2186e-04, -1.1352e-03], device='cuda:3')
[rank: 18][epoch: 1][iter: 46] BEFORE:
tensor([ 2.1220e-04,  9.0525e-05,  1.6725e-04,  ...,  7.8895e-06,
        -2.6358e-04, -5.3213e-05], device='cuda:3')tensor([-1.0728e-04, -2.0029e-04,  7.7331e-05,  ..., -1.9445e-04,
        -8.5580e-05,  1.7618e-04], device='cuda:3')
[rank: 6][epoch: 1][iter: 46] BEFORE:

[rank: 0][epoch: 1][iter: 46] AFTER HANDLE:

[rank: 10][epoch: 1][iter: 46] AFTER HANDLE:

[rank: 20][epoch: 1][iter: 46] AFTER HANDLE:

[rank: 13][epoch: 1][iter: 46] AFTER HANDLE:
tensor([ 1.5706e-05,  4.6388e-06,  3.7775e-05,  ...,  1.1766e-04,
        -7.8172e-05, -5.4042e-05], device='cuda:2')
[rank: 5][epoch: 1][iter: 46] AFTER HANDLE:

[rank: 1][epoch: 1][iter: 46] AFTER HANDLE:

[rank: 9][epoch: 1][iter: 46] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 46] AFTER HANDLE:

[rank: 12][epoch: 1][iter: 46] AFTER HANDLE:

[rank: 16][epoch: 1][iter: 46] AFTER HANDLE:

[rank: 4][epoch: 1][iter: 46] AFTER HANDLE:

[rank: 3][epoch: 1][iter: 46] AFTER HANDLE:

[rank: 8][epoch: 1][iter: 46] AFTER HANDLE:

[rank: 23][epoch: 1][iter: 46] AFTER HANDLE:

[rank: 14][epoch: 1][iter: 46] AFTER HANDLE:

[rank: 17][epoch: 1][iter: 46] AFTER HANDLE:

[rank: 7][epoch: 1][iter: 46] AFTER HANDLE:

[rank: 2][epoch: 1][iter: 46] AFTER HANDLE:

[rank: 11][epoch: 1][iter: 46] AFTER HANDLE:

[rank: 22][epoch: 1][iter: 46] AFTER HANDLE:

[rank: 15][epoch: 1][iter: 46] AFTER HANDLE:

[rank: 19][epoch: 1][iter: 46] AFTER HANDLE:
tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:2')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:0')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:2')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:0')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:1')
[rank: 18][epoch: 1][iter: 46] AFTER HANDLE:
tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:1')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:1')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:1')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:1')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:0')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:0')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:0')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:3')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:0')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:3')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:2')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:1')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:3')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:2')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:3')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:2')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:3')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:3')
[rank: 6][epoch: 1][iter: 46] AFTER HANDLE:

[rank: 0][epoch: 1][iter: 46] NEW GRAD:

[rank: 10][epoch: 1][iter: 46] NEW GRAD:

[rank: 20][epoch: 1][iter: 46] NEW GRAD:

[rank: 13][epoch: 1][iter: 46] NEW GRAD:
tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:2')
[rank: 5][epoch: 1][iter: 46] NEW GRAD:

[rank: 1][epoch: 1][iter: 46] NEW GRAD:

[rank: 9][epoch: 1][iter: 46] NEW GRAD:

[rank: 21][epoch: 1][iter: 46] NEW GRAD:

[rank: 12][epoch: 1][iter: 46] NEW GRAD:

[rank: 16][epoch: 1][iter: 46] NEW GRAD:

[rank: 4][epoch: 1][iter: 46] NEW GRAD:

[rank: 3][epoch: 1][iter: 46] NEW GRAD:

[rank: 8][epoch: 1][iter: 46] NEW GRAD:

[rank: 23][epoch: 1][iter: 46] NEW GRAD:

[rank: 14][epoch: 1][iter: 46] NEW GRAD:

[rank: 17][epoch: 1][iter: 46] NEW GRAD:

[rank: 7][epoch: 1][iter: 46] NEW GRAD:

[rank: 2][epoch: 1][iter: 46] NEW GRAD:

[rank: 11][epoch: 1][iter: 46] NEW GRAD:

[rank: 22][epoch: 1][iter: 46] NEW GRAD:

[rank: 15][epoch: 1][iter: 46] NEW GRAD:

[rank: 19][epoch: 1][iter: 46] NEW GRAD:
tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:2')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:0')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:2')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:0')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:1')
[rank: 18][epoch: 1][iter: 46] NEW GRAD:
tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:1')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:1')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:1')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:1')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:0')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:0')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:0')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:3')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:0')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:3')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:2')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:1')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:3')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:2')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:3')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:2')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:3')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:3')
[rank: 6][epoch: 1][iter: 46] NEW GRAD:
tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:2')tensor([ 2.8857e-06,  4.6074e-05,  8.5480e-05,  ..., -1.1998e-04,
        -1.0327e-04, -1.4388e-04], device='cuda:2')
[rank: 10][epoch: 1][iter: 47] BEFORE:
tensor([-0.0004, -0.0001, -0.0002,  ..., -0.0003, -0.0005, -0.0001],
       device='cuda:2')
[rank: 0][epoch: 1][iter: 47] BEFORE:
tensor([-2.2500e-04, -8.2323e-05, -2.2809e-04,  ..., -1.7480e-04,
        -1.4502e-04, -1.6173e-04], device='cuda:0')
[rank: 13][epoch: 1][iter: 47] BEFORE:

[rank: 20][epoch: 1][iter: 47] BEFORE:
tensor([ 1.7333e-06, -8.9788e-05,  2.0097e-05,  ...,  1.3686e-05,
         6.6427e-06, -2.4777e-06], device='cuda:1')
[rank: 1][epoch: 1][iter: 47] BEFORE:
tensor([-1.9346e-04,  6.2251e-04, -1.9570e-04,  ...,  4.1083e-05,
         4.0694e-05,  1.5738e-04], device='cuda:0')
[rank: 5][epoch: 1][iter: 47] BEFORE:

[rank: 9][epoch: 1][iter: 47] BEFORE:
tensor([ 1.8907e-05, -1.5053e-04,  1.2365e-04,  ...,  2.1473e-04,
         2.5294e-04,  2.5754e-04], device='cuda:1')tensor([ 5.2278e-05,  5.2350e-05,  3.9310e-05,  ..., -1.2947e-04,
        -6.8278e-05, -1.3059e-04], device='cuda:1')
[rank: 16][epoch: 1][iter: 47] BEFORE:
tensor([-7.1184e-04, -1.1938e-04, -6.2378e-04,  ...,  7.1408e-06,
        -2.1602e-05,  1.9843e-06], device='cuda:1')
[rank: 3][epoch: 1][iter: 47] BEFORE:

[rank: 4][epoch: 1][iter: 47] BEFORE:
tensor([ 5.2303e-05,  5.6150e-04,  5.4076e-05,  ...,  1.3666e-04,
        -4.4573e-04,  3.7643e-05], device='cuda:0')
[rank: 21][epoch: 1][iter: 47] BEFORE:

[rank: 8][epoch: 1][iter: 47] BEFORE:
tensor([ 1.7941e-04,  4.3750e-05,  1.2297e-04,  ...,  1.2232e-04,
         1.5392e-05, -5.4326e-05], device='cuda:3')tensor([-1.1552e-03,  7.3747e-04, -1.5553e-04,  ..., -7.0199e-05,
        -1.4970e-04,  5.2135e-05], device='cuda:0')tensor([ 6.7717e-05,  7.8160e-05, -1.6946e-04,  ...,  5.2116e-05,
         4.8934e-05, -1.2357e-04], device='cuda:1')tensor([ 1.9967e-04,  2.0234e-04,  1.9793e-04,  ...,  2.7363e-04,
        -9.1753e-05,  5.5244e-04], device='cuda:0')
[rank: 14][epoch: 1][iter: 47] BEFORE:

[rank: 23][epoch: 1][iter: 47] BEFORE:

[rank: 17][epoch: 1][iter: 47] BEFORE:

[rank: 12][epoch: 1][iter: 47] BEFORE:

[rank: 7][epoch: 1][iter: 47] BEFORE:
tensor([-2.3824e-04, -6.3628e-05, -8.3600e-05,  ...,  4.9950e-05,
         2.3095e-04,  1.5479e-05], device='cuda:3')
[rank: 11][epoch: 1][iter: 47] BEFORE:
tensor([ 6.1876e-04, -3.3758e-04, -7.3708e-05,  ..., -7.5047e-05,
        -1.7159e-04, -6.5870e-05], device='cuda:2')tensor([ 1.6407e-04,  2.6149e-04, -2.4691e-05,  ...,  1.5432e-04,
         2.9205e-04, -2.1440e-05], device='cuda:1')
[rank: 2][epoch: 1][iter: 47] BEFORE:
tensor([ 1.5607e-04,  4.1187e-05,  3.3957e-04,  ...,  5.3959e-05,
        -4.4865e-05,  1.3664e-05], device='cuda:3')tensor([-3.9939e-04,  4.7206e-04, -3.9473e-04,  ..., -5.8931e-07,
         6.4662e-06,  6.6037e-06], device='cuda:3')tensor([-2.5825e-05, -7.6240e-05,  4.2802e-05,  ..., -1.8260e-05,
        -2.7295e-04,  1.0822e-04], device='cuda:0')
[rank: 19][epoch: 1][iter: 47] BEFORE:

[rank: 6][epoch: 1][iter: 47] BEFORE:
tensor([-1.4999e-04,  1.3196e-04,  1.2201e-04,  ...,  1.0765e-04,
        -1.2469e-04,  9.2051e-05], device='cuda:2')
[rank: 15][epoch: 1][iter: 47] BEFORE:

[rank: 22][epoch: 1][iter: 47] BEFORE:
tensor([-1.5566e-04, -1.5761e-04, -1.0025e-04,  ..., -1.5579e-04,
         1.0915e-04, -6.4537e-05], device='cuda:3')tensor([ 4.0013e-05, -7.4340e-05,  2.5273e-05,  ...,  8.1115e-05,
         1.2062e-05, -2.5546e-04], device='cuda:2')
[rank: 0][epoch: 1][iter: 47] AFTER HANDLE:

[rank: 8][epoch: 1][iter: 47] AFTER HANDLE:

[rank: 14][epoch: 1][iter: 47] AFTER HANDLE:

[rank: 23][epoch: 1][iter: 47] AFTER HANDLE:

[rank: 18][epoch: 1][iter: 47] BEFORE:

[rank: 5][epoch: 1][iter: 47] AFTER HANDLE:

[rank: 2][epoch: 1][iter: 47] AFTER HANDLE:

[rank: 11][epoch: 1][iter: 47] AFTER HANDLE:

[rank: 12][epoch: 1][iter: 47] AFTER HANDLE:

[rank: 20][epoch: 1][iter: 47] AFTER HANDLE:

[rank: 16][epoch: 1][iter: 47] AFTER HANDLE:

[rank: 7][epoch: 1][iter: 47] AFTER HANDLE:

[rank: 1][epoch: 1][iter: 47] AFTER HANDLE:

[rank: 9][epoch: 1][iter: 47] AFTER HANDLE:

[rank: 13][epoch: 1][iter: 47] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 47] AFTER HANDLE:

[rank: 17][epoch: 1][iter: 47] AFTER HANDLE:

[rank: 4][epoch: 1][iter: 47] AFTER HANDLE:

[rank: 3][epoch: 1][iter: 47] AFTER HANDLE:

[rank: 10][epoch: 1][iter: 47] AFTER HANDLE:
tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:3')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:2')
[rank: 19][epoch: 1][iter: 47] AFTER HANDLE:

[rank: 6][epoch: 1][iter: 47] AFTER HANDLE:
tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:0')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:0')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:2')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:3')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:2')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:1')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:2')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:3')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:0')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:0')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:0')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:3')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:1')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:1')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:1')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:1')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:1')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:0')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:3')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:2')
[rank: 15][epoch: 1][iter: 47] AFTER HANDLE:

[rank: 22][epoch: 1][iter: 47] AFTER HANDLE:
tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:3')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:2')
[rank: 0][epoch: 1][iter: 47] NEW GRAD:

[rank: 8][epoch: 1][iter: 47] NEW GRAD:

[rank: 14][epoch: 1][iter: 47] NEW GRAD:

[rank: 23][epoch: 1][iter: 47] NEW GRAD:

[rank: 18][epoch: 1][iter: 47] AFTER HANDLE:

[rank: 5][epoch: 1][iter: 47] NEW GRAD:

[rank: 2][epoch: 1][iter: 47] NEW GRAD:

[rank: 11][epoch: 1][iter: 47] NEW GRAD:

[rank: 12][epoch: 1][iter: 47] NEW GRAD:

[rank: 20][epoch: 1][iter: 47] NEW GRAD:

[rank: 16][epoch: 1][iter: 47] NEW GRAD:

[rank: 7][epoch: 1][iter: 47] NEW GRAD:

[rank: 1][epoch: 1][iter: 47] NEW GRAD:

[rank: 9][epoch: 1][iter: 47] NEW GRAD:

[rank: 13][epoch: 1][iter: 47] NEW GRAD:

[rank: 21][epoch: 1][iter: 47] NEW GRAD:

[rank: 17][epoch: 1][iter: 47] NEW GRAD:

[rank: 4][epoch: 1][iter: 47] NEW GRAD:

[rank: 3][epoch: 1][iter: 47] NEW GRAD:

[rank: 10][epoch: 1][iter: 47] NEW GRAD:
tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:3')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:2')
[rank: 19][epoch: 1][iter: 47] NEW GRAD:

[rank: 6][epoch: 1][iter: 47] NEW GRAD:
tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:0')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:0')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:2')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:3')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:2')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:1')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:2')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:3')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:0')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:0')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:0')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:3')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:1')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:1')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:1')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:1')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:1')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:0')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:3')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:2')
[rank: 15][epoch: 1][iter: 47] NEW GRAD:

[rank: 22][epoch: 1][iter: 47] NEW GRAD:
tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:3')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:2')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:3')tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:2')
[rank: 18][epoch: 1][iter: 47] NEW GRAD:
tensor([-8.7078e-05,  8.4900e-05, -6.8481e-05,  ...,  8.1611e-06,
        -4.7723e-05,  3.0798e-05], device='cuda:2')
[rank: 0][epoch: 1][iter: 48] BEFORE:

[rank: 8][epoch: 1][iter: 48] BEFORE:
tensor([7.9623e-05, 1.6831e-04, 7.4553e-05,  ..., 4.5838e-04, 2.9676e-04,
        6.8518e-05], device='cuda:0')tensor([ 1.2643e-04,  8.6878e-05, -1.0183e-04,  ..., -5.0054e-05,
        -2.5205e-04,  1.1828e-04], device='cuda:0')
[rank: 23][epoch: 1][iter: 48] BEFORE:

[rank: 14][epoch: 1][iter: 48] BEFORE:
tensor([-0.0001,  0.0006, -0.0002,  ..., -0.0004, -0.0002, -0.0003],
       device='cuda:3')
[rank: 11][epoch: 1][iter: 48] BEFORE:
tensor([-4.1135e-05,  4.5920e-04, -4.6089e-04,  ..., -3.0505e-04,
         3.4813e-05, -6.2284e-05], device='cuda:2')
[rank: 2][epoch: 1][iter: 48] BEFORE:
tensor([-4.2723e-07,  3.4495e-07,  9.3733e-07,  ..., -8.5729e-06,
        -1.0568e-05,  2.6673e-06], device='cuda:3')tensor([ 4.4110e-04, -4.0136e-04, -1.8350e-04,  ..., -6.1995e-05,
        -4.7563e-05, -1.4701e-04], device='cuda:2')
[rank: 5][epoch: 1][iter: 48] BEFORE:

[rank: 20][epoch: 1][iter: 48] BEFORE:

[rank: 12][epoch: 1][iter: 48] BEFORE:
tensor([-3.5303e-04, -6.9859e-05, -5.7318e-05,  ...,  2.3346e-04,
         1.1353e-04, -5.6000e-04], device='cuda:1')
[rank: 16][epoch: 1][iter: 48] BEFORE:
tensor([ 1.5457e-04,  1.2057e-05, -3.0282e-04,  ..., -6.9518e-05,
        -7.1773e-05, -7.7782e-05], device='cuda:0')tensor([ 3.9785e-05, -1.6872e-04,  7.9283e-05,  ...,  1.1415e-04,
         8.8592e-05,  4.2182e-06], device='cuda:0')
[rank: 1][epoch: 1][iter: 48] BEFORE:

[rank: 7][epoch: 1][iter: 48] BEFORE:
tensor([ 2.3313e-04,  3.2107e-04,  1.0465e-03,  ..., -2.3856e-06,
         1.4212e-06,  5.5103e-07], device='cuda:0')
[rank: 9][epoch: 1][iter: 48] BEFORE:

[rank: 13][epoch: 1][iter: 48] BEFORE:
tensor([-8.0941e-05, -2.2650e-05,  2.3750e-05,  ..., -1.8008e-06,
        -5.8685e-05, -9.9078e-05], device='cuda:1')tensor([ 9.1540e-05,  1.1625e-04,  9.5104e-05,  ...,  1.2184e-05,
        -1.0298e-04, -5.0693e-05], device='cuda:3')
[rank: 17][epoch: 1][iter: 48] BEFORE:

[rank: 21][epoch: 1][iter: 48] BEFORE:
tensor([-3.0504e-05,  7.6009e-05, -2.1551e-05,  ..., -1.6906e-04,
        -2.8576e-04, -4.0380e-05], device='cuda:1')
[rank: 3][epoch: 1][iter: 48] BEFORE:
tensor([-2.1000e-05,  1.3407e-06,  1.3435e-06,  ...,  8.3878e-06,
         1.6411e-04,  1.6340e-04], device='cuda:1')
[rank: 4][epoch: 1][iter: 48] BEFORE:
tensor([ 7.5424e-05, -1.3947e-04,  1.0548e-04,  ...,  4.7800e-05,
         8.5731e-05,  1.6526e-04], device='cuda:1')tensor([ 6.8731e-04,  9.2752e-05, -4.4863e-04,  ...,  3.5486e-04,
        -2.1148e-04, -1.5379e-04], device='cuda:1')
[rank: 10][epoch: 1][iter: 48] BEFORE:
tensor([ 6.5269e-05,  1.9616e-04, -1.9055e-05,  ...,  9.9845e-05,
         2.5556e-04,  3.2568e-04], device='cuda:3')tensor([-9.8547e-05, -5.4910e-04, -2.4577e-04,  ..., -1.9011e-04,
        -1.3933e-04,  1.3070e-03], device='cuda:0')
[rank: 19][epoch: 1][iter: 48] BEFORE:

[rank: 22][epoch: 1][iter: 48] BEFORE:
tensor([-2.8828e-04, -2.0086e-04, -2.5051e-04,  ...,  4.4999e-04,
        -9.5408e-05, -3.7982e-05], device='cuda:2')
[rank: 6][epoch: 1][iter: 48] BEFORE:

[rank: 0][epoch: 1][iter: 48] AFTER HANDLE:

[rank: 12][epoch: 1][iter: 48] AFTER HANDLE:

[rank: 18][epoch: 1][iter: 48] BEFORE:

[rank: 21][epoch: 1][iter: 48] AFTER HANDLE:

[rank: 8][epoch: 1][iter: 48] AFTER HANDLE:

[rank: 5][epoch: 1][iter: 48] AFTER HANDLE:

[rank: 1][epoch: 1][iter: 48] AFTER HANDLE:

[rank: 13][epoch: 1][iter: 48] AFTER HANDLE:

[rank: 16][epoch: 1][iter: 48] AFTER HANDLE:

[rank: 23][epoch: 1][iter: 48] AFTER HANDLE:

[rank: 9][epoch: 1][iter: 48] AFTER HANDLE:

[rank: 4][epoch: 1][iter: 48] AFTER HANDLE:

[rank: 3][epoch: 1][iter: 48] AFTER HANDLE:

[rank: 14][epoch: 1][iter: 48] AFTER HANDLE:

[rank: 17][epoch: 1][iter: 48] AFTER HANDLE:

[rank: 20][epoch: 1][iter: 48] AFTER HANDLE:

[rank: 11][epoch: 1][iter: 48] AFTER HANDLE:

[rank: 7][epoch: 1][iter: 48] AFTER HANDLE:

[rank: 2][epoch: 1][iter: 48] AFTER HANDLE:

[rank: 15][epoch: 1][iter: 48] BEFORE:
tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:3')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:2')
[rank: 10][epoch: 1][iter: 48] AFTER HANDLE:
tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:2')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:0')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:0')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:2')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:1')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:0')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:1')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:1')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:1')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:0')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:3')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:1')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:0')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:3')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:2')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:1')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:0')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:3')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:3')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:2')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:3')
[rank: 19][epoch: 1][iter: 48] AFTER HANDLE:

[rank: 22][epoch: 1][iter: 48] AFTER HANDLE:
tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:2')
[rank: 6][epoch: 1][iter: 48] AFTER HANDLE:

[rank: 0][epoch: 1][iter: 48] NEW GRAD:

[rank: 12][epoch: 1][iter: 48] NEW GRAD:

[rank: 18][epoch: 1][iter: 48] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 48] NEW GRAD:

[rank: 8][epoch: 1][iter: 48] NEW GRAD:

[rank: 5][epoch: 1][iter: 48] NEW GRAD:

[rank: 1][epoch: 1][iter: 48] NEW GRAD:

[rank: 13][epoch: 1][iter: 48] NEW GRAD:

[rank: 16][epoch: 1][iter: 48] NEW GRAD:

[rank: 23][epoch: 1][iter: 48] NEW GRAD:

[rank: 9][epoch: 1][iter: 48] NEW GRAD:

[rank: 4][epoch: 1][iter: 48] NEW GRAD:

[rank: 3][epoch: 1][iter: 48] NEW GRAD:

[rank: 14][epoch: 1][iter: 48] NEW GRAD:

[rank: 17][epoch: 1][iter: 48] NEW GRAD:

[rank: 20][epoch: 1][iter: 48] NEW GRAD:

[rank: 11][epoch: 1][iter: 48] NEW GRAD:

[rank: 7][epoch: 1][iter: 48] NEW GRAD:

[rank: 2][epoch: 1][iter: 48] NEW GRAD:

[rank: 15][epoch: 1][iter: 48] AFTER HANDLE:
tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:3')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:2')
[rank: 10][epoch: 1][iter: 48] NEW GRAD:
tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:2')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:0')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:0')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:2')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:1')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:0')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:1')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:1')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:1')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:0')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:3')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:1')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:0')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:3')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:2')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:1')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:0')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:3')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:3')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:2')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:3')
[rank: 19][epoch: 1][iter: 48] NEW GRAD:

[rank: 22][epoch: 1][iter: 48] NEW GRAD:
tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:2')
[rank: 6][epoch: 1][iter: 48] NEW GRAD:

[rank: 15][epoch: 1][iter: 48] NEW GRAD:

[rank: 18][epoch: 1][iter: 48] NEW GRAD:
tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:2')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:2')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:3')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:3')tensor([ 4.0561e-05,  7.0204e-05, -5.5512e-05,  ...,  3.5491e-05,
        -9.8037e-05,  2.8539e-05], device='cuda:2')
[rank: 0][epoch: 1][iter: 49] BEFORE:
tensor([-4.6458e-05,  5.1243e-05,  1.1568e-05,  ..., -6.8447e-04,
        -1.4989e-04, -2.9089e-04], device='cuda:0')
[rank: 12][epoch: 1][iter: 49] BEFORE:

[rank: 8][epoch: 1][iter: 49] BEFORE:
tensor([-1.3687e-05, -1.3899e-05, -1.5827e-05,  ...,  2.0310e-04,
         7.2049e-05,  6.2305e-05], device='cuda:0')
[rank: 21][epoch: 1][iter: 49] BEFORE:
tensor([-2.2154e-05, -1.0439e-04,  1.6944e-04,  ...,  3.0271e-05,
         4.7343e-05,  2.1253e-05], device='cuda:0')tensor([ 9.8055e-06,  2.6678e-04,  1.2504e-03,  ...,  9.0211e-04,
        -1.0822e-04, -8.1747e-05], device='cuda:1')
[rank: 5][epoch: 1][iter: 49] BEFORE:
tensor([-4.0130e-04, -4.7742e-04, -5.1339e-04,  ...,  1.5512e-04,
         5.2999e-06,  1.9561e-04], device='cuda:1')
[rank: 1][epoch: 1][iter: 49] BEFORE:

[rank: 13][epoch: 1][iter: 49] BEFORE:
tensor([-3.2810e-04,  8.6067e-05, -1.2072e-04,  ..., -1.9560e-05,
        -1.8263e-05, -1.5684e-05], device='cuda:1')tensor([ 1.1382e-04, -1.1971e-04, -3.7172e-04,  ...,  6.5132e-04,
        -5.7288e-05,  1.2528e-04], device='cuda:1')
[rank: 16][epoch: 1][iter: 49] BEFORE:

[rank: 23][epoch: 1][iter: 49] BEFORE:
tensor([-7.2811e-04, -2.4502e-04, -2.6282e-04,  ..., -3.7466e-05,
         1.7314e-05, -6.1711e-05], device='cuda:0')tensor([1.3671e-04, 2.3048e-05, 7.5600e-04,  ..., 8.2006e-05, 1.2284e-05,
        3.7363e-06], device='cuda:3')
[rank: 9][epoch: 1][iter: 49] BEFORE:

[rank: 3][epoch: 1][iter: 49] BEFORE:
tensor([-1.9112e-06,  2.7751e-05, -1.8941e-06,  ...,  1.3646e-05,
        -2.9223e-06, -7.3999e-04], device='cuda:1')
[rank: 4][epoch: 1][iter: 49] BEFORE:
tensor([ 2.0348e-04, -5.3830e-05,  7.3116e-05,  ...,  1.1321e-04,
         2.4430e-05,  8.4334e-06], device='cuda:3')tensor([-5.5593e-04, -2.4870e-04,  3.5520e-05,  ...,  8.2924e-05,
         8.8478e-05, -1.4302e-03], device='cuda:0')
[rank: 17][epoch: 1][iter: 49] BEFORE:

[rank: 14][epoch: 1][iter: 49] BEFORE:

[rank: 11][epoch: 1][iter: 49] BEFORE:
tensor([ 9.1537e-05, -1.4489e-03, -2.7554e-04,  ..., -8.2061e-05,
         2.6091e-04,  3.6475e-04], device='cuda:1')
[rank: 20][epoch: 1][iter: 49] BEFORE:
tensor([ 2.8787e-05,  4.5904e-05, -1.5241e-05,  ...,  2.6468e-04,
        -2.4622e-04,  7.3084e-04], device='cuda:2')tensor([-3.8989e-05, -4.9474e-05,  6.2825e-05,  ...,  1.6629e-04,
        -4.7785e-05, -3.2876e-05], device='cuda:3')
[rank: 7][epoch: 1][iter: 49] BEFORE:
tensor([ 3.0094e-06, -2.1826e-07,  2.6210e-06,  ..., -1.4712e-05,
        -9.9911e-06,  4.2054e-05], device='cuda:0')
[rank: 10][epoch: 1][iter: 49] BEFORE:

[rank: 2][epoch: 1][iter: 49] BEFORE:
tensor([ 4.6682e-04, -6.7011e-05, -1.5782e-03,  ..., -7.4299e-04,
        -1.8357e-05, -2.6848e-04], device='cuda:3')tensor([-6.0369e-05,  3.0950e-04,  3.6858e-05,  ...,  2.5632e-04,
         3.5676e-04,  4.1155e-04], device='cuda:2')
[rank: 6][epoch: 1][iter: 49] BEFORE:
tensor([-7.5420e-05, -5.5252e-05,  1.2698e-04,  ...,  4.8332e-05,
        -3.8283e-05,  5.7156e-05], device='cuda:2')
[rank: 19][epoch: 1][iter: 49] BEFORE:

[rank: 15][epoch: 1][iter: 49] BEFORE:
tensor([ 2.1556e-05,  5.9651e-05,  2.9387e-05,  ..., -6.2636e-06,
        -2.9673e-05, -4.7174e-05], device='cuda:2')tensor([-2.0708e-05, -1.8618e-05,  6.2936e-06,  ..., -4.5646e-05,
        -1.1605e-04,  3.0308e-04], device='cuda:3')
[rank: 22][epoch: 1][iter: 49] BEFORE:
tensor([ 2.8459e-05,  2.3832e-05, -2.9068e-05,  ..., -1.0341e-04,
         3.0822e-04,  3.3021e-04], device='cuda:3')
[rank: 18][epoch: 1][iter: 49] BEFORE:

[rank: 0][epoch: 1][iter: 49] AFTER HANDLE:

[rank: 9][epoch: 1][iter: 49] AFTER HANDLE:

[rank: 5][epoch: 1][iter: 49] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 49] AFTER HANDLE:

[rank: 13][epoch: 1][iter: 49] AFTER HANDLE:

[rank: 16][epoch: 1][iter: 49] AFTER HANDLE:

[rank: 1][epoch: 1][iter: 49] AFTER HANDLE:

[rank: 8][epoch: 1][iter: 49] AFTER HANDLE:

[rank: 7][epoch: 1][iter: 49] AFTER HANDLE:

[rank: 20][epoch: 1][iter: 49] AFTER HANDLE:

[rank: 12][epoch: 1][iter: 49] AFTER HANDLE:

[rank: 17][epoch: 1][iter: 49] AFTER HANDLE:

[rank: 3][epoch: 1][iter: 49] AFTER HANDLE:

[rank: 11][epoch: 1][iter: 49] AFTER HANDLE:

[rank: 4][epoch: 1][iter: 49] AFTER HANDLE:

[rank: 23][epoch: 1][iter: 49] AFTER HANDLE:

[rank: 14][epoch: 1][iter: 49] AFTER HANDLE:

[rank: 19][epoch: 1][iter: 49] AFTER HANDLE:

[rank: 2][epoch: 1][iter: 49] AFTER HANDLE:

[rank: 10][epoch: 1][iter: 49] AFTER HANDLE:

[rank: 6][epoch: 1][iter: 49] AFTER HANDLE:
tensor([-0.0002, -0.0001, -0.0001,  ...,  0.0001,  0.0000, -0.0000],
       device='cuda:2')
[rank: 15][epoch: 1][iter: 49] AFTER HANDLE:
tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:2')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:0')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:1')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:1')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:1')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:1')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:0')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:1')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:0')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:3')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:0')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:0')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:1')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:3')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:3')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:0')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:3')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:2')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:3')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:2')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:2')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:2')
[rank: 22][epoch: 1][iter: 49] AFTER HANDLE:
tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:3')
[rank: 18][epoch: 1][iter: 49] AFTER HANDLE:

[rank: 0][epoch: 1][iter: 49] NEW GRAD:

[rank: 9][epoch: 1][iter: 49] NEW GRAD:

[rank: 5][epoch: 1][iter: 49] NEW GRAD:

[rank: 21][epoch: 1][iter: 49] NEW GRAD:

[rank: 13][epoch: 1][iter: 49] NEW GRAD:

[rank: 16][epoch: 1][iter: 49] NEW GRAD:

[rank: 1][epoch: 1][iter: 49] NEW GRAD:

[rank: 8][epoch: 1][iter: 49] NEW GRAD:

[rank: 7][epoch: 1][iter: 49] NEW GRAD:

[rank: 20][epoch: 1][iter: 49] NEW GRAD:

[rank: 12][epoch: 1][iter: 49] NEW GRAD:

[rank: 17][epoch: 1][iter: 49] NEW GRAD:

[rank: 3][epoch: 1][iter: 49] NEW GRAD:

[rank: 11][epoch: 1][iter: 49] NEW GRAD:

[rank: 4][epoch: 1][iter: 49] NEW GRAD:

[rank: 23][epoch: 1][iter: 49] NEW GRAD:

[rank: 14][epoch: 1][iter: 49] NEW GRAD:

[rank: 19][epoch: 1][iter: 49] NEW GRAD:

[rank: 2][epoch: 1][iter: 49] NEW GRAD:

[rank: 10][epoch: 1][iter: 49] NEW GRAD:

[rank: 6][epoch: 1][iter: 49] NEW GRAD:
tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:2')
[rank: 15][epoch: 1][iter: 49] NEW GRAD:
tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:2')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:0')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:1')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:1')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:1')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:1')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:0')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:1')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:0')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:3')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:0')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:0')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:1')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:3')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:3')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:0')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:3')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:2')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:3')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:2')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:2')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:2')
[rank: 22][epoch: 1][iter: 49] NEW GRAD:
tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:3')
[rank: 18][epoch: 1][iter: 49] NEW GRAD:
tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:2')tensor([-1.6244e-04, -6.2351e-05, -6.8319e-05,  ...,  5.2854e-05,
         1.3678e-05, -1.5336e-05], device='cuda:2')
[rank: 0][epoch: 1][iter: 50] BEFORE:
tensor([ 1.7450e-04,  2.0782e-04, -1.2525e-05,  ..., -6.4360e-05,
         2.0617e-04,  2.3333e-04], device='cuda:0')
[rank: 13][epoch: 1][iter: 50] BEFORE:

[rank: 9][epoch: 1][iter: 50] BEFORE:

[rank: 21][epoch: 1][iter: 50] BEFORE:
tensor([ 0.0002,  0.0002,  0.0002,  ...,  0.0002, -0.0001,  0.0005],
       device='cuda:1')
[rank: 1][epoch: 1][iter: 50] BEFORE:
tensor([5.3298e-05, 3.3273e-05, 2.7030e-05,  ..., 3.3951e-05, 6.1759e-05,
        4.7707e-05], device='cuda:1')tensor([-1.2797e-04, -1.6444e-04, -1.1705e-04,  ..., -2.0452e-04,
        -1.4561e-04,  6.4581e-05], device='cuda:1')
[rank: 16][epoch: 1][iter: 50] BEFORE:
tensor([-4.1098e-05, -5.8994e-05,  4.6808e-06,  ..., -1.7374e-04,
        -9.2644e-05, -5.5709e-05], device='cuda:1')
[rank: 5][epoch: 1][iter: 50] BEFORE:

[rank: 8][epoch: 1][iter: 50] BEFORE:
tensor([-9.6802e-05,  9.5475e-05,  4.7536e-05,  ..., -3.4274e-05,
         1.7210e-04, -3.5923e-05], device='cuda:0')
[rank: 7][epoch: 1][iter: 50] BEFORE:

[rank: 3][epoch: 1][iter: 50] BEFORE:

[rank: 17][epoch: 1][iter: 50] BEFORE:
tensor([-2.8511e-05,  1.9258e-05, -7.4284e-05,  ..., -3.4482e-04,
        -5.4890e-05,  1.2576e-05], device='cuda:0')
[rank: 12][epoch: 1][iter: 50] BEFORE:
tensor([-0.0002, -0.0002, -0.0003,  ..., -0.0006,  0.0046, -0.0004],
       device='cuda:1')
[rank: 20][epoch: 1][iter: 50] BEFORE:
tensor([-1.1067e-04,  2.4397e-04, -1.4711e-05,  ...,  6.3252e-05,
         1.5978e-04,  5.7450e-04], device='cuda:3')tensor([ 9.8243e-07,  7.2409e-05, -4.9486e-06,  ...,  3.2894e-05,
         2.0239e-05,  5.3052e-05], device='cuda:1')
[rank: 11][epoch: 1][iter: 50] BEFORE:
tensor([ 5.0096e-04, -1.1310e-04, -2.2670e-04,  ..., -1.0316e-04,
         1.6267e-04, -9.2202e-05], device='cuda:0')tensor([-6.3237e-04, -1.9775e-04, -3.9717e-04,  ..., -4.4694e-05,
         8.6026e-06, -2.2724e-05], device='cuda:3')
[rank: 23][epoch: 1][iter: 50] BEFORE:

[rank: 19][epoch: 1][iter: 50] BEFORE:

[rank: 2][epoch: 1][iter: 50] BEFORE:

[rank: 10][epoch: 1][iter: 50] BEFORE:

[rank: 14][epoch: 1][iter: 50] BEFORE:

[rank: 4][epoch: 1][iter: 50] BEFORE:
tensor([-5.3278e-05, -6.1321e-05,  7.5398e-05,  ...,  5.3746e-05,
         7.1551e-05,  5.6783e-05], device='cuda:0')
[rank: 18][epoch: 1][iter: 50] BEFORE:
tensor([2.2572e-05, 8.9683e-06, 4.8152e-05,  ..., 2.1339e-04, 1.1394e-04,
        8.8228e-06], device='cuda:3')tensor([ 2.7477e-05,  1.5321e-04,  1.7979e-04,  ...,  1.5947e-04,
        -3.6518e-04,  2.9345e-04], device='cuda:2')
[rank: 6][epoch: 1][iter: 50] BEFORE:
tensor([-0.0001,  0.0016,  0.0003,  ..., -0.0014, -0.0018,  0.0009],
       device='cuda:2')
[rank: 22][epoch: 1][iter: 50] BEFORE:
tensor([ 1.8276e-05,  1.2975e-04,  2.2308e-04,  ..., -3.9453e-05,
         5.8259e-05, -2.1289e-04], device='cuda:3')tensor([-2.3636e-06,  5.8044e-05, -2.3806e-06,  ..., -4.5803e-06,
        -2.9179e-05,  3.2141e-05], device='cuda:2')
[rank: 0][epoch: 1][iter: 50] AFTER HANDLE:
tensor([ 9.2361e-05, -3.2078e-05,  1.5027e-04,  ...,  1.1433e-04,
         1.7768e-04,  7.3013e-06], device='cuda:0')
[rank: 12][epoch: 1][iter: 50] AFTER HANDLE:
tensor([-1.2683e-05,  8.9801e-05, -1.3370e-04,  ...,  1.8903e-03,
         2.8019e-04,  3.2496e-05], device='cuda:3')
[rank: 16][epoch: 1][iter: 50] AFTER HANDLE:

[rank: 8][epoch: 1][iter: 50] AFTER HANDLE:

[rank: 3][epoch: 1][iter: 50] AFTER HANDLE:

[rank: 7][epoch: 1][iter: 50] AFTER HANDLE:

[rank: 13][epoch: 1][iter: 50] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 50] AFTER HANDLE:

[rank: 17][epoch: 1][iter: 50] AFTER HANDLE:

[rank: 9][epoch: 1][iter: 50] AFTER HANDLE:

[rank: 1][epoch: 1][iter: 50] AFTER HANDLE:

[rank: 5][epoch: 1][iter: 50] AFTER HANDLE:

[rank: 15][epoch: 1][iter: 50] BEFORE:

[rank: 20][epoch: 1][iter: 50] AFTER HANDLE:
tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:2')
[rank: 11][epoch: 1][iter: 50] AFTER HANDLE:

[rank: 2][epoch: 1][iter: 50] AFTER HANDLE:
tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:2')
[rank: 14][epoch: 1][iter: 50] AFTER HANDLE:
tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:2')
[rank: 19][epoch: 1][iter: 50] AFTER HANDLE:

[rank: 10][epoch: 1][iter: 50] AFTER HANDLE:
tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:0')
[rank: 4][epoch: 1][iter: 50] AFTER HANDLE:
tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:0')
[rank: 23][epoch: 1][iter: 50] AFTER HANDLE:
tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:0')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:0')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:3')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:3')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:1')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:1')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:1')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:1')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:1')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:1')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:3')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:0')
[rank: 18][epoch: 1][iter: 50] AFTER HANDLE:
tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:3')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:2')
[rank: 6][epoch: 1][iter: 50] AFTER HANDLE:
tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:2')
[rank: 22][epoch: 1][iter: 50] AFTER HANDLE:
tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:3')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:2')
[rank: 0][epoch: 1][iter: 50] NEW GRAD:
tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:0')
[rank: 12][epoch: 1][iter: 50] NEW GRAD:
tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:3')
[rank: 16][epoch: 1][iter: 50] NEW GRAD:

[rank: 8][epoch: 1][iter: 50] NEW GRAD:

[rank: 3][epoch: 1][iter: 50] NEW GRAD:

[rank: 7][epoch: 1][iter: 50] NEW GRAD:

[rank: 13][epoch: 1][iter: 50] NEW GRAD:

[rank: 21][epoch: 1][iter: 50] NEW GRAD:

[rank: 17][epoch: 1][iter: 50] NEW GRAD:

[rank: 9][epoch: 1][iter: 50] NEW GRAD:

[rank: 1][epoch: 1][iter: 50] NEW GRAD:

[rank: 5][epoch: 1][iter: 50] NEW GRAD:

[rank: 15][epoch: 1][iter: 50] AFTER HANDLE:

[rank: 20][epoch: 1][iter: 50] NEW GRAD:
tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:2')
[rank: 11][epoch: 1][iter: 50] NEW GRAD:

[rank: 2][epoch: 1][iter: 50] NEW GRAD:
tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:2')
[rank: 14][epoch: 1][iter: 50] NEW GRAD:
tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:2')
[rank: 19][epoch: 1][iter: 50] NEW GRAD:

[rank: 10][epoch: 1][iter: 50] NEW GRAD:
tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:0')
[rank: 4][epoch: 1][iter: 50] NEW GRAD:
tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:0')
[rank: 23][epoch: 1][iter: 50] NEW GRAD:
tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:0')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:0')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:3')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:3')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:1')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:1')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:1')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:1')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:1')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:1')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:3')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:0')
[rank: 18][epoch: 1][iter: 50] NEW GRAD:
tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:3')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:2')
[rank: 6][epoch: 1][iter: 50] NEW GRAD:
tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:2')
[rank: 22][epoch: 1][iter: 50] NEW GRAD:
tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:3')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:2')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:0')
[rank: 15][epoch: 1][iter: 50] NEW GRAD:
tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:3')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:2')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:2')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:3')tensor([-1.0321e-05,  9.0412e-05, -1.3770e-05,  ..., -7.4714e-07,
         1.6414e-04,  3.6280e-05], device='cuda:2')
[rank: 0][epoch: 1][iter: 51] BEFORE:
tensor([-1.5794e-03,  1.5388e-04,  2.5605e-04,  ...,  6.3443e-05,
        -2.6216e-04, -5.0207e-05], device='cuda:0')
[rank: 12][epoch: 1][iter: 51] BEFORE:
tensor([ 1.2631e-04,  6.2870e-06, -4.6005e-05,  ..., -5.9291e-05,
        -1.7744e-04, -8.6987e-05], device='cuda:0')
[rank: 8][epoch: 1][iter: 51] BEFORE:

[rank: 16][epoch: 1][iter: 51] BEFORE:

[rank: 7][epoch: 1][iter: 51] BEFORE:
tensor([-1.9766e-05,  1.7715e-05, -1.6733e-05,  ..., -2.7090e-05,
        -2.4821e-05, -4.6113e-06], device='cuda:0')
[rank: 13][epoch: 1][iter: 51] BEFORE:
tensor([-3.6157e-05, -1.3383e-05, -2.1065e-05,  ..., -1.3928e-04,
         5.6830e-05,  5.8902e-05], device='cuda:0')tensor([-0.0001, -0.0002,  0.0001,  ..., -0.0008, -0.0003,  0.0003],
       device='cuda:3')
[rank: 21][epoch: 1][iter: 51] BEFORE:
tensor([ 9.2183e-05,  8.3452e-05, -2.1523e-04,  ..., -5.7097e-05,
        -1.4802e-04, -1.4610e-05], device='cuda:1')
[rank: 17][epoch: 1][iter: 51] BEFORE:

[rank: 1][epoch: 1][iter: 51] BEFORE:
tensor([ 4.0845e-04, -2.8242e-04, -4.1331e-04,  ..., -7.8403e-05,
        -4.7245e-05,  8.5910e-05], device='cuda:1')
[rank: 5][epoch: 1][iter: 51] BEFORE:
tensor([ 3.4844e-07,  3.4833e-07, -4.7064e-08,  ...,  1.5016e-04,
         1.1909e-04,  1.8404e-05], device='cuda:1')
[rank: 9][epoch: 1][iter: 51] BEFORE:
tensor([ 7.1137e-06,  6.4671e-05, -8.7522e-05,  ...,  9.3224e-04,
         8.4511e-04,  9.2570e-04], device='cuda:1')
[rank: 20][epoch: 1][iter: 51] BEFORE:
tensor([-5.3631e-05,  1.9237e-03, -3.6332e-04,  ..., -1.6809e-04,
        -1.0060e-04, -1.2646e-03], device='cuda:1')
[rank: 11][epoch: 1][iter: 51] BEFORE:

[rank: 3][epoch: 1][iter: 51] BEFORE:

[rank: 19][epoch: 1][iter: 51] BEFORE:
tensor([ 1.2167e-04, -7.5629e-06,  5.3625e-05,  ..., -5.7296e-05,
         9.6363e-05, -1.7488e-04], device='cuda:0')
[rank: 14][epoch: 1][iter: 51] BEFORE:
tensor([ 1.3726e-04, -2.2646e-04, -9.0397e-05,  ...,  5.7982e-05,
         1.0488e-04,  8.6829e-05], device='cuda:1')
[rank: 2][epoch: 1][iter: 51] BEFORE:

[rank: 4][epoch: 1][iter: 51] BEFORE:
tensor([ 4.2935e-05, -2.5984e-05,  1.2266e-04,  ..., -8.6907e-05,
         8.3856e-06, -6.6364e-05], device='cuda:3')
[rank: 15][epoch: 1][iter: 51] BEFORE:

[rank: 10][epoch: 1][iter: 51] BEFORE:
tensor([-2.5580e-04, -3.6002e-04,  2.0237e-04,  ..., -4.3144e-05,
        -6.0736e-05,  5.0185e-06], device='cuda:3')
[rank: 23][epoch: 1][iter: 51] BEFORE:

[rank: 6][epoch: 1][iter: 51] BEFORE:

[rank: 18][epoch: 1][iter: 51] BEFORE:
tensor([ 6.1726e-04,  8.0628e-05,  2.7166e-04,  ..., -9.7215e-06,
        -1.7002e-05,  1.7989e-06], device='cuda:2')tensor([-1.3876e-04, -1.9682e-05, -1.0519e-05,  ..., -8.8612e-05,
        -2.3204e-04,  7.6151e-04], device='cuda:3')tensor([ 2.5301e-05, -1.5651e-04,  5.4349e-05,  ..., -5.6359e-05,
         3.2577e-05,  2.6379e-05], device='cuda:2')
[rank: 22][epoch: 1][iter: 51] BEFORE:
tensor([ 0.0014, -0.0008, -0.0013,  ...,  0.0004,  0.0003, -0.0002],
       device='cuda:0')
[rank: 19][epoch: 1][iter: 51] AFTER HANDLE:
tensor([ 2.1465e-03, -6.1584e-04, -6.2040e-04,  ..., -1.5115e-03,
        -1.5434e-04,  1.5517e-05], device='cuda:3')
[rank: 8][epoch: 1][iter: 51] AFTER HANDLE:

[rank: 0][epoch: 1][iter: 51] AFTER HANDLE:

[rank: 20][epoch: 1][iter: 51] AFTER HANDLE:

[rank: 5][epoch: 1][iter: 51] AFTER HANDLE:

[rank: 17][epoch: 1][iter: 51] AFTER HANDLE:

[rank: 13][epoch: 1][iter: 51] AFTER HANDLE:

[rank: 9][epoch: 1][iter: 51] AFTER HANDLE:

[rank: 1][epoch: 1][iter: 51] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 51] AFTER HANDLE:

[rank: 7][epoch: 1][iter: 51] AFTER HANDLE:

[rank: 16][epoch: 1][iter: 51] AFTER HANDLE:

[rank: 12][epoch: 1][iter: 51] AFTER HANDLE:
tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:2')
[rank: 3][epoch: 1][iter: 51] AFTER HANDLE:
tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:3')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:2')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:2')
[rank: 14][epoch: 1][iter: 51] AFTER HANDLE:

[rank: 11][epoch: 1][iter: 51] AFTER HANDLE:

[rank: 2][epoch: 1][iter: 51] AFTER HANDLE:
tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:2')
[rank: 4][epoch: 1][iter: 51] AFTER HANDLE:
tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:3')
[rank: 15][epoch: 1][iter: 51] AFTER HANDLE:
tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:0')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:0')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:0')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:1')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:1')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:1')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:1')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:1')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:1')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:3')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:0')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:0')
[rank: 10][epoch: 1][iter: 51] AFTER HANDLE:
tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:3')
[rank: 23][epoch: 1][iter: 51] AFTER HANDLE:

[rank: 6][epoch: 1][iter: 51] AFTER HANDLE:

[rank: 18][epoch: 1][iter: 51] AFTER HANDLE:
tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:2')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:3')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:2')
[rank: 22][epoch: 1][iter: 51] AFTER HANDLE:
tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:0')
[rank: 19][epoch: 1][iter: 51] NEW GRAD:
tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:3')
[rank: 8][epoch: 1][iter: 51] NEW GRAD:

[rank: 0][epoch: 1][iter: 51] NEW GRAD:

[rank: 20][epoch: 1][iter: 51] NEW GRAD:

[rank: 5][epoch: 1][iter: 51] NEW GRAD:

[rank: 17][epoch: 1][iter: 51] NEW GRAD:

[rank: 13][epoch: 1][iter: 51] NEW GRAD:

[rank: 9][epoch: 1][iter: 51] NEW GRAD:

[rank: 1][epoch: 1][iter: 51] NEW GRAD:

[rank: 21][epoch: 1][iter: 51] NEW GRAD:

[rank: 7][epoch: 1][iter: 51] NEW GRAD:

[rank: 16][epoch: 1][iter: 51] NEW GRAD:

[rank: 12][epoch: 1][iter: 51] NEW GRAD:
tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:2')
[rank: 3][epoch: 1][iter: 51] NEW GRAD:
tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:3')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:2')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:2')
[rank: 14][epoch: 1][iter: 51] NEW GRAD:

[rank: 11][epoch: 1][iter: 51] NEW GRAD:

[rank: 2][epoch: 1][iter: 51] NEW GRAD:
tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:2')
[rank: 4][epoch: 1][iter: 51] NEW GRAD:
tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:3')
[rank: 15][epoch: 1][iter: 51] NEW GRAD:
tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:0')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:0')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:0')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:1')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:1')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:1')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:1')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:1')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:1')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:3')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:0')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:0')
[rank: 10][epoch: 1][iter: 51] NEW GRAD:
tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:3')
[rank: 23][epoch: 1][iter: 51] NEW GRAD:

[rank: 6][epoch: 1][iter: 51] NEW GRAD:

[rank: 18][epoch: 1][iter: 51] NEW GRAD:
tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:2')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:3')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:2')
[rank: 22][epoch: 1][iter: 51] NEW GRAD:
tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:0')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:2')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:3')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:2')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:3')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:2')tensor([ 1.1817e-04, -2.0151e-05, -7.3895e-05,  ..., -6.1129e-05,
        -2.3456e-06,  1.1719e-06], device='cuda:2')
[rank: 19][epoch: 1][iter: 52] BEFORE:
tensor([-4.2823e-06,  6.0894e-05,  4.9567e-05,  ...,  2.9678e-04,
         1.4640e-04,  3.1594e-05], device='cuda:3')
[rank: 8][epoch: 1][iter: 52] BEFORE:

[rank: 0][epoch: 1][iter: 52] BEFORE:
tensor([ 2.3448e-05,  1.4015e-04, -1.0740e-04,  ..., -3.8754e-05,
         1.7128e-04,  1.8238e-04], device='cuda:0')tensor([ 1.8547e-04,  4.7013e-05, -2.2644e-04,  ...,  1.2611e-05,
         1.0843e-05,  2.2977e-06], device='cuda:0')
[rank: 17][epoch: 1][iter: 52] BEFORE:

[rank: 20][epoch: 1][iter: 52] BEFORE:
tensor([ 1.9027e-04,  8.0183e-06, -2.4867e-04,  ...,  1.4259e-05,
         2.3000e-05,  5.8615e-05], device='cuda:1')tensor([-1.8636e-04, -1.0322e-04, -8.5589e-05,  ..., -1.3707e-04,
        -1.0017e-04,  8.5397e-05], device='cuda:0')
[rank: 13][epoch: 1][iter: 52] BEFORE:

[rank: 1][epoch: 1][iter: 52] BEFORE:

[rank: 5][epoch: 1][iter: 52] BEFORE:
tensor([ 9.3416e-05,  1.1504e-04,  9.3029e-05,  ..., -2.9551e-04,
        -6.8355e-05,  2.6866e-05], device='cuda:1')
[rank: 9][epoch: 1][iter: 52] BEFORE:
tensor([ 3.0629e-05, -1.4787e-04,  2.9380e-05,  ..., -8.7652e-05,
        -1.4025e-05,  2.5250e-04], device='cuda:1')
[rank: 21][epoch: 1][iter: 52] BEFORE:
tensor([ 1.5338e-05, -8.2506e-05,  1.1899e-06,  ...,  6.4419e-06,
        -4.8762e-05, -1.3392e-05], device='cuda:1')
[rank: 16][epoch: 1][iter: 52] BEFORE:
tensor([2.1987e-04, 3.9331e-05, 8.3573e-05,  ..., 1.0008e-04, 3.0038e-04,
        1.4467e-04], device='cuda:1')
[rank: 3][epoch: 1][iter: 52] BEFORE:
tensor([-1.4249e-06, -1.4199e-06, -1.4238e-06,  ...,  1.0001e-05,
         1.0099e-05,  9.9431e-06], device='cuda:1')
[rank: 7][epoch: 1][iter: 52] BEFORE:

[rank: 12][epoch: 1][iter: 52] BEFORE:

[rank: 11][epoch: 1][iter: 52] BEFORE:
tensor([-4.2592e-04, -2.9142e-04, -2.9626e-04,  ...,  4.0099e-05,
         1.2909e-04,  4.2672e-05], device='cuda:0')tensor([-2.8407e-07, -2.3682e-05,  1.4341e-05,  ..., -1.4475e-04,
         2.7206e-04, -1.9232e-04], device='cuda:3')
[rank: 4][epoch: 1][iter: 52] BEFORE:

[rank: 14][epoch: 1][iter: 52] BEFORE:

[rank: 10][epoch: 1][iter: 52] BEFORE:

[rank: 18][epoch: 1][iter: 52] BEFORE:

[rank: 2][epoch: 1][iter: 52] BEFORE:
tensor([-1.8113e-03,  1.4047e-03, -2.0157e-03,  ...,  5.4441e-06,
        -1.1089e-04, -1.1573e-04], device='cuda:3')
[rank: 23][epoch: 1][iter: 52] BEFORE:

[rank: 15][epoch: 1][iter: 52] BEFORE:
tensor([-2.6765e-05,  4.4866e-05,  1.7161e-04,  ..., -2.5028e-04,
        -2.0696e-05,  5.0555e-04], device='cuda:3')tensor([ 3.5255e-04,  8.7289e-05,  4.7304e-04,  ..., -2.1816e-04,
         6.7718e-04,  5.6700e-05], device='cuda:2')tensor([ 1.0958e-03, -1.5330e-04,  5.3503e-04,  ...,  9.8154e-05,
         1.1772e-05, -4.2958e-04], device='cuda:0')tensor([-6.0797e-05, -1.9388e-04,  1.2530e-04,  ...,  1.0486e-05,
         3.2788e-05,  5.5976e-05], device='cuda:2')
[rank: 22][epoch: 1][iter: 52] BEFORE:
tensor([-2.8937e-05, -3.7264e-05, -2.3808e-05,  ...,  2.1235e-04,
         2.1099e-04,  6.6971e-06], device='cuda:0')tensor([-6.9565e-05,  7.8583e-06,  9.1188e-06,  ...,  3.4704e-04,
        -2.4652e-05, -1.8765e-04], device='cuda:2')
[rank: 19][epoch: 1][iter: 52] AFTER HANDLE:

[rank: 5][epoch: 1][iter: 52] AFTER HANDLE:

[rank: 0][epoch: 1][iter: 52] AFTER HANDLE:
tensor([-1.6137e-04, -1.4219e-04, -1.6327e-04,  ...,  6.1819e-05,
         5.5165e-06, -6.0231e-05], device='cuda:3')tensor([ 2.3037e-05, -3.3096e-05,  2.7158e-05,  ..., -1.1479e-06,
        -5.9077e-04,  2.6568e-05], device='cuda:2')
[rank: 9][epoch: 1][iter: 52] AFTER HANDLE:

[rank: 16][epoch: 1][iter: 52] AFTER HANDLE:

[rank: 7][epoch: 1][iter: 52] AFTER HANDLE:

[rank: 1][epoch: 1][iter: 52] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 52] AFTER HANDLE:

[rank: 13][epoch: 1][iter: 52] AFTER HANDLE:

[rank: 8][epoch: 1][iter: 52] AFTER HANDLE:

[rank: 17][epoch: 1][iter: 52] AFTER HANDLE:

[rank: 6][epoch: 1][iter: 52] BEFORE:

[rank: 3][epoch: 1][iter: 52] AFTER HANDLE:

[rank: 20][epoch: 1][iter: 52] AFTER HANDLE:
tensor([-0.0000,  0.0001, -0.0001,  ..., -0.0000,  0.0001,  0.0000],
       device='cuda:3')
[rank: 11][epoch: 1][iter: 52] AFTER HANDLE:

[rank: 18][epoch: 1][iter: 52] AFTER HANDLE:

[rank: 4][epoch: 1][iter: 52] AFTER HANDLE:

[rank: 2][epoch: 1][iter: 52] AFTER HANDLE:
tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:2')
[rank: 12][epoch: 1][iter: 52] AFTER HANDLE:

[rank: 10][epoch: 1][iter: 52] AFTER HANDLE:
tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:3')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:1')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:0')
[rank: 23][epoch: 1][iter: 52] AFTER HANDLE:

[rank: 14][epoch: 1][iter: 52] AFTER HANDLE:
tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:1')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:0')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:3')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:1')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:1')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:1')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:0')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:1')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:2')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:3')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:0')
[rank: 15][epoch: 1][iter: 52] AFTER HANDLE:
tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:3')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:2')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:0')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:2')
[rank: 22][epoch: 1][iter: 52] AFTER HANDLE:
tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:0')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:2')
[rank: 19][epoch: 1][iter: 52] NEW GRAD:

[rank: 5][epoch: 1][iter: 52] NEW GRAD:

[rank: 0][epoch: 1][iter: 52] NEW GRAD:
tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:3')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:2')
[rank: 9][epoch: 1][iter: 52] NEW GRAD:

[rank: 16][epoch: 1][iter: 52] NEW GRAD:

[rank: 7][epoch: 1][iter: 52] NEW GRAD:

[rank: 1][epoch: 1][iter: 52] NEW GRAD:

[rank: 21][epoch: 1][iter: 52] NEW GRAD:

[rank: 13][epoch: 1][iter: 52] NEW GRAD:

[rank: 8][epoch: 1][iter: 52] NEW GRAD:

[rank: 17][epoch: 1][iter: 52] NEW GRAD:

[rank: 6][epoch: 1][iter: 52] AFTER HANDLE:

[rank: 3][epoch: 1][iter: 52] NEW GRAD:

[rank: 20][epoch: 1][iter: 52] NEW GRAD:
tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:3')
[rank: 11][epoch: 1][iter: 52] NEW GRAD:

[rank: 18][epoch: 1][iter: 52] NEW GRAD:

[rank: 4][epoch: 1][iter: 52] NEW GRAD:

[rank: 2][epoch: 1][iter: 52] NEW GRAD:
tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:2')
[rank: 12][epoch: 1][iter: 52] NEW GRAD:

[rank: 10][epoch: 1][iter: 52] NEW GRAD:
tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:3')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:1')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:0')
[rank: 23][epoch: 1][iter: 52] NEW GRAD:

[rank: 14][epoch: 1][iter: 52] NEW GRAD:
tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:1')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:0')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:3')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:1')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:1')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:1')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:0')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:1')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:2')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:3')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:0')
[rank: 15][epoch: 1][iter: 52] NEW GRAD:
tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:3')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:2')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:0')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:2')
[rank: 22][epoch: 1][iter: 52] NEW GRAD:
tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:0')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:2')
[rank: 6][epoch: 1][iter: 52] NEW GRAD:
tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:3')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:2')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:2')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:2')tensor([-3.5045e-05,  5.0080e-05, -8.6623e-05,  ..., -1.0868e-05,
         5.7320e-05,  2.8503e-05], device='cuda:3')
[rank: 19][epoch: 1][iter: 53] BEFORE:

[rank: 5][epoch: 1][iter: 53] BEFORE:
tensor([-1.3129e-04,  2.5965e-04, -2.7207e-04,  ...,  1.3381e-04,
         3.2691e-05,  2.3444e-04], device='cuda:3')
[rank: 0][epoch: 1][iter: 53] BEFORE:
tensor([-8.6007e-05, -7.6219e-05, -1.0853e-04,  ..., -1.9163e-04,
        -3.4657e-05, -1.2883e-04], device='cuda:1')tensor([ 5.0158e-07,  5.5655e-07,  2.3217e-07,  ..., -2.2680e-05,
         3.2869e-05, -1.0448e-04], device='cuda:0')
[rank: 9][epoch: 1][iter: 53] BEFORE:

[rank: 7][epoch: 1][iter: 53] BEFORE:

[rank: 1][epoch: 1][iter: 53] BEFORE:
tensor([ 1.2581e-04,  2.8287e-05, -1.4413e-04,  ...,  1.9821e-05,
         1.0836e-05,  1.4274e-04], device='cuda:1')
[rank: 16][epoch: 1][iter: 53] BEFORE:
tensor([ 1.7689e-04, -2.1164e-04, -5.2162e-06,  ..., -8.1952e-05,
        -2.4018e-04, -1.5855e-04], device='cuda:3')
[rank: 13][epoch: 1][iter: 53] BEFORE:
tensor([ 2.2251e-04, -8.3403e-05,  1.4256e-04,  ...,  7.5342e-05,
        -1.5606e-05,  1.5900e-04], device='cuda:1')
[rank: 8][epoch: 1][iter: 53] BEFORE:
tensor([ 5.9875e-05, -3.0429e-04, -1.5493e-04,  ...,  5.7557e-04,
         4.4108e-04,  3.3391e-04], device='cuda:0')
[rank: 21][epoch: 1][iter: 53] BEFORE:
tensor([-2.4352e-05,  6.5506e-05, -6.3647e-05,  ...,  1.8665e-05,
        -2.2994e-05,  1.3219e-05], device='cuda:1')tensor([-1.9167e-05, -1.3883e-04,  8.9127e-05,  ..., -2.0752e-04,
        -7.6331e-05,  4.3643e-04], device='cuda:0')
[rank: 17][epoch: 1][iter: 53] BEFORE:

[rank: 3][epoch: 1][iter: 53] BEFORE:

[rank: 20][epoch: 1][iter: 53] BEFORE:

[rank: 11][epoch: 1][iter: 53] BEFORE:

[rank: 4][epoch: 1][iter: 53] BEFORE:
tensor([ 1.1414e-05, -6.6961e-05,  1.2750e-04,  ..., -1.4375e-04,
        -4.9982e-05, -3.2198e-04], device='cuda:1')
[rank: 2][epoch: 1][iter: 53] BEFORE:
tensor([ 1.5594e-04,  1.8069e-05, -1.4480e-05,  ...,  3.1959e-04,
         1.8060e-04, -1.4169e-04], device='cuda:1')tensor([ 7.2737e-05, -6.2215e-05,  1.2450e-04,  ...,  1.8337e-04,
         2.3668e-04, -5.3548e-06], device='cuda:3')
[rank: 18][epoch: 1][iter: 53] BEFORE:
tensor([ 1.4988e-04,  2.8220e-04,  2.1526e-04,  ..., -9.5568e-05,
         3.4567e-05, -4.6085e-04], device='cuda:0')
[rank: 12][epoch: 1][iter: 53] BEFORE:
tensor([-0.0007,  0.0015, -0.0006,  ..., -0.0003, -0.0004,  0.0002],
       device='cuda:3')tensor([-1.7774e-04,  4.0755e-05,  2.9229e-05,  ...,  1.9826e-05,
        -8.3574e-05,  3.4262e-05], device='cuda:0')
[rank: 10][epoch: 1][iter: 53] BEFORE:

[rank: 6][epoch: 1][iter: 53] BEFORE:
tensor([ 4.9827e-04, -4.2269e-04,  2.3256e-04,  ...,  3.2402e-05,
         1.0699e-04,  5.1868e-05], device='cuda:2')
[rank: 14][epoch: 1][iter: 53] BEFORE:
tensor([-1.4803e-04, -5.0266e-05, -2.1422e-05,  ..., -7.8058e-07,
         1.5863e-05,  5.3234e-05], device='cuda:2')
[rank: 23][epoch: 1][iter: 53] BEFORE:

[rank: 11][epoch: 1][iter: 53] AFTER HANDLE:

[rank: 4][epoch: 1][iter: 53] AFTER HANDLE:

[rank: 19][epoch: 1][iter: 53] AFTER HANDLE:
tensor([ 5.4390e-04,  2.8984e-04, -1.7253e-04,  ...,  4.9839e-05,
        -7.8362e-05, -1.2189e-04], device='cuda:0')
[rank: 3][epoch: 1][iter: 53] AFTER HANDLE:

[rank: 22][epoch: 1][iter: 53] BEFORE:

[rank: 9][epoch: 1][iter: 53] AFTER HANDLE:

[rank: 5][epoch: 1][iter: 53] AFTER HANDLE:

[rank: 16][epoch: 1][iter: 53] AFTER HANDLE:

[rank: 15][epoch: 1][iter: 53] BEFORE:

[rank: 0][epoch: 1][iter: 53] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 53] AFTER HANDLE:

[rank: 8][epoch: 1][iter: 53] AFTER HANDLE:

[rank: 7][epoch: 1][iter: 53] AFTER HANDLE:

[rank: 17][epoch: 1][iter: 53] AFTER HANDLE:

[rank: 13][epoch: 1][iter: 53] AFTER HANDLE:

[rank: 1][epoch: 1][iter: 53] AFTER HANDLE:

[rank: 20][epoch: 1][iter: 53] AFTER HANDLE:
tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:2')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:2')
[rank: 18][epoch: 1][iter: 53] AFTER HANDLE:
tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:2')
[rank: 2][epoch: 1][iter: 53] AFTER HANDLE:
tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:3')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:3')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:0')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:3')
[rank: 12][epoch: 1][iter: 53] AFTER HANDLE:
tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:3')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:2')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:1')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:1')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:0')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:3')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:0')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:1')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:0')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:3')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:1')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:1')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:1')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:0')
[rank: 10][epoch: 1][iter: 53] AFTER HANDLE:

[rank: 6][epoch: 1][iter: 53] AFTER HANDLE:
tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:2')
[rank: 14][epoch: 1][iter: 53] AFTER HANDLE:
tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:2')
[rank: 23][epoch: 1][iter: 53] AFTER HANDLE:

[rank: 11][epoch: 1][iter: 53] NEW GRAD:

[rank: 4][epoch: 1][iter: 53] NEW GRAD:

[rank: 19][epoch: 1][iter: 53] NEW GRAD:
tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:0')
[rank: 3][epoch: 1][iter: 53] NEW GRAD:

[rank: 22][epoch: 1][iter: 53] AFTER HANDLE:

[rank: 9][epoch: 1][iter: 53] NEW GRAD:

[rank: 5][epoch: 1][iter: 53] NEW GRAD:

[rank: 16][epoch: 1][iter: 53] NEW GRAD:

[rank: 15][epoch: 1][iter: 53] AFTER HANDLE:

[rank: 0][epoch: 1][iter: 53] NEW GRAD:

[rank: 21][epoch: 1][iter: 53] NEW GRAD:

[rank: 8][epoch: 1][iter: 53] NEW GRAD:

[rank: 7][epoch: 1][iter: 53] NEW GRAD:

[rank: 17][epoch: 1][iter: 53] NEW GRAD:

[rank: 13][epoch: 1][iter: 53] NEW GRAD:

[rank: 1][epoch: 1][iter: 53] NEW GRAD:

[rank: 20][epoch: 1][iter: 53] NEW GRAD:
tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:2')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:2')
[rank: 18][epoch: 1][iter: 53] NEW GRAD:
tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:2')
[rank: 2][epoch: 1][iter: 53] NEW GRAD:
tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:3')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:3')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:0')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:3')
[rank: 12][epoch: 1][iter: 53] NEW GRAD:
tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:3')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:2')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:1')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:1')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:0')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:3')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:0')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:1')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:0')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:3')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:1')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:1')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:1')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:0')
[rank: 10][epoch: 1][iter: 53] NEW GRAD:

[rank: 6][epoch: 1][iter: 53] NEW GRAD:
tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:2')
[rank: 14][epoch: 1][iter: 53] NEW GRAD:
tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:2')
[rank: 23][epoch: 1][iter: 53] NEW GRAD:
tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:2')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:2')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:0')
[rank: 22][epoch: 1][iter: 53] NEW GRAD:

[rank: 15][epoch: 1][iter: 53] NEW GRAD:
tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:3')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:2')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:2')tensor([-1.0428e-05,  5.6702e-05, -3.6486e-05,  ...,  8.3898e-06,
        -2.6890e-05, -1.0017e-05], device='cuda:3')
[rank: 11][epoch: 1][iter: 54] BEFORE:
tensor([ 2.8097e-04,  5.7584e-06,  3.1821e-05,  ..., -6.5558e-04,
        -6.5296e-04,  1.6560e-03], device='cuda:3')
[rank: 19][epoch: 1][iter: 54] BEFORE:

[rank: 4][epoch: 1][iter: 54] BEFORE:
tensor([-2.1155e-04,  1.4923e-03, -2.0176e-04,  ...,  9.4947e-05,
        -5.6947e-04, -4.2001e-04], device='cuda:3')
[rank: 3][epoch: 1][iter: 54] BEFORE:
tensor([-1.0582e-04, -9.5767e-05, -3.0784e-05,  ..., -5.0988e-04,
        -3.2473e-04,  4.6761e-05], device='cuda:0')
[rank: 9][epoch: 1][iter: 54] BEFORE:
tensor([ 1.4119e-04,  3.7668e-04,  1.0434e-04,  ..., -1.7594e-04,
         1.1513e-04,  5.6085e-05], device='cuda:3')
[rank: 16][epoch: 1][iter: 54] BEFORE:
tensor([ 6.0112e-05, -6.0407e-06,  7.7674e-06,  ...,  8.2959e-05,
        -1.9283e-04,  1.5822e-04], device='cuda:1')
[rank: 0][epoch: 1][iter: 54] BEFORE:

[rank: 5][epoch: 1][iter: 54] BEFORE:
tensor([ 1.5978e-04, -1.1093e-04,  2.7408e-04,  ..., -1.7473e-04,
        -7.0310e-05, -2.7420e-04], device='cuda:0')
[rank: 8][epoch: 1][iter: 54] BEFORE:
tensor([ 3.2906e-05,  2.6927e-05, -8.7479e-05,  ..., -2.2794e-07,
        -8.6466e-06, -4.2491e-05], device='cuda:0')
[rank: 7][epoch: 1][iter: 54] BEFORE:

[rank: 13][epoch: 1][iter: 54] BEFORE:

[rank: 17][epoch: 1][iter: 54] BEFORE:

[rank: 21][epoch: 1][iter: 54] BEFORE:

[rank: 1][epoch: 1][iter: 54] BEFORE:
tensor([ 1.7474e-04, -8.6955e-05, -6.1159e-05,  ...,  1.1201e-04,
         9.9611e-05,  7.5724e-05], device='cuda:0')tensor([ 2.9759e-04,  9.9019e-05, -5.1650e-04,  ..., -1.5497e-04,
         2.9908e-04,  2.9186e-05], device='cuda:1')tensor([-4.4218e-05, -4.8408e-05, -8.1533e-05,  ..., -5.4042e-05,
        -6.8809e-05, -3.4607e-04], device='cuda:1')
[rank: 20][epoch: 1][iter: 54] BEFORE:
tensor([-8.9795e-04, -1.9124e-03,  1.4586e-04,  ..., -2.7948e-04,
        -1.8641e-04,  2.3074e-05], device='cuda:1')tensor([ 1.9378e-05, -5.8779e-05, -1.9033e-04,  ..., -1.9537e-04,
         1.0586e-03,  2.5151e-04], device='cuda:1')tensor([-0.0001, -0.0012,  0.0018,  ..., -0.0001, -0.0002, -0.0002],
       device='cuda:3')
[rank: 10][epoch: 1][iter: 54] BEFORE:
tensor([ 1.5936e-04, -1.7895e-04, -1.7039e-04,  ...,  1.2278e-05,
         1.1407e-04,  7.4548e-05], device='cuda:1')
[rank: 18][epoch: 1][iter: 54] BEFORE:

[rank: 2][epoch: 1][iter: 54] BEFORE:

[rank: 12][epoch: 1][iter: 54] BEFORE:
tensor([-3.8315e-05, -8.2094e-05,  3.2522e-04,  ..., -1.9743e-04,
        -1.8632e-06,  7.2292e-05], device='cuda:2')tensor([ 3.1659e-05,  1.7435e-05,  5.2557e-06,  ...,  3.6950e-06,
         5.9673e-06, -1.2477e-05], device='cuda:0')
[rank: 6][epoch: 1][iter: 54] BEFORE:
tensor([ 3.8404e-05,  3.5137e-05,  5.0522e-06,  ...,  1.5442e-04,
        -1.4434e-04, -6.0223e-05], device='cuda:2')
[rank: 14][epoch: 1][iter: 54] BEFORE:
tensor([ 2.6580e-05, -3.0001e-05, -2.7067e-05,  ..., -5.9257e-06,
        -1.1273e-05, -6.3694e-06], device='cuda:2')
[rank: 23][epoch: 1][iter: 54] BEFORE:

[rank: 8][epoch: 1][iter: 54] AFTER HANDLE:

[rank: 5][epoch: 1][iter: 54] AFTER HANDLE:

[rank: 16][epoch: 1][iter: 54] AFTER HANDLE:

[rank: 15][epoch: 1][iter: 54] BEFORE:

[rank: 0][epoch: 1][iter: 54] AFTER HANDLE:

[rank: 22][epoch: 1][iter: 54] BEFORE:

[rank: 11][epoch: 1][iter: 54] AFTER HANDLE:

[rank: 4][epoch: 1][iter: 54] AFTER HANDLE:

[rank: 19][epoch: 1][iter: 54] AFTER HANDLE:
tensor([ 2.0946e-05, -1.4096e-05,  3.2019e-05,  ..., -8.0129e-05,
         9.6072e-05,  1.5017e-04], device='cuda:0')
[rank: 1][epoch: 1][iter: 54] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 54] AFTER HANDLE:

[rank: 9][epoch: 1][iter: 54] AFTER HANDLE:

[rank: 7][epoch: 1][iter: 54] AFTER HANDLE:

[rank: 17][epoch: 1][iter: 54] AFTER HANDLE:

[rank: 13][epoch: 1][iter: 54] AFTER HANDLE:

[rank: 3][epoch: 1][iter: 54] AFTER HANDLE:

[rank: 20][epoch: 1][iter: 54] AFTER HANDLE:

[rank: 10][epoch: 1][iter: 54] AFTER HANDLE:
tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:2')
[rank: 18][epoch: 1][iter: 54] AFTER HANDLE:
tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:2')
[rank: 2][epoch: 1][iter: 54] AFTER HANDLE:
tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:3')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:0')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:1')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:0')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:3')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:0')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:2')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:3')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:0')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:3')
[rank: 12][epoch: 1][iter: 54] AFTER HANDLE:
tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:1')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:1')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:1')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:3')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:1')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:1')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:3')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:0')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:2')
[rank: 6][epoch: 1][iter: 54] AFTER HANDLE:
tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:2')
[rank: 14][epoch: 1][iter: 54] AFTER HANDLE:
tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:2')
[rank: 23][epoch: 1][iter: 54] AFTER HANDLE:

[rank: 8][epoch: 1][iter: 54] NEW GRAD:

[rank: 5][epoch: 1][iter: 54] NEW GRAD:

[rank: 16][epoch: 1][iter: 54] NEW GRAD:

[rank: 15][epoch: 1][iter: 54] AFTER HANDLE:

[rank: 0][epoch: 1][iter: 54] NEW GRAD:

[rank: 22][epoch: 1][iter: 54] AFTER HANDLE:

[rank: 11][epoch: 1][iter: 54] NEW GRAD:

[rank: 4][epoch: 1][iter: 54] NEW GRAD:

[rank: 19][epoch: 1][iter: 54] NEW GRAD:
tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:0')
[rank: 1][epoch: 1][iter: 54] NEW GRAD:

[rank: 21][epoch: 1][iter: 54] NEW GRAD:

[rank: 9][epoch: 1][iter: 54] NEW GRAD:

[rank: 7][epoch: 1][iter: 54] NEW GRAD:

[rank: 17][epoch: 1][iter: 54] NEW GRAD:

[rank: 13][epoch: 1][iter: 54] NEW GRAD:

[rank: 3][epoch: 1][iter: 54] NEW GRAD:

[rank: 20][epoch: 1][iter: 54] NEW GRAD:

[rank: 10][epoch: 1][iter: 54] NEW GRAD:
tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:2')
[rank: 18][epoch: 1][iter: 54] NEW GRAD:
tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:2')
[rank: 2][epoch: 1][iter: 54] NEW GRAD:
tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:3')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:0')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:1')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:0')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:3')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:0')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:2')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:3')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:0')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:3')
[rank: 12][epoch: 1][iter: 54] NEW GRAD:
tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:1')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:1')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:1')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:3')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:1')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:1')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:3')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:0')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:2')
[rank: 6][epoch: 1][iter: 54] NEW GRAD:
tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:2')
[rank: 14][epoch: 1][iter: 54] NEW GRAD:
tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:2')
[rank: 23][epoch: 1][iter: 54] NEW GRAD:
tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:2')
[rank: 15][epoch: 1][iter: 54] NEW GRAD:

[rank: 22][epoch: 1][iter: 54] NEW GRAD:
tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:0')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:3')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:2')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:2')tensor([-1.9886e-05, -8.0793e-05,  5.9742e-05,  ..., -5.3517e-05,
        -2.6642e-05,  4.5057e-05], device='cuda:3')
[rank: 8][epoch: 1][iter: 55] BEFORE:

[rank: 5][epoch: 1][iter: 55] BEFORE:
tensor([ 5.9166e-04,  8.9193e-06, -7.9438e-04,  ...,  5.3880e-05,
        -5.5144e-05, -1.0653e-05], device='cuda:0')
[rank: 16][epoch: 1][iter: 55] BEFORE:
tensor([-3.5577e-05,  7.5453e-05,  1.7466e-05,  ...,  1.6911e-05,
        -2.2238e-04,  2.8069e-04], device='cuda:1')
[rank: 0][epoch: 1][iter: 55] BEFORE:
tensor([-3.9346e-06, -3.9099e-06, -9.9395e-06,  ...,  2.5380e-04,
         2.0769e-04,  1.3002e-04], device='cuda:0')
[rank: 11][epoch: 1][iter: 55] BEFORE:
tensor([ 9.9633e-06, -5.1787e-06, -1.6888e-06,  ...,  1.8054e-05,
        -2.1587e-05, -2.2231e-05], device='cuda:0')
[rank: 19][epoch: 1][iter: 55] BEFORE:

[rank: 4][epoch: 1][iter: 55] BEFORE:
tensor([ 1.8432e-04,  2.7415e-04,  4.7957e-04,  ..., -7.1787e-04,
         3.5220e-05, -6.3005e-04], device='cuda:3')
[rank: 1][epoch: 1][iter: 55] BEFORE:
tensor([ 5.9827e-05,  4.0429e-04, -2.1404e-04,  ..., -2.2193e-03,
        -8.2882e-05, -8.3336e-05], device='cuda:3')tensor([ 7.7746e-05,  6.8278e-05, -5.4601e-05,  ...,  2.4314e-05,
        -1.2442e-05,  1.3537e-05], device='cuda:0')tensor([-1.0003e-04, -1.6913e-05, -5.1242e-05,  ...,  8.0601e-04,
         8.3283e-04,  7.8137e-04], device='cuda:1')
[rank: 17][epoch: 1][iter: 55] BEFORE:

[rank: 13][epoch: 1][iter: 55] BEFORE:

[rank: 7][epoch: 1][iter: 55] BEFORE:

[rank: 21][epoch: 1][iter: 55] BEFORE:

[rank: 9][epoch: 1][iter: 55] BEFORE:
tensor([-4.7628e-04, -1.2618e-04, -4.1473e-04,  ...,  3.4905e-04,
        -2.3097e-04, -3.4661e-05], device='cuda:1')
[rank: 3][epoch: 1][iter: 55] BEFORE:
tensor([ 2.4727e-04, -1.8827e-04,  7.4796e-05,  ...,  3.8101e-04,
         7.0458e-04,  8.7187e-04], device='cuda:1')tensor([-9.7718e-06,  3.6910e-06,  3.4045e-05,  ...,  2.5437e-04,
        -6.5453e-04, -2.9562e-03], device='cuda:3')
[rank: 20][epoch: 1][iter: 55] BEFORE:

[rank: 10][epoch: 1][iter: 55] BEFORE:
tensor([-0.0004, -0.0001,  0.0001,  ..., -0.0016, -0.0007, -0.0003],
       device='cuda:3')
[rank: 18][epoch: 1][iter: 55] BEFORE:

[rank: 6][epoch: 1][iter: 55] BEFORE:
tensor([ 2.0302e-04, -5.0505e-05,  1.7734e-04,  ..., -1.8794e-05,
        -1.4835e-05,  2.2318e-06], device='cuda:1')tensor([-1.5329e-04, -6.6490e-04,  3.7638e-04,  ...,  1.2444e-04,
        -6.9466e-05,  1.3349e-04], device='cuda:1')
[rank: 2][epoch: 1][iter: 55] BEFORE:

[rank: 12][epoch: 1][iter: 55] BEFORE:
tensor([-2.1557e-04, -7.9979e-04, -5.6021e-04,  ...,  5.0966e-05,
        -6.0044e-05,  1.6399e-04], device='cuda:2')tensor([-7.7091e-05,  1.1493e-04, -3.5450e-05,  ...,  3.6401e-04,
         3.3461e-04, -6.5153e-06], device='cuda:2')tensor([-5.4613e-08,  2.8169e-05, -1.0069e-05,  ..., -2.5836e-05,
        -1.0566e-04, -2.0240e-04], device='cuda:0')tensor([ 1.2794e-04,  1.8253e-05,  1.5433e-05,  ..., -9.1034e-05,
        -8.9053e-05, -9.1292e-05], device='cuda:2')
[rank: 14][epoch: 1][iter: 55] BEFORE:
tensor([ 2.2712e-05,  2.9997e-05, -4.6184e-05,  ...,  7.4269e-06,
        -1.0530e-05,  8.4760e-05], device='cuda:2')
[rank: 19][epoch: 1][iter: 55] AFTER HANDLE:

[rank: 4][epoch: 1][iter: 55] AFTER HANDLE:

[rank: 23][epoch: 1][iter: 55] BEFORE:

[rank: 9][epoch: 1][iter: 55] AFTER HANDLE:

[rank: 15][epoch: 1][iter: 55] BEFORE:

[rank: 3][epoch: 1][iter: 55] AFTER HANDLE:

[rank: 16][epoch: 1][iter: 55] AFTER HANDLE:

[rank: 5][epoch: 1][iter: 55] AFTER HANDLE:

[rank: 22][epoch: 1][iter: 55] BEFORE:

[rank: 11][epoch: 1][iter: 55] AFTER HANDLE:

[rank: 13][epoch: 1][iter: 55] AFTER HANDLE:

[rank: 1][epoch: 1][iter: 55] AFTER HANDLE:

[rank: 17][epoch: 1][iter: 55] AFTER HANDLE:

[rank: 7][epoch: 1][iter: 55] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 55] AFTER HANDLE:

[rank: 8][epoch: 1][iter: 55] AFTER HANDLE:
tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:0')
[rank: 0][epoch: 1][iter: 55] AFTER HANDLE:

[rank: 18][epoch: 1][iter: 55] AFTER HANDLE:

[rank: 6][epoch: 1][iter: 55] AFTER HANDLE:

[rank: 20][epoch: 1][iter: 55] AFTER HANDLE:

[rank: 10][epoch: 1][iter: 55] AFTER HANDLE:
tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:2')
[rank: 2][epoch: 1][iter: 55] AFTER HANDLE:
tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:3')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:0')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:3')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:1')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:3')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:3')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:0')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:1')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:2')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:3')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:1')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:1')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:1')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:3')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:1')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:0')
[rank: 12][epoch: 1][iter: 55] AFTER HANDLE:
tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:0')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:2')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:2')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:0')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:2')
[rank: 14][epoch: 1][iter: 55] AFTER HANDLE:
tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:2')
[rank: 19][epoch: 1][iter: 55] NEW GRAD:

[rank: 4][epoch: 1][iter: 55] NEW GRAD:

[rank: 23][epoch: 1][iter: 55] AFTER HANDLE:

[rank: 9][epoch: 1][iter: 55] NEW GRAD:

[rank: 15][epoch: 1][iter: 55] AFTER HANDLE:

[rank: 3][epoch: 1][iter: 55] NEW GRAD:

[rank: 16][epoch: 1][iter: 55] NEW GRAD:

[rank: 5][epoch: 1][iter: 55] NEW GRAD:

[rank: 22][epoch: 1][iter: 55] AFTER HANDLE:

[rank: 11][epoch: 1][iter: 55] NEW GRAD:

[rank: 13][epoch: 1][iter: 55] NEW GRAD:

[rank: 1][epoch: 1][iter: 55] NEW GRAD:

[rank: 17][epoch: 1][iter: 55] NEW GRAD:

[rank: 7][epoch: 1][iter: 55] NEW GRAD:

[rank: 21][epoch: 1][iter: 55] NEW GRAD:

[rank: 8][epoch: 1][iter: 55] NEW GRAD:
tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:0')
[rank: 0][epoch: 1][iter: 55] NEW GRAD:

[rank: 18][epoch: 1][iter: 55] NEW GRAD:

[rank: 6][epoch: 1][iter: 55] NEW GRAD:

[rank: 20][epoch: 1][iter: 55] NEW GRAD:

[rank: 10][epoch: 1][iter: 55] NEW GRAD:
tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:2')
[rank: 2][epoch: 1][iter: 55] NEW GRAD:
tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:3')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:0')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:3')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:1')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:3')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:3')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:0')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:1')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:2')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:3')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:1')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:1')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:1')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:3')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:1')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:0')
[rank: 12][epoch: 1][iter: 55] NEW GRAD:
tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:0')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:2')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:2')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:0')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:2')
[rank: 14][epoch: 1][iter: 55] NEW GRAD:
tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:2')
[rank: 23][epoch: 1][iter: 55] NEW GRAD:

[rank: 15][epoch: 1][iter: 55] NEW GRAD:

[rank: 22][epoch: 1][iter: 55] NEW GRAD:
tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:0')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:3')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:2')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:2')tensor([-9.7431e-06, -7.3965e-05, -4.8613e-05,  ..., -1.2058e-04,
        -4.9116e-06, -6.2463e-05], device='cuda:3')
[rank: 19][epoch: 1][iter: 56] BEFORE:
tensor([-0.0002, -0.0002, -0.0001,  ..., -0.0002, -0.0003,  0.0001],
       device='cuda:3')
[rank: 4][epoch: 1][iter: 56] BEFORE:
tensor([-0.0005, -0.0005, -0.0002,  ...,  0.0003,  0.0004, -0.0010],
       device='cuda:0')
[rank: 3][epoch: 1][iter: 56] BEFORE:

[rank: 9][epoch: 1][iter: 56] BEFORE:
tensor([ 2.3681e-03,  2.4904e-03, -1.5076e-03,  ..., -3.4792e-06,
        -5.1521e-05, -1.2138e-05], device='cuda:3')
[rank: 16][epoch: 1][iter: 56] BEFORE:

[rank: 5][epoch: 1][iter: 56] BEFORE:
tensor([4.4478e-05, 5.8041e-05, 1.4900e-04,  ..., 1.3752e-04, 4.8113e-04,
        4.7492e-04], device='cuda:1')
[rank: 13][epoch: 1][iter: 56] BEFORE:

[rank: 1][epoch: 1][iter: 56] BEFORE:
tensor([ 6.4543e-04,  6.3877e-04, -9.1129e-05,  ..., -1.9546e-04,
        -6.4516e-05, -2.2410e-04], device='cuda:0')tensor([ 4.8911e-04, -1.6388e-05, -1.4915e-04,  ...,  6.8279e-05,
        -2.7506e-05,  4.4548e-04], device='cuda:1')
[rank: 11][epoch: 1][iter: 56] BEFORE:
tensor([-1.7501e-05, -1.0506e-04, -1.5673e-05,  ...,  1.0349e-04,
         9.0474e-06,  4.1806e-05], device='cuda:1')tensor([6.5025e-04, 6.6958e-04, 6.8922e-04,  ..., 9.0477e-05, 7.6265e-05,
        1.3576e-05], device='cuda:1')
[rank: 17][epoch: 1][iter: 56] BEFORE:

[rank: 7][epoch: 1][iter: 56] BEFORE:

[rank: 8][epoch: 1][iter: 56] BEFORE:

[rank: 0][epoch: 1][iter: 56] BEFORE:

[rank: 21][epoch: 1][iter: 56] BEFORE:
tensor([ 9.6605e-07,  2.0684e-05,  1.2923e-04,  ...,  1.5641e-05,
        -8.4094e-05,  2.5295e-04], device='cuda:1')tensor([ 1.5685e-03,  1.4100e-03,  1.3561e-03,  ...,  2.4586e-05,
        -1.9314e-06, -1.6844e-06], device='cuda:3')tensor([ 3.5617e-04, -1.8423e-03,  7.8282e-03,  ..., -4.1062e-05,
        -4.0265e-05, -4.6752e-05], device='cuda:3')tensor([3.3957e-06, 3.4368e-06, 9.2714e-05,  ..., 2.3536e-05, 1.1142e-04,
        1.1517e-04], device='cuda:0')
[rank: 20][epoch: 1][iter: 56] BEFORE:

[rank: 18][epoch: 1][iter: 56] BEFORE:
tensor([ 2.3402e-05,  7.0847e-05, -4.0665e-05,  ..., -1.3550e-04,
        -1.2869e-04, -1.2761e-04], device='cuda:0')
[rank: 2][epoch: 1][iter: 56] BEFORE:

[rank: 6][epoch: 1][iter: 56] BEFORE:
tensor([-1.4890e-04,  3.0669e-05,  2.8000e-04,  ...,  1.5843e-05,
         3.0442e-05,  3.5081e-05], device='cuda:1')
[rank: 12][epoch: 1][iter: 56] BEFORE:
tensor([ 5.2208e-05, -3.7412e-05,  2.2105e-05,  ...,  3.5496e-04,
         7.2570e-04, -2.4738e-05], device='cuda:2')
[rank: 10][epoch: 1][iter: 56] BEFORE:
tensor([-7.4572e-05, -1.3365e-04, -8.2620e-05,  ..., -4.3103e-06,
        -3.2930e-06,  1.0904e-04], device='cuda:2')tensor([ 9.6780e-05, -1.1701e-05, -2.6566e-05,  ..., -3.4126e-04,
         2.1925e-05,  4.0979e-05], device='cuda:0')tensor([-9.5496e-05,  8.0030e-05,  6.5992e-05,  ..., -5.5730e-06,
         3.3118e-05,  1.0365e-04], device='cuda:2')
[rank: 15][epoch: 1][iter: 56] BEFORE:

[rank: 19][epoch: 1][iter: 56] AFTER HANDLE:

[rank: 8][epoch: 1][iter: 56] AFTER HANDLE:

[rank: 0][epoch: 1][iter: 56] AFTER HANDLE:

[rank: 23][epoch: 1][iter: 56] BEFORE:

[rank: 5][epoch: 1][iter: 56] AFTER HANDLE:

[rank: 14][epoch: 1][iter: 56] BEFORE:

[rank: 16][epoch: 1][iter: 56] AFTER HANDLE:

[rank: 9][epoch: 1][iter: 56] AFTER HANDLE:

[rank: 1][epoch: 1][iter: 56] AFTER HANDLE:

[rank: 22][epoch: 1][iter: 56] BEFORE:

[rank: 4][epoch: 1][iter: 56] AFTER HANDLE:

[rank: 13][epoch: 1][iter: 56] AFTER HANDLE:

[rank: 17][epoch: 1][iter: 56] AFTER HANDLE:

[rank: 11][epoch: 1][iter: 56] AFTER HANDLE:

[rank: 3][epoch: 1][iter: 56] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 56] AFTER HANDLE:

[rank: 7][epoch: 1][iter: 56] AFTER HANDLE:
tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:0')
[rank: 18][epoch: 1][iter: 56] AFTER HANDLE:
tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:2')
[rank: 2][epoch: 1][iter: 56] AFTER HANDLE:

[rank: 20][epoch: 1][iter: 56] AFTER HANDLE:

[rank: 6][epoch: 1][iter: 56] AFTER HANDLE:
tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:3')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:3')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:0')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:0')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:3')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:1')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:2')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:0')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:1')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:1')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:2')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:0')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:1')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:1')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:3')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:3')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:1')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:3')
[rank: 12][epoch: 1][iter: 56] AFTER HANDLE:
tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:2')
[rank: 10][epoch: 1][iter: 56] AFTER HANDLE:
tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:2')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:0')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:2')
[rank: 15][epoch: 1][iter: 56] AFTER HANDLE:

[rank: 19][epoch: 1][iter: 56] NEW GRAD:

[rank: 8][epoch: 1][iter: 56] NEW GRAD:

[rank: 0][epoch: 1][iter: 56] NEW GRAD:

[rank: 23][epoch: 1][iter: 56] AFTER HANDLE:

[rank: 5][epoch: 1][iter: 56] NEW GRAD:

[rank: 14][epoch: 1][iter: 56] AFTER HANDLE:

[rank: 16][epoch: 1][iter: 56] NEW GRAD:

[rank: 9][epoch: 1][iter: 56] NEW GRAD:

[rank: 1][epoch: 1][iter: 56] NEW GRAD:

[rank: 22][epoch: 1][iter: 56] AFTER HANDLE:

[rank: 4][epoch: 1][iter: 56] NEW GRAD:

[rank: 13][epoch: 1][iter: 56] NEW GRAD:

[rank: 17][epoch: 1][iter: 56] NEW GRAD:

[rank: 11][epoch: 1][iter: 56] NEW GRAD:

[rank: 3][epoch: 1][iter: 56] NEW GRAD:

[rank: 21][epoch: 1][iter: 56] NEW GRAD:

[rank: 7][epoch: 1][iter: 56] NEW GRAD:
tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:0')
[rank: 18][epoch: 1][iter: 56] NEW GRAD:
tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:2')
[rank: 2][epoch: 1][iter: 56] NEW GRAD:

[rank: 20][epoch: 1][iter: 56] NEW GRAD:

[rank: 6][epoch: 1][iter: 56] NEW GRAD:
tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:3')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:3')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:0')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:0')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:3')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:1')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:2')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:0')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:1')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:1')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:2')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:0')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:1')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:1')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:3')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:3')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:1')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:3')
[rank: 12][epoch: 1][iter: 56] NEW GRAD:
tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:2')
[rank: 10][epoch: 1][iter: 56] NEW GRAD:
tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:2')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:0')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:2')
[rank: 15][epoch: 1][iter: 56] NEW GRAD:
tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:2')
[rank: 23][epoch: 1][iter: 56] NEW GRAD:

[rank: 14][epoch: 1][iter: 56] NEW GRAD:

[rank: 22][epoch: 1][iter: 56] NEW GRAD:
tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:0')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:3')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:3')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:2')tensor([ 2.2803e-04,  9.6487e-05,  3.3052e-04,  ..., -3.7452e-05,
         7.1976e-05, -8.5771e-05], device='cuda:2')
[rank: 19][epoch: 1][iter: 57] BEFORE:
tensor([ 1.1239e-04,  1.6551e-04, -1.6243e-04,  ..., -9.7847e-05,
         1.1970e-03, -1.8550e-04], device='cuda:3')
[rank: 8][epoch: 1][iter: 57] BEFORE:

[rank: 0][epoch: 1][iter: 57] BEFORE:
tensor([-8.7587e-05, -9.9044e-04,  3.9245e-05,  ...,  3.0791e-05,
        -3.6640e-07,  3.0931e-05], device='cuda:0')tensor([-1.3845e-04, -1.3757e-04, -1.3561e-04,  ...,  1.0647e-03,
         4.3824e-04,  8.7264e-05], device='cuda:0')
[rank: 5][epoch: 1][iter: 57] BEFORE:
tensor([ 2.6077e-04,  5.3446e-05,  3.2354e-05,  ...,  1.1248e-03,
        -4.0263e-04,  2.3865e-04], device='cuda:1')
[rank: 1][epoch: 1][iter: 57] BEFORE:

[rank: 16][epoch: 1][iter: 57] BEFORE:
tensor([ 1.2127e-04,  1.3393e-04,  1.1907e-04,  ...,  5.7018e-05,
        -2.8134e-04,  2.9902e-04], device='cuda:1')
[rank: 13][epoch: 1][iter: 57] BEFORE:
tensor([-0.0010, -0.0010,  0.0002,  ..., -0.0002,  0.0002,  0.0002],
       device='cuda:0')
[rank: 9][epoch: 1][iter: 57] BEFORE:

[rank: 4][epoch: 1][iter: 57] BEFORE:
tensor([ 0.0002,  0.0003, -0.0003,  ..., -0.0002, -0.0009, -0.0005],
       device='cuda:1')
[rank: 17][epoch: 1][iter: 57] BEFORE:
tensor([ 1.1393e-04, -4.4551e-05,  5.7667e-06,  ..., -3.8853e-05,
        -1.1597e-04, -9.4884e-05], device='cuda:1')tensor([-2.7823e-05,  6.3881e-05, -5.1026e-05,  ..., -5.3357e-05,
        -1.0569e-04, -1.0037e-04], device='cuda:0')
[rank: 3][epoch: 1][iter: 57] BEFORE:
tensor([-1.3670e-04, -9.5046e-04,  3.5363e-07,  ..., -6.6111e-04,
        -6.3045e-04, -5.5826e-04], device='cuda:1')
[rank: 11][epoch: 1][iter: 57] BEFORE:

[rank: 21][epoch: 1][iter: 57] BEFORE:

[rank: 7][epoch: 1][iter: 57] BEFORE:
tensor([ 7.7795e-05,  1.4694e-05, -2.6913e-05,  ...,  4.2379e-05,
         1.3792e-04,  2.1830e-04], device='cuda:3')
[rank: 18][epoch: 1][iter: 57] BEFORE:
tensor([ 1.3583e-06,  1.0743e-05, -3.0689e-06,  ...,  1.1452e-04,
        -4.6532e-05,  4.3935e-05], device='cuda:3')tensor([-1.1146e-04, -6.4989e-05, -1.2428e-04,  ...,  5.3279e-04,
         1.2358e-04, -1.9319e-04], device='cuda:1')
[rank: 6][epoch: 1][iter: 57] BEFORE:

[rank: 2][epoch: 1][iter: 57] BEFORE:
tensor([-1.9013e-04,  3.8726e-04, -2.3435e-04,  ...,  9.2054e-05,
        -1.0752e-04,  6.9767e-05], device='cuda:2')
[rank: 10][epoch: 1][iter: 57] BEFORE:

[rank: 20][epoch: 1][iter: 57] BEFORE:
tensor([ 1.5536e-04,  7.2331e-05,  1.1335e-04,  ...,  1.5555e-04,
        -1.1891e-05, -1.1926e-05], device='cuda:3')
[rank: 12][epoch: 1][iter: 57] BEFORE:
tensor([-3.5763e-05, -6.3267e-05, -6.5690e-05,  ..., -5.0672e-05,
         1.7881e-04, -6.5069e-05], device='cuda:2')tensor([-1.1799e-04,  4.9151e-05, -2.5153e-05,  ...,  1.0911e-05,
         1.3429e-05,  8.7812e-05], device='cuda:2')
[rank: 23][epoch: 1][iter: 57] BEFORE:
tensor([-1.0689e-04,  1.8452e-04, -8.0229e-05,  ..., -1.1374e-04,
         1.3366e-05, -9.5282e-05], device='cuda:2')
[rank: 15][epoch: 1][iter: 57] BEFORE:

[rank: 2][epoch: 1][iter: 57] AFTER HANDLE:

[rank: 10][epoch: 1][iter: 57] AFTER HANDLE:

[rank: 19][epoch: 1][iter: 57] AFTER HANDLE:
tensor([ 6.3631e-03,  6.3633e-03,  6.3308e-03,  ..., -2.4740e-05,
         4.1034e-05, -2.4061e-05], device='cuda:0')
[rank: 5][epoch: 1][iter: 57] AFTER HANDLE:

[rank: 14][epoch: 1][iter: 57] BEFORE:

[rank: 0][epoch: 1][iter: 57] AFTER HANDLE:

[rank: 9][epoch: 1][iter: 57] AFTER HANDLE:

[rank: 18][epoch: 1][iter: 57] AFTER HANDLE:

[rank: 22][epoch: 1][iter: 57] BEFORE:

[rank: 7][epoch: 1][iter: 57] AFTER HANDLE:
tensor([-1.4717e-04, -1.4676e-04, -1.4506e-04,  ...,  1.7101e-04,
        -4.1606e-05,  1.7098e-04], device='cuda:0')
[rank: 1][epoch: 1][iter: 57] AFTER HANDLE:

[rank: 8][epoch: 1][iter: 57] AFTER HANDLE:

[rank: 16][epoch: 1][iter: 57] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 57] AFTER HANDLE:

[rank: 4][epoch: 1][iter: 57] AFTER HANDLE:

[rank: 13][epoch: 1][iter: 57] AFTER HANDLE:

[rank: 3][epoch: 1][iter: 57] AFTER HANDLE:

[rank: 11][epoch: 1][iter: 57] AFTER HANDLE:

[rank: 17][epoch: 1][iter: 57] AFTER HANDLE:
tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:3')
[rank: 6][epoch: 1][iter: 57] AFTER HANDLE:
tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:3')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:2')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:2')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:3')
[rank: 20][epoch: 1][iter: 57] AFTER HANDLE:
tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:1')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:2')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:0')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:1')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:2')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:2')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:3')
[rank: 12][epoch: 1][iter: 57] AFTER HANDLE:
tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:1')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:0')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:0')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:1')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:0')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:1')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:3')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:3')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:1')
[rank: 23][epoch: 1][iter: 57] AFTER HANDLE:
tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:2')
[rank: 15][epoch: 1][iter: 57] AFTER HANDLE:

[rank: 2][epoch: 1][iter: 57] NEW GRAD:

[rank: 10][epoch: 1][iter: 57] NEW GRAD:

[rank: 19][epoch: 1][iter: 57] NEW GRAD:
tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:0')
[rank: 5][epoch: 1][iter: 57] NEW GRAD:

[rank: 14][epoch: 1][iter: 57] AFTER HANDLE:

[rank: 0][epoch: 1][iter: 57] NEW GRAD:

[rank: 9][epoch: 1][iter: 57] NEW GRAD:

[rank: 18][epoch: 1][iter: 57] NEW GRAD:

[rank: 22][epoch: 1][iter: 57] AFTER HANDLE:

[rank: 7][epoch: 1][iter: 57] NEW GRAD:
tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:0')
[rank: 1][epoch: 1][iter: 57] NEW GRAD:

[rank: 8][epoch: 1][iter: 57] NEW GRAD:

[rank: 16][epoch: 1][iter: 57] NEW GRAD:

[rank: 21][epoch: 1][iter: 57] NEW GRAD:

[rank: 4][epoch: 1][iter: 57] NEW GRAD:

[rank: 13][epoch: 1][iter: 57] NEW GRAD:

[rank: 3][epoch: 1][iter: 57] NEW GRAD:

[rank: 11][epoch: 1][iter: 57] NEW GRAD:

[rank: 17][epoch: 1][iter: 57] NEW GRAD:
tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:3')
[rank: 6][epoch: 1][iter: 57] NEW GRAD:
tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:3')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:2')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:2')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:3')
[rank: 20][epoch: 1][iter: 57] NEW GRAD:
tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:1')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:2')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:0')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:1')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:2')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:2')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:3')
[rank: 12][epoch: 1][iter: 57] NEW GRAD:
tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:1')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:0')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:0')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:1')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:0')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:1')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:3')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:3')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:1')
[rank: 23][epoch: 1][iter: 57] NEW GRAD:
tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:2')
[rank: 15][epoch: 1][iter: 57] NEW GRAD:
tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:0')
[rank: 14][epoch: 1][iter: 57] NEW GRAD:

[rank: 22][epoch: 1][iter: 57] NEW GRAD:
tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:0')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:3')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:3')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:2')tensor([ 2.2670e-04,  2.0381e-04,  2.1683e-04,  ...,  5.9775e-05,
        -1.2577e-05, -1.4493e-05], device='cuda:2')
[rank: 10][epoch: 1][iter: 58] BEFORE:

[rank: 19][epoch: 1][iter: 58] BEFORE:

[rank: 2][epoch: 1][iter: 58] BEFORE:
tensor([-9.4034e-05, -1.6599e-05, -2.4027e-05,  ..., -6.9751e-04,
        -2.4881e-04, -6.9048e-04], device='cuda:2')
[rank: 5][epoch: 1][iter: 58] BEFORE:
tensor([-2.0585e-04,  1.3081e-03, -2.1690e-04,  ...,  8.1040e-05,
         1.0556e-04,  8.3675e-05], device='cuda:3')tensor([ 3.3711e-05,  3.7594e-04,  3.8854e-04,  ..., -1.5890e-04,
        -3.7737e-04, -1.7313e-04], device='cuda:2')tensor([-2.9613e-04, -2.3250e-04,  1.5827e-04,  ..., -1.5503e-04,
        -8.2918e-06, -8.6772e-05], device='cuda:1')
[rank: 0][epoch: 1][iter: 58] BEFORE:

[rank: 18][epoch: 1][iter: 58] BEFORE:

[rank: 7][epoch: 1][iter: 58] BEFORE:

[rank: 9][epoch: 1][iter: 58] BEFORE:
tensor([ 5.2744e-04,  3.9570e-04, -2.8270e-04,  ..., -9.7708e-05,
        -1.0751e-04,  3.6537e-04], device='cuda:0')tensor([ 1.3273e-05,  8.1573e-05,  3.0451e-05,  ..., -5.0013e-06,
        -7.5675e-05, -4.9630e-06], device='cuda:2')tensor([-2.6618e-04, -7.3004e-05, -3.7824e-06,  ..., -1.9288e-04,
        -2.1189e-04,  3.6509e-04], device='cuda:3')
[rank: 8][epoch: 1][iter: 58] BEFORE:

[rank: 16][epoch: 1][iter: 58] BEFORE:
tensor([3.4887e-06, 8.4464e-06, 3.5763e-06,  ..., 1.4998e-05, 2.8745e-06,
        7.4110e-06], device='cuda:1')
[rank: 13][epoch: 1][iter: 58] BEFORE:
tensor([-4.8955e-05,  2.5174e-04,  1.6497e-05,  ...,  3.2798e-05,
        -4.6181e-05, -1.1420e-04], device='cuda:0')tensor([ 1.5263e-04, -1.2800e-04, -1.4376e-04,  ..., -3.2300e-04,
        -3.2895e-05, -5.5623e-04], device='cuda:0')
[rank: 1][epoch: 1][iter: 58] BEFORE:

[rank: 4][epoch: 1][iter: 58] BEFORE:
tensor([ 9.0747e-04,  4.0825e-04, -2.0878e-04,  ..., -3.5204e-05,
         3.1812e-04,  1.7260e-04], device='cuda:1')
[rank: 21][epoch: 1][iter: 58] BEFORE:

[rank: 11][epoch: 1][iter: 58] BEFORE:
tensor([-8.5308e-05, -1.5365e-04,  5.5818e-05,  ...,  6.8082e-05,
         2.5809e-05,  1.7911e-06], device='cuda:1')tensor([ 0.0003, -0.0008, -0.0006,  ..., -0.0003, -0.0002, -0.0004],
       device='cuda:0')
[rank: 17][epoch: 1][iter: 58] BEFORE:
tensor([ 1.6597e-05, -3.0321e-05,  1.8373e-05,  ..., -6.0057e-06,
        -7.9181e-06, -8.7522e-06], device='cuda:1')tensor([-1.6069e-05,  5.2541e-05,  5.0175e-05,  ...,  1.6337e-05,
        -3.6736e-05,  9.9301e-06], device='cuda:3')
[rank: 3][epoch: 1][iter: 58] BEFORE:
tensor([-4.7664e-04, -1.2877e-05, -5.0605e-04,  ..., -4.0072e-06,
        -1.6228e-05,  7.4554e-05], device='cuda:1')
[rank: 15][epoch: 1][iter: 58] BEFORE:

[rank: 20][epoch: 1][iter: 58] BEFORE:

[rank: 6][epoch: 1][iter: 58] BEFORE:
tensor([-1.3937e-04,  7.2944e-05, -3.2337e-05,  ..., -7.2559e-05,
        -2.2507e-04, -1.2184e-04], device='cuda:3')
[rank: 12][epoch: 1][iter: 58] BEFORE:

[rank: 16][epoch: 1][iter: 58] AFTER HANDLE:

[rank: 10][epoch: 1][iter: 58] AFTER HANDLE:

[rank: 23][epoch: 1][iter: 58] BEFORE:

[rank: 5][epoch: 1][iter: 58] AFTER HANDLE:

[rank: 0][epoch: 1][iter: 58] AFTER HANDLE:

[rank: 14][epoch: 1][iter: 58] BEFORE:

[rank: 19][epoch: 1][iter: 58] AFTER HANDLE:

[rank: 9][epoch: 1][iter: 58] AFTER HANDLE:

[rank: 22][epoch: 1][iter: 58] BEFORE:

[rank: 4][epoch: 1][iter: 58] AFTER HANDLE:

[rank: 1][epoch: 1][iter: 58] AFTER HANDLE:

[rank: 13][epoch: 1][iter: 58] AFTER HANDLE:

[rank: 18][epoch: 1][iter: 58] AFTER HANDLE:

[rank: 11][epoch: 1][iter: 58] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 58] AFTER HANDLE:

[rank: 7][epoch: 1][iter: 58] AFTER HANDLE:

[rank: 2][epoch: 1][iter: 58] AFTER HANDLE:
tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:3')
[rank: 17][epoch: 1][iter: 58] AFTER HANDLE:

[rank: 8][epoch: 1][iter: 58] AFTER HANDLE:
tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:0')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:2')
[rank: 3][epoch: 1][iter: 58] AFTER HANDLE:
tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:0')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:0')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:2')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:3')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:1')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:0')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:2')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:3')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:1')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:2')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:0')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:1')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:1')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:2')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:3')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:1')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:3')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:2')
[rank: 15][epoch: 1][iter: 58] AFTER HANDLE:
tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:1')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:0')
[rank: 20][epoch: 1][iter: 58] AFTER HANDLE:

[rank: 6][epoch: 1][iter: 58] AFTER HANDLE:
tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:3')
[rank: 12][epoch: 1][iter: 58] AFTER HANDLE:

[rank: 16][epoch: 1][iter: 58] NEW GRAD:

[rank: 10][epoch: 1][iter: 58] NEW GRAD:

[rank: 23][epoch: 1][iter: 58] AFTER HANDLE:

[rank: 5][epoch: 1][iter: 58] NEW GRAD:

[rank: 0][epoch: 1][iter: 58] NEW GRAD:

[rank: 14][epoch: 1][iter: 58] AFTER HANDLE:

[rank: 19][epoch: 1][iter: 58] NEW GRAD:

[rank: 9][epoch: 1][iter: 58] NEW GRAD:

[rank: 22][epoch: 1][iter: 58] AFTER HANDLE:

[rank: 4][epoch: 1][iter: 58] NEW GRAD:

[rank: 1][epoch: 1][iter: 58] NEW GRAD:

[rank: 13][epoch: 1][iter: 58] NEW GRAD:

[rank: 18][epoch: 1][iter: 58] NEW GRAD:

[rank: 11][epoch: 1][iter: 58] NEW GRAD:

[rank: 21][epoch: 1][iter: 58] NEW GRAD:

[rank: 7][epoch: 1][iter: 58] NEW GRAD:

[rank: 2][epoch: 1][iter: 58] NEW GRAD:
tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:3')
[rank: 17][epoch: 1][iter: 58] NEW GRAD:

[rank: 8][epoch: 1][iter: 58] NEW GRAD:
tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:0')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:2')
[rank: 3][epoch: 1][iter: 58] NEW GRAD:
tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:0')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:0')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:2')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:3')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:1')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:0')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:2')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:3')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:1')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:2')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:0')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:1')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:1')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:2')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:3')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:1')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:3')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:2')
[rank: 15][epoch: 1][iter: 58] NEW GRAD:
tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:1')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:0')
[rank: 20][epoch: 1][iter: 58] NEW GRAD:

[rank: 6][epoch: 1][iter: 58] NEW GRAD:
tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:3')
[rank: 12][epoch: 1][iter: 58] NEW GRAD:

[rank: 23][epoch: 1][iter: 58] NEW GRAD:
tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:2')
[rank: 14][epoch: 1][iter: 58] NEW GRAD:

[rank: 22][epoch: 1][iter: 58] NEW GRAD:
tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:3')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:0')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:0')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:3')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:2')tensor([-2.7022e-05,  9.6668e-06, -5.1079e-05,  ..., -6.2637e-05,
        -4.9504e-05, -3.9218e-05], device='cuda:2')
[rank: 16][epoch: 1][iter: 59] BEFORE:

[rank: 10][epoch: 1][iter: 59] BEFORE:
tensor([-7.1915e-05,  1.6859e-04,  6.5016e-06,  ..., -1.0108e-04,
        -8.5123e-05, -1.2406e-04], device='cuda:0')
[rank: 5][epoch: 1][iter: 59] BEFORE:
tensor([ 1.4607e-05,  1.4636e-05,  1.4520e-05,  ...,  1.1540e-05,
        -2.1384e-05, -2.5319e-06], device='cuda:2')
[rank: 0][epoch: 1][iter: 59] BEFORE:

[rank: 19][epoch: 1][iter: 59] BEFORE:
tensor([ 1.0138e-04,  3.8573e-05,  3.8185e-04,  ...,  3.8397e-05,
         3.9017e-05, -4.5141e-05], device='cuda:1')tensor([-1.8791e-04, -2.0235e-04, -2.7347e-04,  ..., -7.1911e-05,
        -6.8829e-05, -7.0988e-05], device='cuda:0')tensor([ 1.3855e-04, -1.0820e-04,  7.5011e-04,  ..., -1.7776e-04,
        -1.3574e-04, -8.2254e-05], device='cuda:3')
[rank: 9][epoch: 1][iter: 59] BEFORE:

[rank: 4][epoch: 1][iter: 59] BEFORE:

[rank: 1][epoch: 1][iter: 59] BEFORE:

[rank: 13][epoch: 1][iter: 59] BEFORE:
tensor([-1.3991e-06,  8.6091e-06,  9.5866e-06,  ...,  2.4055e-04,
        -4.1030e-04,  8.6759e-04], device='cuda:1')tensor([ 3.5581e-04,  1.8503e-04, -1.8075e-05,  ..., -1.8796e-04,
         3.7073e-04,  2.4309e-04], device='cuda:0')
[rank: 18][epoch: 1][iter: 59] BEFORE:
tensor([ 7.6263e-04, -5.7712e-05, -2.4023e-04,  ...,  2.4174e-04,
         1.9575e-04,  6.4542e-05], device='cuda:1')
[rank: 11][epoch: 1][iter: 59] BEFORE:

[rank: 7][epoch: 1][iter: 59] BEFORE:

[rank: 2][epoch: 1][iter: 59] BEFORE:
tensor([-1.1310e-05, -9.5904e-05,  8.5585e-05,  ..., -3.5183e-05,
        -3.0622e-04, -1.2773e-04], device='cuda:2')tensor([ 0.0016, -0.0004, -0.0008,  ..., -0.0017, -0.0005, -0.0003],
       device='cuda:3')
[rank: 21][epoch: 1][iter: 59] BEFORE:
tensor([-6.6891e-04, -2.3252e-04, -1.0138e-04,  ..., -1.5339e-05,
        -3.5257e-05, -3.5363e-05], device='cuda:3')
[rank: 3][epoch: 1][iter: 59] BEFORE:

[rank: 17][epoch: 1][iter: 59] BEFORE:

[rank: 8][epoch: 1][iter: 59] BEFORE:
tensor([-6.4542e-06, -6.3641e-06, -6.4231e-06,  ..., -1.9266e-05,
        -2.3368e-06,  4.4301e-05], device='cuda:1')
[rank: 6][epoch: 1][iter: 59] BEFORE:
tensor([ 1.5184e-08,  1.1620e-08,  6.0797e-08,  ...,  2.9701e-05,
         1.1262e-05, -5.6994e-05], device='cuda:2')
[rank: 15][epoch: 1][iter: 59] BEFORE:
tensor([ 1.4360e-04,  3.3944e-04,  1.3267e-05,  ..., -1.5875e-04,
        -1.5770e-04, -1.5315e-04], device='cuda:1')tensor([ 1.9075e-04,  1.8439e-05,  4.6533e-05,  ...,  1.8789e-04,
        -3.5984e-04, -2.8495e-04], device='cuda:0')tensor([-6.0057e-05, -3.3273e-04, -2.0153e-05,  ..., -1.8192e-05,
         7.5517e-06, -7.5854e-07], device='cuda:3')tensor([-8.7330e-05,  2.0105e-05,  5.2431e-05,  ..., -1.3805e-04,
         6.4587e-05,  7.1292e-05], device='cuda:2')
[rank: 20][epoch: 1][iter: 59] BEFORE:

[rank: 12][epoch: 1][iter: 59] BEFORE:

[rank: 0][epoch: 1][iter: 59] AFTER HANDLE:

[rank: 10][epoch: 1][iter: 59] AFTER HANDLE:

[rank: 19][epoch: 1][iter: 59] AFTER HANDLE:

[rank: 6][epoch: 1][iter: 59] AFTER HANDLE:

[rank: 23][epoch: 1][iter: 59] BEFORE:
tensor([ 5.5350e-04, -7.5171e-05, -6.5945e-04,  ...,  3.6389e-04,
         5.6122e-04,  1.6852e-05], device='cuda:3')
[rank: 2][epoch: 1][iter: 59] AFTER HANDLE:

[rank: 11][epoch: 1][iter: 59] AFTER HANDLE:

[rank: 16][epoch: 1][iter: 59] AFTER HANDLE:

[rank: 5][epoch: 1][iter: 59] AFTER HANDLE:

[rank: 22][epoch: 1][iter: 59] BEFORE:

[rank: 14][epoch: 1][iter: 59] BEFORE:

[rank: 3][epoch: 1][iter: 59] AFTER HANDLE:

[rank: 9][epoch: 1][iter: 59] AFTER HANDLE:

[rank: 17][epoch: 1][iter: 59] AFTER HANDLE:

[rank: 7][epoch: 1][iter: 59] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 59] AFTER HANDLE:
tensor([0.0004, 0.0002, 0.0005,  ..., 0.0000, 0.0000, 0.0000], device='cuda:1')
[rank: 13][epoch: 1][iter: 59] AFTER HANDLE:

[rank: 1][epoch: 1][iter: 59] AFTER HANDLE:

[rank: 8][epoch: 1][iter: 59] AFTER HANDLE:

[rank: 18][epoch: 1][iter: 59] AFTER HANDLE:

[rank: 4][epoch: 1][iter: 59] AFTER HANDLE:
tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:0')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:0')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:0')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:2')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:3')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:2')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:3')
[rank: 15][epoch: 1][iter: 59] AFTER HANDLE:
tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:2')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:3')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:0')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:1')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:2')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:2')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:3')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:1')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:1')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:3')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:1')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:1')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:1')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:0')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:2')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:0')
[rank: 20][epoch: 1][iter: 59] AFTER HANDLE:

[rank: 12][epoch: 1][iter: 59] AFTER HANDLE:

[rank: 0][epoch: 1][iter: 59] NEW GRAD:

[rank: 10][epoch: 1][iter: 59] NEW GRAD:

[rank: 19][epoch: 1][iter: 59] NEW GRAD:

[rank: 6][epoch: 1][iter: 59] NEW GRAD:

[rank: 23][epoch: 1][iter: 59] AFTER HANDLE:
tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:3')
[rank: 2][epoch: 1][iter: 59] NEW GRAD:

[rank: 11][epoch: 1][iter: 59] NEW GRAD:

[rank: 16][epoch: 1][iter: 59] NEW GRAD:

[rank: 5][epoch: 1][iter: 59] NEW GRAD:

[rank: 22][epoch: 1][iter: 59] AFTER HANDLE:

[rank: 14][epoch: 1][iter: 59] AFTER HANDLE:

[rank: 3][epoch: 1][iter: 59] NEW GRAD:

[rank: 9][epoch: 1][iter: 59] NEW GRAD:

[rank: 17][epoch: 1][iter: 59] NEW GRAD:

[rank: 7][epoch: 1][iter: 59] NEW GRAD:

[rank: 21][epoch: 1][iter: 59] NEW GRAD:

[rank: 13][epoch: 1][iter: 59] NEW GRAD:

[rank: 1][epoch: 1][iter: 59] NEW GRAD:

[rank: 8][epoch: 1][iter: 59] NEW GRAD:

[rank: 18][epoch: 1][iter: 59] NEW GRAD:

[rank: 4][epoch: 1][iter: 59] NEW GRAD:
tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:0')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:0')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:0')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:2')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:3')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:2')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:3')
[rank: 15][epoch: 1][iter: 59] NEW GRAD:
tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:2')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:3')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:0')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:1')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:2')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:2')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:3')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:1')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:1')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:3')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:1')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:1')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:1')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:0')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:2')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:0')
[rank: 20][epoch: 1][iter: 59] NEW GRAD:

[rank: 12][epoch: 1][iter: 59] NEW GRAD:

[rank: 23][epoch: 1][iter: 59] NEW GRAD:
tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:3')
[rank: 22][epoch: 1][iter: 59] NEW GRAD:

[rank: 14][epoch: 1][iter: 59] NEW GRAD:
tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:0')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:0')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:3')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:2')tensor([ 1.4271e-04, -2.3157e-05, -1.2765e-05,  ..., -8.4625e-05,
        -6.1368e-05, -4.1334e-05], device='cuda:2')
[rank: 0][epoch: 1][iter: 60] BEFORE:

[rank: 19][epoch: 1][iter: 60] BEFORE:

[rank: 10][epoch: 1][iter: 60] BEFORE:
tensor([ 1.0502e-06,  3.9298e-07,  3.5405e-07,  ..., -7.2983e-05,
         1.2098e-04, -3.6570e-04], device='cuda:0')tensor([-2.5282e-05, -1.0808e-05, -2.0002e-05,  ...,  8.1499e-06,
        -6.5985e-05, -2.7230e-05], device='cuda:3')tensor([-2.8470e-06, -7.7516e-06, -4.6926e-06,  ...,  3.2379e-04,
         3.5859e-04,  7.3480e-05], device='cuda:2')
[rank: 11][epoch: 1][iter: 60] BEFORE:

[rank: 2][epoch: 1][iter: 60] BEFORE:
tensor([ 8.6415e-06,  5.0971e-05,  2.6403e-04,  ...,  3.5902e-04,
        -6.0298e-04,  2.3222e-05], device='cuda:3')tensor([8.6954e-06, 6.7164e-06, 8.6885e-06,  ..., 5.4642e-06, 6.3999e-05,
        4.1116e-06], device='cuda:2')
[rank: 5][epoch: 1][iter: 60] BEFORE:

[rank: 6][epoch: 1][iter: 60] BEFORE:
tensor([-1.2901e-04, -1.0238e-04, -2.5851e-05,  ...,  1.9842e-04,
        -2.2606e-05, -1.4400e-04], device='cuda:1')tensor([ 5.0490e-04,  1.9667e-04,  2.0165e-04,  ..., -1.1844e-04,
         1.1142e-04,  7.2258e-05], device='cuda:2')
[rank: 3][epoch: 1][iter: 60] BEFORE:
tensor([-9.3946e-06,  6.6719e-06,  6.6393e-06,  ..., -3.4849e-04,
         3.9200e-04,  3.3025e-04], device='cuda:3')
[rank: 17][epoch: 1][iter: 60] BEFORE:

[rank: 7][epoch: 1][iter: 60] BEFORE:

[rank: 9][epoch: 1][iter: 60] BEFORE:
tensor([-2.0560e-04, -2.6390e-04, -2.3837e-04,  ...,  6.8559e-05,
         4.5942e-05,  1.9958e-04], device='cuda:1')tensor([ 3.4656e-05,  3.0630e-05,  3.0362e-05,  ...,  1.5479e-03,
        -3.3345e-04, -1.0376e-04], device='cuda:3')
[rank: 13][epoch: 1][iter: 60] BEFORE:

[rank: 1][epoch: 1][iter: 60] BEFORE:
tensor([-4.1737e-05,  4.0993e-05,  1.3054e-06,  ..., -9.9275e-05,
         2.7724e-04, -2.9494e-04], device='cuda:1')
[rank: 16][epoch: 1][iter: 60] BEFORE:
tensor([2.6626e-05, 8.7432e-05, 2.2692e-05,  ..., 6.5882e-05, 6.8435e-05,
        2.2808e-05], device='cuda:1')
[rank: 21][epoch: 1][iter: 60] BEFORE:
tensor([ 4.8531e-05, -2.5396e-04,  3.3732e-05,  ...,  2.9646e-04,
        -7.2608e-05, -3.0538e-05], device='cuda:1')
[rank: 8][epoch: 1][iter: 60] BEFORE:

[rank: 4][epoch: 1][iter: 60] BEFORE:

[rank: 18][epoch: 1][iter: 60] BEFORE:

[rank: 15][epoch: 1][iter: 60] BEFORE:
tensor([ 3.6167e-04,  5.0969e-06,  2.4346e-04,  ...,  5.5628e-06,
         2.1155e-06, -6.5334e-06], device='cuda:1')tensor([-1.2184e-04, -1.7943e-05, -1.5331e-04,  ...,  2.9915e-04,
         3.5463e-04,  1.9945e-04], device='cuda:0')tensor([ 1.4223e-05, -1.1549e-04,  1.3269e-05,  ..., -1.5767e-04,
        -1.1931e-03, -3.4242e-04], device='cuda:0')tensor([ 1.4580e-04, -4.5114e-04,  2.2235e-05,  ..., -6.7355e-05,
        -1.0317e-04, -3.2095e-04], device='cuda:0')tensor([ 3.4769e-05, -9.4797e-05,  2.4585e-06,  ..., -1.9891e-03,
        -7.4071e-04, -8.9089e-05], device='cuda:3')
[rank: 20][epoch: 1][iter: 60] BEFORE:
tensor([-2.1835e-04, -1.3979e-04, -1.1140e-04,  ..., -2.1598e-04,
         8.2007e-05,  1.7673e-03], device='cuda:2')
[rank: 12][epoch: 1][iter: 60] BEFORE:

[rank: 23][epoch: 1][iter: 60] BEFORE:

[rank: 2][epoch: 1][iter: 60] AFTER HANDLE:

[rank: 8][epoch: 1][iter: 60] AFTER HANDLE:

[rank: 4][epoch: 1][iter: 60] AFTER HANDLE:

[rank: 19][epoch: 1][iter: 60] AFTER HANDLE:

[rank: 14][epoch: 1][iter: 60] BEFORE:

[rank: 22][epoch: 1][iter: 60] BEFORE:

[rank: 3][epoch: 1][iter: 60] AFTER HANDLE:

[rank: 10][epoch: 1][iter: 60] AFTER HANDLE:

[rank: 6][epoch: 1][iter: 60] AFTER HANDLE:

[rank: 16][epoch: 1][iter: 60] AFTER HANDLE:

[rank: 13][epoch: 1][iter: 60] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 60] AFTER HANDLE:

[rank: 1][epoch: 1][iter: 60] AFTER HANDLE:

[rank: 11][epoch: 1][iter: 60] AFTER HANDLE:

[rank: 5][epoch: 1][iter: 60] AFTER HANDLE:

[rank: 17][epoch: 1][iter: 60] AFTER HANDLE:

[rank: 15][epoch: 1][iter: 60] AFTER HANDLE:
tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:0')
[rank: 0][epoch: 1][iter: 60] AFTER HANDLE:

[rank: 9][epoch: 1][iter: 60] AFTER HANDLE:

[rank: 7][epoch: 1][iter: 60] AFTER HANDLE:

[rank: 18][epoch: 1][iter: 60] AFTER HANDLE:
tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:0')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:3')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:2')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:0')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:0')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:3')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:2')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:2')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:3')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:2')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:2')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:0')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:1')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:1')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:1')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:3')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:1')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:1')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:3')
[rank: 20][epoch: 1][iter: 60] AFTER HANDLE:
tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:0')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:1')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:3')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:2')
[rank: 12][epoch: 1][iter: 60] AFTER HANDLE:

[rank: 23][epoch: 1][iter: 60] AFTER HANDLE:

[rank: 2][epoch: 1][iter: 60] NEW GRAD:

[rank: 8][epoch: 1][iter: 60] NEW GRAD:

[rank: 4][epoch: 1][iter: 60] NEW GRAD:

[rank: 19][epoch: 1][iter: 60] NEW GRAD:

[rank: 14][epoch: 1][iter: 60] AFTER HANDLE:

[rank: 22][epoch: 1][iter: 60] AFTER HANDLE:

[rank: 3][epoch: 1][iter: 60] NEW GRAD:

[rank: 10][epoch: 1][iter: 60] NEW GRAD:

[rank: 6][epoch: 1][iter: 60] NEW GRAD:

[rank: 16][epoch: 1][iter: 60] NEW GRAD:

[rank: 13][epoch: 1][iter: 60] NEW GRAD:

[rank: 21][epoch: 1][iter: 60] NEW GRAD:

[rank: 1][epoch: 1][iter: 60] NEW GRAD:

[rank: 11][epoch: 1][iter: 60] NEW GRAD:

[rank: 5][epoch: 1][iter: 60] NEW GRAD:

[rank: 17][epoch: 1][iter: 60] NEW GRAD:

[rank: 15][epoch: 1][iter: 60] NEW GRAD:
tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:0')
[rank: 0][epoch: 1][iter: 60] NEW GRAD:

[rank: 9][epoch: 1][iter: 60] NEW GRAD:

[rank: 7][epoch: 1][iter: 60] NEW GRAD:

[rank: 18][epoch: 1][iter: 60] NEW GRAD:
tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:0')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:3')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:2')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:0')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:0')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:3')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:2')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:2')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:3')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:2')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:2')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:0')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:1')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:1')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:1')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:3')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:1')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:1')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:3')
[rank: 20][epoch: 1][iter: 60] NEW GRAD:
tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:0')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:1')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:3')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:2')
[rank: 12][epoch: 1][iter: 60] NEW GRAD:

[rank: 23][epoch: 1][iter: 60] NEW GRAD:

[rank: 14][epoch: 1][iter: 60] NEW GRAD:

[rank: 22][epoch: 1][iter: 60] NEW GRAD:
tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:0')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:0')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:2')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:3')tensor([-1.2443e-05,  7.7308e-06, -6.9461e-05,  ..., -2.1878e-05,
        -4.5228e-05,  6.6739e-05], device='cuda:2')
[rank: 8][epoch: 1][iter: 61] BEFORE:

[rank: 4][epoch: 1][iter: 61] BEFORE:

[rank: 2][epoch: 1][iter: 61] BEFORE:
tensor([ 5.1645e-05, -9.4079e-05, -1.8097e-04,  ...,  6.6516e-05,
         5.1750e-06, -2.2124e-05], device='cuda:0')tensor([-6.3326e-05, -8.5960e-06, -7.0718e-05,  ..., -2.6151e-05,
         2.4944e-04, -3.0632e-06], device='cuda:0')
[rank: 19][epoch: 1][iter: 61] BEFORE:
tensor([ 1.6443e-04, -3.1773e-05, -7.1883e-05,  ...,  8.2065e-05,
         8.2724e-05, -1.1451e-05], device='cuda:2')
[rank: 10][epoch: 1][iter: 61] BEFORE:

[rank: 3][epoch: 1][iter: 61] BEFORE:
tensor([-1.5343e-04, -7.5471e-05, -8.9651e-05,  ..., -3.9625e-03,
        -3.0363e-03,  2.7679e-04], device='cuda:3')
[rank: 13][epoch: 1][iter: 61] BEFORE:

[rank: 6][epoch: 1][iter: 61] BEFORE:
tensor([-1.0130e-03,  3.6221e-04, -6.0076e-05,  ...,  2.2939e-06,
         1.8531e-04,  3.0335e-04], device='cuda:2')
[rank: 16][epoch: 1][iter: 61] BEFORE:
tensor([-5.0406e-05, -3.0847e-05, -3.5738e-05,  ..., -2.7422e-05,
        -2.7653e-05, -2.4126e-04], device='cuda:3')tensor([ 3.4268e-04,  1.4214e-04,  2.8393e-04,  ..., -1.0397e-04,
         1.5629e-04,  2.9127e-05], device='cuda:1')tensor([-2.4918e-04,  5.4503e-04,  4.1270e-05,  ...,  6.5697e-05,
        -1.8704e-04, -1.5397e-04], device='cuda:2')
[rank: 11][epoch: 1][iter: 61] BEFORE:

[rank: 17][epoch: 1][iter: 61] BEFORE:

[rank: 21][epoch: 1][iter: 61] BEFORE:

[rank: 1][epoch: 1][iter: 61] BEFORE:

[rank: 15][epoch: 1][iter: 61] BEFORE:

[rank: 7][epoch: 1][iter: 61] BEFORE:
tensor([-2.2876e-04, -1.2724e-04,  1.5914e-04,  ...,  3.7441e-05,
        -1.9905e-04, -9.6019e-06], device='cuda:3')tensor([ 0.0006, -0.0007,  0.0004,  ..., -0.0003, -0.0002, -0.0001],
       device='cuda:0')tensor([ 3.3944e-05,  7.1107e-05, -5.5847e-06,  ..., -2.9397e-05,
        -3.9805e-04, -3.0101e-04], device='cuda:1')
[rank: 0][epoch: 1][iter: 61] BEFORE:
tensor([ 0.0013,  0.0010,  0.0012,  ..., -0.0003,  0.0004,  0.0006],
       device='cuda:3')
[rank: 5][epoch: 1][iter: 61] BEFORE:

[rank: 9][epoch: 1][iter: 61] BEFORE:
tensor([ 8.4083e-06,  1.9587e-04,  3.0659e-04,  ..., -1.1516e-05,
         2.8425e-05, -1.1656e-05], device='cuda:1')tensor([-4.3523e-06,  2.3197e-04,  1.6046e-04,  ...,  1.0222e-05,
        -4.7468e-04,  1.4199e-03], device='cuda:1')
[rank: 20][epoch: 1][iter: 61] BEFORE:

[rank: 12][epoch: 1][iter: 61] BEFORE:
tensor([ 0.0004, -0.0001, -0.0001,  ...,  0.0002,  0.0004,  0.0002],
       device='cuda:3')
[rank: 8][epoch: 1][iter: 61] AFTER HANDLE:

[rank: 18][epoch: 1][iter: 61] BEFORE:
tensor([ 1.6710e-03,  7.8752e-04, -8.4738e-04,  ..., -2.6642e-05,
         1.2343e-05,  4.8465e-05], device='cuda:0')
[rank: 23][epoch: 1][iter: 61] BEFORE:

[rank: 14][epoch: 1][iter: 61] BEFORE:
tensor([-0.0012,  0.0004,  0.0007,  ...,  0.0001,  0.0004,  0.0002],
       device='cuda:1')
[rank: 11][epoch: 1][iter: 61] AFTER HANDLE:

[rank: 19][epoch: 1][iter: 61] AFTER HANDLE:

[rank: 2][epoch: 1][iter: 61] AFTER HANDLE:

[rank: 22][epoch: 1][iter: 61] BEFORE:

[rank: 15][epoch: 1][iter: 61] AFTER HANDLE:

[rank: 4][epoch: 1][iter: 61] AFTER HANDLE:

[rank: 10][epoch: 1][iter: 61] AFTER HANDLE:

[rank: 16][epoch: 1][iter: 61] AFTER HANDLE:

[rank: 3][epoch: 1][iter: 61] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 61] AFTER HANDLE:

[rank: 13][epoch: 1][iter: 61] AFTER HANDLE:

[rank: 6][epoch: 1][iter: 61] AFTER HANDLE:
tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:1')
[rank: 17][epoch: 1][iter: 61] AFTER HANDLE:

[rank: 1][epoch: 1][iter: 61] AFTER HANDLE:
tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:0')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:0')
[rank: 7][epoch: 1][iter: 61] AFTER HANDLE:
tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:0')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:2')
[rank: 0][epoch: 1][iter: 61] AFTER HANDLE:
tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:3')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:2')
[rank: 5][epoch: 1][iter: 61] AFTER HANDLE:
tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:3')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:3')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:2')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:2')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:3')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:0')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:2')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:0')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:3')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:1')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:1')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:2')
[rank: 9][epoch: 1][iter: 61] AFTER HANDLE:
tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:1')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:1')
[rank: 20][epoch: 1][iter: 61] AFTER HANDLE:

[rank: 12][epoch: 1][iter: 61] AFTER HANDLE:
tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:3')
[rank: 8][epoch: 1][iter: 61] NEW GRAD:

[rank: 18][epoch: 1][iter: 61] AFTER HANDLE:
tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:0')
[rank: 23][epoch: 1][iter: 61] AFTER HANDLE:

[rank: 14][epoch: 1][iter: 61] AFTER HANDLE:
tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:1')
[rank: 11][epoch: 1][iter: 61] NEW GRAD:

[rank: 19][epoch: 1][iter: 61] NEW GRAD:

[rank: 2][epoch: 1][iter: 61] NEW GRAD:

[rank: 22][epoch: 1][iter: 61] AFTER HANDLE:

[rank: 15][epoch: 1][iter: 61] NEW GRAD:

[rank: 4][epoch: 1][iter: 61] NEW GRAD:

[rank: 10][epoch: 1][iter: 61] NEW GRAD:

[rank: 16][epoch: 1][iter: 61] NEW GRAD:

[rank: 3][epoch: 1][iter: 61] NEW GRAD:

[rank: 21][epoch: 1][iter: 61] NEW GRAD:

[rank: 13][epoch: 1][iter: 61] NEW GRAD:

[rank: 6][epoch: 1][iter: 61] NEW GRAD:
tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:1')
[rank: 17][epoch: 1][iter: 61] NEW GRAD:

[rank: 1][epoch: 1][iter: 61] NEW GRAD:
tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:0')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:0')
[rank: 7][epoch: 1][iter: 61] NEW GRAD:
tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:0')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:2')
[rank: 0][epoch: 1][iter: 61] NEW GRAD:
tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:3')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:2')
[rank: 5][epoch: 1][iter: 61] NEW GRAD:
tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:3')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:3')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:2')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:2')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:3')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:0')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:2')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:0')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:3')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:1')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:1')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:2')
[rank: 9][epoch: 1][iter: 61] NEW GRAD:
tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:1')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:1')
[rank: 20][epoch: 1][iter: 61] NEW GRAD:

[rank: 12][epoch: 1][iter: 61] NEW GRAD:
tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:3')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:1')
[rank: 18][epoch: 1][iter: 61] NEW GRAD:
tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:0')
[rank: 23][epoch: 1][iter: 61] NEW GRAD:

[rank: 14][epoch: 1][iter: 61] NEW GRAD:
tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:1')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:2')
[rank: 22][epoch: 1][iter: 61] NEW GRAD:
tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:0')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:0')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:2')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:3')tensor([ 8.6982e-05,  1.0190e-04,  8.1581e-05,  ..., -1.8992e-04,
        -8.7881e-05,  1.1095e-04], device='cuda:2')
[rank: 8][epoch: 1][iter: 62] BEFORE:
tensor([-1.3385e-06,  3.8795e-04,  6.0715e-05,  ...,  6.2131e-04,
        -3.4783e-06,  8.4413e-05], device='cuda:0')
[rank: 11][epoch: 1][iter: 62] BEFORE:
tensor([-0.0007, -0.0017,  0.0002,  ..., -0.0005,  0.0002,  0.0003],
       device='cuda:3')
[rank: 19][epoch: 1][iter: 62] BEFORE:
tensor([-2.2445e-05,  4.8619e-04,  3.3789e-04,  ..., -1.2914e-06,
        -1.2392e-04, -9.2740e-07], device='cuda:3')
[rank: 2][epoch: 1][iter: 62] BEFORE:

[rank: 15][epoch: 1][iter: 62] BEFORE:

[rank: 4][epoch: 1][iter: 62] BEFORE:
tensor([-8.6845e-04, -3.3158e-04, -9.2585e-05,  ...,  2.4965e-05,
         2.4302e-05,  1.3233e-05], device='cuda:2')tensor([-0.0007,  0.0002,  0.0002,  ..., -0.0010, -0.0002,  0.0003],
       device='cuda:3')
[rank: 10][epoch: 1][iter: 62] BEFORE:
tensor([ 6.4522e-05, -1.8718e-05, -7.0662e-05,  ..., -6.2551e-05,
         1.9046e-04, -4.4812e-05], device='cuda:0')
[rank: 3][epoch: 1][iter: 62] BEFORE:

[rank: 16][epoch: 1][iter: 62] BEFORE:
tensor([-1.4845e-04,  5.2843e-05, -2.0613e-04,  ..., -1.0954e-05,
        -2.7484e-05, -1.6706e-05], device='cuda:2')
[rank: 13][epoch: 1][iter: 62] BEFORE:
tensor([1.8503e-04, 9.8600e-05, 1.1854e-04,  ..., 1.4559e-06, 3.8271e-06,
        3.6862e-06], device='cuda:3')
[rank: 6][epoch: 1][iter: 62] BEFORE:
tensor([ 1.4399e-04, -1.7910e-04, -1.8882e-04,  ...,  1.4106e-05,
         1.9483e-05, -1.5795e-04], device='cuda:0')
[rank: 21][epoch: 1][iter: 62] BEFORE:

[rank: 1][epoch: 1][iter: 62] BEFORE:
tensor([ 9.1766e-05, -5.8788e-05, -3.4992e-05,  ..., -7.8611e-07,
        -8.4679e-06, -1.6317e-05], device='cuda:1')
[rank: 7][epoch: 1][iter: 62] BEFORE:

[rank: 17][epoch: 1][iter: 62] BEFORE:

[rank: 9][epoch: 1][iter: 62] BEFORE:
tensor([ 1.1625e-04,  1.9922e-04,  1.2770e-03,  ...,  5.8331e-05,
        -5.2426e-05,  4.9660e-05], device='cuda:1')tensor([ 1.0807e-04, -8.8639e-05,  1.0953e-04,  ...,  1.1662e-07,
         1.0452e-05,  1.9064e-05], device='cuda:1')tensor([-1.0273e-04, -7.4556e-05, -7.1888e-05,  ..., -3.7481e-04,
        -3.5187e-04, -6.9251e-04], device='cuda:2')tensor([ 6.4786e-05,  1.2704e-04,  6.9789e-05,  ..., -1.6487e-04,
        -1.6034e-04,  1.2068e-04], device='cuda:1')tensor([ 6.0563e-06, -1.7321e-04,  3.0465e-04,  ...,  2.2362e-04,
        -2.4807e-04, -2.8134e-04], device='cuda:1')
[rank: 0][epoch: 1][iter: 62] BEFORE:
tensor([-7.2622e-05, -2.3819e-04, -3.9593e-06,  ..., -2.7858e-03,
        -2.7960e-03, -2.8051e-04], device='cuda:3')
[rank: 18][epoch: 1][iter: 62] BEFORE:

[rank: 12][epoch: 1][iter: 62] BEFORE:

[rank: 20][epoch: 1][iter: 62] BEFORE:

[rank: 5][epoch: 1][iter: 62] BEFORE:
tensor([-1.5575e-05,  2.1128e-05, -2.4376e-06,  ..., -2.0187e-04,
        -1.0932e-04, -1.1074e-04], device='cuda:0')
[rank: 8][epoch: 1][iter: 62] AFTER HANDLE:

[rank: 19][epoch: 1][iter: 62] AFTER HANDLE:

[rank: 14][epoch: 1][iter: 62] BEFORE:

[rank: 22][epoch: 1][iter: 62] BEFORE:

[rank: 4][epoch: 1][iter: 62] AFTER HANDLE:

[rank: 1][epoch: 1][iter: 62] AFTER HANDLE:

[rank: 11][epoch: 1][iter: 62] AFTER HANDLE:

[rank: 16][epoch: 1][iter: 62] AFTER HANDLE:

[rank: 13][epoch: 1][iter: 62] AFTER HANDLE:

[rank: 23][epoch: 1][iter: 62] BEFORE:

[rank: 6][epoch: 1][iter: 62] AFTER HANDLE:

[rank: 3][epoch: 1][iter: 62] AFTER HANDLE:

[rank: 10][epoch: 1][iter: 62] AFTER HANDLE:

[rank: 17][epoch: 1][iter: 62] AFTER HANDLE:

[rank: 15][epoch: 1][iter: 62] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 62] AFTER HANDLE:

[rank: 7][epoch: 1][iter: 62] AFTER HANDLE:

[rank: 2][epoch: 1][iter: 62] AFTER HANDLE:

[rank: 9][epoch: 1][iter: 62] AFTER HANDLE:
tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:2')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:0')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:0')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:1')
[rank: 0][epoch: 1][iter: 62] AFTER HANDLE:
tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:0')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:3')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:2')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:2')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:0')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:1')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:3')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:0')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:1')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:3')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:2')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:3')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:2')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:1')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:3')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:1')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:3')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:2')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:1')
[rank: 18][epoch: 1][iter: 62] AFTER HANDLE:

[rank: 12][epoch: 1][iter: 62] AFTER HANDLE:

[rank: 20][epoch: 1][iter: 62] AFTER HANDLE:

[rank: 5][epoch: 1][iter: 62] AFTER HANDLE:
tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:0')
[rank: 8][epoch: 1][iter: 62] NEW GRAD:

[rank: 19][epoch: 1][iter: 62] NEW GRAD:

[rank: 14][epoch: 1][iter: 62] AFTER HANDLE:

[rank: 22][epoch: 1][iter: 62] AFTER HANDLE:

[rank: 4][epoch: 1][iter: 62] NEW GRAD:

[rank: 1][epoch: 1][iter: 62] NEW GRAD:

[rank: 11][epoch: 1][iter: 62] NEW GRAD:

[rank: 16][epoch: 1][iter: 62] NEW GRAD:

[rank: 13][epoch: 1][iter: 62] NEW GRAD:

[rank: 23][epoch: 1][iter: 62] AFTER HANDLE:

[rank: 6][epoch: 1][iter: 62] NEW GRAD:

[rank: 3][epoch: 1][iter: 62] NEW GRAD:

[rank: 10][epoch: 1][iter: 62] NEW GRAD:

[rank: 17][epoch: 1][iter: 62] NEW GRAD:

[rank: 15][epoch: 1][iter: 62] NEW GRAD:

[rank: 21][epoch: 1][iter: 62] NEW GRAD:

[rank: 7][epoch: 1][iter: 62] NEW GRAD:

[rank: 2][epoch: 1][iter: 62] NEW GRAD:

[rank: 9][epoch: 1][iter: 62] NEW GRAD:
tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:2')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:0')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:0')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:1')
[rank: 0][epoch: 1][iter: 62] NEW GRAD:
tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:0')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:3')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:2')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:2')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:0')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:1')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:3')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:0')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:1')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:3')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:2')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:3')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:2')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:1')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:3')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:1')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:3')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:2')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:1')
[rank: 18][epoch: 1][iter: 62] NEW GRAD:

[rank: 12][epoch: 1][iter: 62] NEW GRAD:

[rank: 20][epoch: 1][iter: 62] NEW GRAD:

[rank: 5][epoch: 1][iter: 62] NEW GRAD:
tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:0')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:2')
[rank: 14][epoch: 1][iter: 62] NEW GRAD:

[rank: 22][epoch: 1][iter: 62] NEW GRAD:
tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:1')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:0')
[rank: 23][epoch: 1][iter: 62] NEW GRAD:
tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:2')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:0')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:2')tensor([-2.0758e-04, -1.8246e-04, -7.4645e-05,  ..., -1.2618e-04,
        -1.2780e-04, -3.4096e-05], device='cuda:3')
[rank: 8][epoch: 1][iter: 63] BEFORE:

[rank: 19][epoch: 1][iter: 63] BEFORE:
tensor([-1.3114e-04,  1.1293e-05, -6.2729e-06,  ...,  1.3336e-05,
        -1.7720e-05, -2.3137e-05], device='cuda:0')tensor([ 8.5739e-04,  2.6466e-05,  5.7848e-04,  ...,  1.3778e-04,
        -1.6319e-04,  6.8014e-05], device='cuda:3')
[rank: 4][epoch: 1][iter: 63] BEFORE:

[rank: 1][epoch: 1][iter: 63] BEFORE:

[rank: 11][epoch: 1][iter: 63] BEFORE:
tensor([-1.6656e-04, -9.4961e-05, -9.1084e-05,  ...,  2.0309e-03,
         2.3105e-03,  2.1192e-03], device='cuda:0')tensor([-8.3492e-05, -1.3598e-04, -1.9886e-05,  ..., -5.6252e-05,
         4.5584e-04,  2.2025e-03], device='cuda:1')
[rank: 13][epoch: 1][iter: 63] BEFORE:

[rank: 16][epoch: 1][iter: 63] BEFORE:

[rank: 3][epoch: 1][iter: 63] BEFORE:

[rank: 6][epoch: 1][iter: 63] BEFORE:
tensor([-5.4218e-05, -5.8997e-07, -1.2500e-05,  ..., -5.3793e-05,
        -3.9744e-05,  2.9904e-05], device='cuda:1')tensor([-3.5496e-05, -1.2968e-04, -1.3186e-04,  ...,  2.6325e-06,
         5.5210e-04,  2.6843e-04], device='cuda:0')
[rank: 10][epoch: 1][iter: 63] BEFORE:
tensor([2.2500e-05, 5.3521e-07, 1.6654e-05,  ..., 1.1717e-04, 4.3530e-05,
        4.4673e-05], device='cuda:3')tensor([ 2.5691e-04,  4.5382e-05, -6.0276e-04,  ..., -1.9152e-05,
        -5.6112e-04, -2.4983e-04], device='cuda:2')
[rank: 15][epoch: 1][iter: 63] BEFORE:

[rank: 17][epoch: 1][iter: 63] BEFORE:
tensor([ 6.9322e-05, -8.1285e-06,  3.0762e-05,  ..., -3.1438e-04,
        -3.3319e-04, -3.6587e-04], device='cuda:2')
[rank: 7][epoch: 1][iter: 63] BEFORE:

[rank: 21][epoch: 1][iter: 63] BEFORE:

[rank: 2][epoch: 1][iter: 63] BEFORE:
tensor([-5.0424e-04,  6.6577e-05, -2.2489e-04,  ..., -4.9997e-04,
        -5.0581e-04,  2.1528e-04], device='cuda:3')tensor([-3.8187e-04,  1.4789e-04,  8.4477e-05,  ...,  4.6712e-06,
        -4.7302e-05, -2.8082e-06], device='cuda:1')
[rank: 9][epoch: 1][iter: 63] BEFORE:
tensor([ 0.0037,  0.0055,  0.0036,  ...,  0.0008, -0.0017, -0.0003],
       device='cuda:3')tensor([-4.5793e-05, -8.8411e-05, -4.2671e-05,  ...,  6.1524e-04,
         2.4927e-05,  1.2216e-04], device='cuda:1')
[rank: 0][epoch: 1][iter: 63] BEFORE:

[rank: 18][epoch: 1][iter: 63] BEFORE:
tensor([-6.8883e-04,  2.0300e-05, -6.2655e-04,  ..., -1.7301e-04,
         7.9333e-05,  1.7732e-04], device='cuda:1')
[rank: 5][epoch: 1][iter: 63] BEFORE:

[rank: 12][epoch: 1][iter: 63] BEFORE:
tensor([-8.0588e-05,  1.4050e-04,  1.4559e-04,  ...,  1.2816e-04,
         1.0212e-04,  7.3789e-05], device='cuda:2')
[rank: 22][epoch: 1][iter: 63] BEFORE:
tensor([-8.0581e-05, -1.2488e-04, -1.4644e-04,  ...,  1.1630e-04,
         1.2439e-04,  1.2468e-04], device='cuda:2')
[rank: 14][epoch: 1][iter: 63] BEFORE:
tensor([-1.4430e-04,  2.9417e-06,  4.6678e-05,  ..., -5.9089e-04,
        -1.7578e-03,  3.7566e-04], device='cuda:1')
[rank: 8][epoch: 1][iter: 63] AFTER HANDLE:
tensor([-1.4425e-04, -1.5297e-04, -6.9225e-05,  ..., -3.0687e-04,
         1.8490e-04,  1.8911e-04], device='cuda:0')
[rank: 20][epoch: 1][iter: 63] BEFORE:

[rank: 16][epoch: 1][iter: 63] AFTER HANDLE:

[rank: 15][epoch: 1][iter: 63] AFTER HANDLE:

[rank: 7][epoch: 1][iter: 63] AFTER HANDLE:

[rank: 10][epoch: 1][iter: 63] AFTER HANDLE:

[rank: 3][epoch: 1][iter: 63] AFTER HANDLE:

[rank: 23][epoch: 1][iter: 63] BEFORE:

[rank: 19][epoch: 1][iter: 63] AFTER HANDLE:

[rank: 13][epoch: 1][iter: 63] AFTER HANDLE:

[rank: 4][epoch: 1][iter: 63] AFTER HANDLE:

[rank: 9][epoch: 1][iter: 63] AFTER HANDLE:

[rank: 1][epoch: 1][iter: 63] AFTER HANDLE:

[rank: 21][epoch: 1][iter: 63] AFTER HANDLE:

[rank: 17][epoch: 1][iter: 63] AFTER HANDLE:
tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:0')
[rank: 6][epoch: 1][iter: 63] AFTER HANDLE:
tensor([0.0012, 0.0007, 0.0006,  ..., 0.0004, 0.0001, 0.0005], device='cuda:3')
[rank: 11][epoch: 1][iter: 63] AFTER HANDLE:

[rank: 2][epoch: 1][iter: 63] AFTER HANDLE:
tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:2')
[rank: 18][epoch: 1][iter: 63] AFTER HANDLE:
tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:2')
[rank: 5][epoch: 1][iter: 63] AFTER HANDLE:
tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:0')
[rank: 0][epoch: 1][iter: 63] AFTER HANDLE:
tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:0')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:0')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:3')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:3')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:2')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:3')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:3')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:3')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:1')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:0')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:1')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:1')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:1')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:1')
[rank: 12][epoch: 1][iter: 63] AFTER HANDLE:
tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:2')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:3')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:2')
[rank: 22][epoch: 1][iter: 63] AFTER HANDLE:
tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:2')
[rank: 14][epoch: 1][iter: 63] AFTER HANDLE:
tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:1')
[rank: 8][epoch: 1][iter: 63] NEW GRAD:
tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:0')
[rank: 20][epoch: 1][iter: 63] AFTER HANDLE:

[rank: 16][epoch: 1][iter: 63] NEW GRAD:

[rank: 15][epoch: 1][iter: 63] NEW GRAD:

[rank: 7][epoch: 1][iter: 63] NEW GRAD:

[rank: 10][epoch: 1][iter: 63] NEW GRAD:

[rank: 3][epoch: 1][iter: 63] NEW GRAD:

[rank: 23][epoch: 1][iter: 63] AFTER HANDLE:

[rank: 19][epoch: 1][iter: 63] NEW GRAD:

[rank: 13][epoch: 1][iter: 63] NEW GRAD:

[rank: 4][epoch: 1][iter: 63] NEW GRAD:

[rank: 9][epoch: 1][iter: 63] NEW GRAD:

[rank: 1][epoch: 1][iter: 63] NEW GRAD:

[rank: 21][epoch: 1][iter: 63] NEW GRAD:

[rank: 17][epoch: 1][iter: 63] NEW GRAD:
tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:0')
[rank: 6][epoch: 1][iter: 63] NEW GRAD:

[rank: 11][epoch: 1][iter: 63] NEW GRAD:

[rank: 2][epoch: 1][iter: 63] NEW GRAD:
tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:2')
[rank: 18][epoch: 1][iter: 63] NEW GRAD:
tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:2')
[rank: 5][epoch: 1][iter: 63] NEW GRAD:
tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:0')
[rank: 0][epoch: 1][iter: 63] NEW GRAD:
tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:0')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:0')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:3')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:3')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:2')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:3')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:3')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:3')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:1')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:0')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:1')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:1')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:1')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:1')
[rank: 12][epoch: 1][iter: 63] NEW GRAD:
tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:2')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:3')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:2')
[rank: 22][epoch: 1][iter: 63] NEW GRAD:
tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:2')
[rank: 14][epoch: 1][iter: 63] NEW GRAD:
tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:1')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:0')
[rank: 20][epoch: 1][iter: 63] NEW GRAD:
tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:0')
[rank: 23][epoch: 1][iter: 63] NEW GRAD:
tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:2')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:2')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:0')tensor([ 1.0914e-04,  2.8823e-04,  1.6271e-04,  ...,  1.1034e-04,
        -6.3430e-05,  2.4575e-04], device='cuda:3')